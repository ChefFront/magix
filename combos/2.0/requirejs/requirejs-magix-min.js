/*!Magix 2.0 Licensed MIT*/!function(a,b,c,d,e,f,g,h,i,j){j=1,i=function(a){return a.id||(a.id="mx_n_"+j++)},h("magix",["jquery","brix/event"],function(f,h){var k=f.isArray,l=f.isFunction,m=function(a){return"string"==f.type(a)},n=function(a){return"object"==f.type(a)},o=/\/\.(?:\/|$)|\/[^\/]+?\/\.{2}(?:\/|$)|\/\/+|\.{2}\//,p=/\/[^\/]*$/,q=/[#?].*$/,r=/([^=&?\/#]+)=?([^&#?]*)/g,s=/\?|(?!^)=/,t=/^https?:\/\//i,u="/",v="vframe",w=b.console,x=w&&w.error,y={tagName:v,rootId:"magix_vf_root",coded:1,error:x?function(a){w.error(a)}:d},z=y.hasOwnProperty,A=function(a,b){return a&&z.call(a,b)},B=function(b){return function(c,d,e){switch(arguments.length){case 0:e=b;break;case 1:e=n(c)?E(b,c):A(b,c)?b[c]:a;break;case 2:d===a?(delete b[c],e=d):b[c]=e=d}return e}},C=function(a,b){return b.f-a.f||b.t-a.t},D=function(a,b){var c=this;return c.get?(c.c=[],c.b=0|b||5,c.x=c.b+(a||20)):c=new D(a,b),c},E=function(a,b,c,d){for(d in b)c&&A(c,d)||(a[d]=b[d]);return a};E(D.prototype,{get:function(a){var b,c=this,d=c.c;return a=e+a,A(d,a)&&(b=d[a],b.f>=1&&(b.f++,b.t=j++,b=b.v)),b},list:function(){return this.c},set:function(a,b,c){var d=this,f=d.c,g=e+a,h=f[g];if(!A(f,g)){if(f.length>=d.x){f.sort(C);for(var i=d.b;i--;)h=f.pop(),h.f>0&&d.del(h.o)}h={o:a},f.push(h),f[g]=h}return h.v=b,h.f=1,h.t=j++,h.m=c,b},del:function(a){a=e+a;var b=this.c,c=b[a];c&&(c.f=-1,c.v=U,delete b[a],c.m&&(H(c.m,c.o,c),c.m=U))},has:function(a){return A(this.c,e+a)}});var F=D(40),G=D(),H=function(a,b,c,d,e,f){for(k(a)||(a=[a]),b&&(k(b)||b.callee)||(b=[b]),d=0;d<a.length;d++)try{f=a[d],e=f&&f.apply(c,b)}catch(g){y.error(g)}return e},I=function(a,b,c){if(y.coded)try{c=decodeURIComponent(c)}catch(d){}I.p[b]=c},J={mix:E,has:A,toTry:H,config:B(y),start:function(a){E(y,a),M([a.iniFile],function(b){y=E(y,b,a),y["!tnc"]=y.tagName!=v,na.on("!ul",ra.loc),na.on("changed",ra.loc),M(y.extensions||y.exts,na.start)})},keys:Object.keys||function(a){var b,c=[];for(b in a)A(a,b)&&c.push(b);return c},local:B({}),path:function(a,b){var c,d=a+e+b,f=G.get(d),g=U;if(!G.has(d)){for(t.test(a)&&(c=a.indexOf(u,8),0>c&&(c=a.length),g=a.slice(0,c),a=a.slice(c)),a=a.replace(q,U).replace(p,u),(t.test(b)||b.charAt(0)==u)&&(a=U),f=a+b;o.test(f);)f=f.replace(o,u);G.set(d,f=g+f)}return f},toObject:function(a){var b,c,d=F.get(a);return d||(I.p=b={},c=a.replace(q,U),s.test(c)&&(c=U),a.replace(c,U).replace(r,I),F.set(a,d=[c,b])),{path:d[0],params:E({},d[1])}},toUrl:function(a,b,c){var d,e,f,g=[];for(e in b)d=b[e],(!c||d||A(c,e))&&(y.coded&&(d=encodeURIComponent(d)),f=1,g.push(e+"="+d));return f&&(a=(a&&a+(s.test(a)?"&":"?"))+g.join("&")),a},toMap:function(a,b){var c,d,e,f={},g=arguments.length>1;if(a&&(e=a.length))for(c=0;e>c;c++)d=a[c],f[g?d[b]:d]=g?d:(0|f[d])+1;return f},Cache:D},K=function(){},L=function(a,b,c,d){var e=b.prototype;e.constructor=b,K.prototype=e;var f=new K;return E(f,c),E(a,d),f.constructor=a,a.prototype=f,a},M=function(a,b){a?(k(a)||(a=[a]),require(a,b)):b&&b()},N={fire:function(a,b,c,d){var f=e+a,g=this,h=g[f];if(h){b||(b={}),b.type||(b.type=a);for(var i,j,k=h.length,l=k-1;k--;)i=d?k:l-k,j=h[i],(j.d||j.r)&&(h.splice(i,1),l--),j.d||H(j.f,b,g);c=c||0>l}c&&delete g[f]},on:function(a,b,c,d){var f=this,g=e+a,h=f[g]||(f[g]=[]),i={f:b},j=0|c;j!==c?(c&&c.on&&d&&(c.on(d,function(){i.d=1},H),c=0),i.r=c,h.push(i)):h.splice(j,0,i)},off:function(a,b){var c=e+a,d=this[c];if(d)if(b){for(var f,g=d.length-1;g>=0;g--)if(f=d[g],f.f==b&&!f.d){f.d=1;break}}else delete this[c]},once:function(a,b){this.on(a,b,H)}};J.mix(J.local,N),J.Event=N;var O,P,Q,R,S,T,U="",V="path",W="view",X=J.keys,Y=J.toUrl,Z=J.toObject,$=J.config(),_=J.Cache(),aa=J.Cache(),ba=b.location,ca=b.history,da={params:{},href:U},ea=/(?:^https?:\/\/[^\/]+|#.*$)/gi,fa=/^[^#]*#?!?/,ga="params",ha=function(a,b,c){if(a){c=this[ga],a=(a+U).split(g);for(var d=0;d<a.length&&!(b=A(c,a[d]));d++);}return b},ia=function(){return this[V]},ja=function(){return this[W]},ka=function(a,b,c,d){return c=this,d=c[ga],arguments.length>1?d[a]=b:d[a]||U},la=function(a,b){var c,d,e,f;return P||(P={rs:$.routes||{},nf:$.unfoundView},e=$.defaultView,P.dv=e,f=$.defaultPath,c=P.rs,P.f=l(c),P.f||c[f]||!e||(c[f]=e),P[V]=f),a||(a=P[V]),c=P.rs,d=P.f?c.call($,a,b):c[a],{view:d||P.nf||P.dv,path:a}},ma=function(a,b){var c=a.href,d=b.href,f=c+e+d,g=aa.get(f);if(!g){var h,i,j,k;g={isParam:ha,isPath:ia,isView:ja,location:b,force:!a.get},g[W]=j,g[V]=j,g[ga]=k={};var l,m,n=a[ga],o=b[ga],p=[V,W].concat(X(n),X(o));for(l=p.length-1;l>=0;l--)m=p[l],1==l&&(n=a,o=b,k=g),i=n[m],j=o[m],i!=j&&(k[m]={from:i,to:j},h=1);aa.set(f,g=[h,g])}return g},na=E({start:function(){Q=$.edge,R=Q&&ca.pushState,S=Q&&!R,T=R?"srcQuery":"srcHash",na.bind(R),na.route()},parse:function(a,b){a=a||ba.href;var c,d,e,f,g,h,i=_.get(a);return i||(e=a.replace(ea,U),f=a.replace(fa,U),g=Z(e),h=Z(f),S&&(h[V]=J.path(ba.pathname,h[V])),i={get:ka,set:ka,href:a,refHref:da.href,srcQuery:e,srcHash:f,query:g,hash:h,params:E(E({},g[ga]),h[ga])},_.set(a,i)),b&&!i[W]&&(d=i.hash[V]||Q&&i.query[V],c=la(d,i),E(i,c)),i},route:function(){var a=na.parse(0,1),b=ma(da,a);da=a,b[0]&&(O=a,na.fire("changed",b[1]))},navigate:function(a,b,c){if(O){!b&&n(a)&&(b=a,a=U);var d=Z(a),e=O.query[ga],f=d[ga],g=d[V],h=O[V];if(E(f,b),g){if(g=J.path(h,g),S)for(var i in e)A(e,i)&&!A(f,i)&&(f[i]=U)}else g=h,f=E(E({},O[ga]),f),d[ga]=f;g=Y(d[V]=g,f,Q?V:e),g!=O[T]&&(R?(ca[c?"replaceState":"pushState"](U,U,g),na.route()):(E(d,O,d),d.srcHash=g,na.fire("!ul",{loc:O=d}),g="#!"+g,c?ba.replace(g):ba.hash=g),na.did=1)}}},N);J.Router=na,na.bind=function(a){var b=location.href;a?f(window).on("popstate",function(){var a=location.href==b;(na.did||!a)&&(na.did=1,na.route())}):f(window).on("hashchange",na.route)};var oa={},pa={},qa={},ra=J.mix({all:function(){return oa},add:function(a,b){A(oa,a)||(oa[a]=b,ra.fire("add",{vframe:b}))},get:function(a){return oa[a]},remove:function(a,b){var c=oa[a];c&&(delete oa[a],ra.fire("remove",{vframe:c,fcc:b}))},loc:function(a){var b,c=a.loc;if(c?b=1:c=a.location,E(pa,c),!b){E(qa,a);var d=Oa.root(ra,pa,qa);qa.view?d.mountView(c.view):Oa.update(d)}}},N);J.VOM=ra;var sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da=[],Ea="mx-vframe",A=J.has,Fa="querySelectorAll",Ga="alter",Ha="created",Ia="object",Ja=function(a){return typeof a==Ia?a:c.getElementById(a)},Ka=function(a,b,d){return b=Ja(a),b&&(d=ua?c[Fa]("#"+i(b)+wa):b.getElementsByTagName(sa)),d||Da},La=function(a,b,c){if(a=Ja(a),b=Ja(b),a&&b)if(a!==b)try{c=xa?b.contains(a):16&b.compareDocumentPosition(a)}catch(d){c=0}else c=1;return c},Ma=function(a){if(a.cC==a.rC){var b=a.view;b&&!a.fcc&&(a.fcc=1,a.fca=0,b.fire(Ha),a.fire(Ha));var c=a.id,d=Ca.get(a.pId);d&&!A(d.rM,c)&&(d.rM[c]=d.cM[c],d.rC++,Ma(d))}},Na=function(a,b){if(b||(b={}),!a.fca&&a.fcc){a.fcc=0;var c=a.view,d=a.id;c&&(a.fca=1,c.fire(Ga,b),a.fire(Ga,b));var e=Ca.get(a.pId);e&&A(e.rM,d)&&(e.rC--,delete e.rM[d],a._p||Na(e,b))}},Oa=function(a,b){var c=this;c.id=a,c.cM={},c.cC=0,c.rC=0,c.sign=1,c.rM={},c.pId=b,Ca.add(a,c)};Oa.root=function(b,d,e){if(!ya){sa=$.tagName,ta=$["!tnc"],ua=ta&&c[Fa],wa=" "+sa+"["+Ea+"=true]",va=ta&&!ua;var f=c.body;xa=f.contains,Aa=d,Ba=e,Ca=b;var g=$.rootId,h=Ja(g);h||(h=c.createElement(sa),h.id=g,f.appendChild(h),h=a),ya=new Oa(g)}return ya},Oa.update=function(a){var b=a.view;if(a.viewInited&&b&&b.sign>0){var c=b.olChg(Ba);c&&b.render(Ba);for(var d,e=a.children(),f=0,g=e.length;g>f;f++)d=Ca.get(e[f]),d&&Oa.update(d)}},E(E(Oa.prototype,N),{mountView:function(a,b,c){var d=this,e=Ja(d.id);if(!d._a&&e&&(d._a=1,d._t=e.innerHTML),d.unmountView(c),d._d=0,a){d.path=a;var f=J.toObject(a),g=f.path,h=++d.sign;M(g,function(a){if(h==d.sign){Va.prepare(a,Ca);var c=new a({owner:d,id:d.id,$:Ja,$i:La,path:g,vom:Ca,location:Aa});d.view=c;var i=function(a){d.mountZoneVframes(a.id)};c.on("interact",function(){c.hasTmpl||(e&&(e.innerHTML=d._t),i(Ja)),c.on("rendered",i),c.on("prerender",function(a){d.unmountZoneVframes(a.id,0,1)||Na(d)})},0),c.load(E(f.params,b),Ba)}})}},unmountView:function(a){var b=this,c=b.view;if(c){za||(za={}),b._d=1,b.unmountZoneVframes(0,a,1),Na(b,za),b.view=0,c.oust();var d=Ja(b.id);d&&b._a&&!a&&(d.innerHTML=b._t),b.viewInited=0,za=0}b.sign++},mountVframe:function(a,b,c,d,e){var f=this;f.fcc&&!d&&Na(f);var g=Ca.get(a);return g||(A(f.cM,a)||f.cC++,f.cM[a]=1,g=new Oa(a,f.id)),g._p=d,g.mountView(b,c,e),g},mountZoneVframes:function(a,b,c,d){var e=this;a=a||e.id,e.unmountZoneVframes(a,d,1);var f=Ka(a),g=f.length,h={};if(g)for(var j,k,l,m,n=0;g>n;n++)if(j=f[n],k=i(j),!A(h,k)&&(l=j.getAttribute("mx-view"),m=va?j.getAttribute(Ea):1,m||l)){e.mountVframe(k,l,b,c,d);for(var o,p=Ka(j),q=0,r=p.length;r>q;q++)o=p[q],h[i(o)]=1}Ma(e)},unmountVframe:function(a,b,c){var d=this;a=a||d.id;var e=Ca.get(a);if(e){var f=e.fcc;e.unmountView(b),Ca.remove(a,f);var g=Ca.get(e.pId);g&&A(g.cM,a)&&(delete g.cM[a],g.cC--,c||Ma(g))}},unmountZoneVframes:function(a,b,c){var d,e,f=this,g=f.cM;for(e in g)(!a||La(e,a))&&f.unmountVframe(e,b,d=1);return c||f._d||Ma(f),d},parent:function(a){var b=this,c=b;for(a=a>>>0||1;c&&a--;)c=Ca.get(c.pId);return c},children:function(){return J.keys(this.cM)},invokeView:function(a,b){var c,d=this;if(d.viewInited){var e=d.view,f=e&&e[a];f&&(c=H(f,b||Da,e))}return c}}),J.Vframe=Oa;var Pa=[],Qa=0,Ra="destroy",Sa=function(a,b){return function(){b=this,b.sign>0&&(b.sign++,b.fire("rendercall"),Ta(b),H(a,arguments,b))}},Ta=function(a,b){var c,d,e=a.$res;for(c in e)d=e[c],(b||d.x)&&Ua(e,c,1)},Ua=function(a,b,c){var d,e,f=a[b];f&&(d=f.e,e=d&&d[Ra],e&&H(e,Pa,d),(!f.k||c)&&delete a[b])},Va=function(a){var b=this;E(b,a),b.$ol={ks:[]},b.$res={},b.sign=1,H(Va.$,a,b)},Wa=Va.prototype;Va.$=[],Va.prepare=function(a){if(!a[e]){a[e]=1;var b=a.prototype;b.render=Sa(b.render)}},Va.mixin=function(a,b){b&&Va.$.push(b),E(Wa,a)},E(E(Wa,N),{render:d,navigate:na.navigate,init:d,hasTmpl:!0,load:function(){var a=this,b=a.hasTmpl,c=arguments,d=function(d){a.tmpl=d,a.fire("interact",0,1),H(a.init,c,a),a.fire("inited",0,1),a.owner.viewInited=1,a.render();var e=!b&&!a.rendered;e&&(a.rendered=1,a.fire("primed",0,1))};b?a.fetchTmpl(a.path,a.wrapAsync(d)):d()},beginUpdate:function(a){var b=this;b.sign>0&&b.rendered&&b.fire("prerender",{id:a||b.id})},endUpdate:function(a){var b=this;b.sign>0&&(b.rendered||(b.fire("primed",0,1),b.rendered=1),b.fire("rendered",{id:a||b.id}))},wrapAsync:function(a,b){var c=this,d=c.sign;return function(){d>0&&(!b||d==c.sign)&&a&&a.apply(this,arguments)}},setHTML:function(a,b){var c,d=this;d.beginUpdate(a),d.sign>0&&(c=d.$(a),c&&(d.undelegateEvents(c),c.innerHTML=b,d.delegateEvents(c))),d.endUpdate(a)},observeLocation:function(a){var b,c=this;b=c.$ol,b.f=1;var d=b.ks;n(a)&&(b.pn=a.path,a=a.params),a&&(b.ks=d.concat((a+U).split(g)))},olChg:function(a){var b,c=this,d=c.$ol;return d.f&&(d.pn&&(b=a.path),b||(b=a.isParam(d.ks))),b},oust:function(){var a=this;a.sign>0&&(a.sign=0,a.fire(Ra,0,1,1),Ta(a,1),a.undelegateEvents("#"+a.id)),a.sign--},inside:function(a,b){var c,d,e=this;for(b=(b+U).split(g),d=b.length-1;d>=0&&!(c=e.$i(a,b[d]));d--);return c},manage:function(a,b,c){var d=this,e=1,f=d.$res;a&&!m(a)&&(c=b,b=a,a=U),a?Ua(f,a):(e=0,a="res_"+Qa++);var g={k:e,e:b,x:c};return f[a]=g,b},getManaged:function(b,c){var d=this,e=d.$res,f=b?a:e;return b&&A(e,b)&&(f=e[b].e,c&&delete e[b]),f},removeManaged:function(a){return this.getManaged(a,1)},destroyManaged:function(a){Ua(this.$res,a,1)}}),J.View=Va;var Xa={},Ya="?t="+Math.random(),Za=h("mx-"),$a={},_a={};Wa.delegateEvents=function(a){Za.delegate(f(a),this)},Wa.undelegateEvents=function(a){Za.undelegate(f(a),this)},Wa.fetchTmpl=function(a,b){var c=this,d="tmpl"in c;if(d)b(c.tmpl);else if(A($a,a))b($a[a]);else{var e=a.indexOf("/"),g=a.substring(0,e);Xa[g]||(Xa[g]=require.s.contexts._.config.paths[g]);var h=Xa[g]+a.substring(e+1)+".html",i=_a[h],j=function(c){b($a[a]=c)};i?i.push(j):(i=_a[h]=[j],f.ajax({url:h+Ya,success:function(a){H(i,a),delete _a[h]},error:function(a,b){H(i,b),delete _a[h]}}))}},Va.extend=function(b,c,d){var e=this;l(c)&&(d=c,c=a);var f=function(a){e.call(this,a),d&&d.call(this,a)};return f.extend=e.extend,L(f,e,b,c)};var ab=n,bb=J.toString,cb="URL",db="FORM",eb=function(){this.id="m"+j++},fb=function(a){return function(b,c,d){var f,g,h,i=this,j=e+a;i[j]||(i[j]={}),h=i[j],l(b)&&(b=J.toTry(b)),b&&!ab(b)&&(f={},f[b]=c,b=f);for(g in b)d&&A(h,g)||(h[g]=b[g])}};J.mix(eb.prototype,{sync:d,getFormParams:function(){return this[e+db]},getUrlParams:function(){return this[e+cb]},setFormParams:fb(db),setUrlParams:fb(cb),get:function(a,b,c){var d=this,e=arguments.length,f=2==e,g=d.$attrs;if(e){for(var h=(a+U).split(".");g&&h[0];)g=g[h.shift()];h[0]&&(g=c)}return f&&bb.call(b)!=bb.call(g)&&(g=b),g},set:function(a,b){var c=this;if(c.$attrs||(c.$attrs={}),a){if(!ab(a)){var d={};d[a]=b,a=d}for(var e in a)c.$attrs[e]=a[e]}},request:function(a,b){var c=this;c.sync(function(d,e){ab(e)||(e={data:e}),c.set(e),a(d,b)})}}),J.Model=eb,eb.extend=function(a,b,c){var d=this,e=function(){d.call(this),c&&c.call(this)};return L(e,d,a,b)};var gb=k,hb=l,ib=1,jb=2,kb=4,lb="formParams",mb="urlParams",nb=[lb,mb],ob=Date.now||function(){return+new Date},pb=b.JSON,qb=12e5,rb=function(a,b,c,d){return b?hb(a)&&c.push(rb(H(a))):d=pb?pb.stringify(a):ob(),d},sb=function(a,b){for(var c,d=[rb(b),rb(a)],f=nb.length-1;f>-1;f--)c=nb[f],rb(a[c],1,d),rb(b[c],1,d);return rb(a.key,1,d),d.join(e)},tb=function(a){var b=a.cache;return b&&(b=b===!0?qb:0|b),b},ub=function(a){throw Error(a)},vb=function(a,b,c){var d=this;d.$mClz=a,d.$mCache=J.Cache(b,c),d.$mReqs={},d.$mMetas={},d.id="mm"+j++},wb=function(a){var b=this;b.$host=a,b.$reqs={},b.sign=1,b.id="mr"+j++,b.$queue=[]},xb=[].slice,yb=function(a,b,c,d){var e=function(f){return a.apply(b,[c,d,f,e.ost])};return e},zb=function(a,b){var c=b.b,d=b.a,e=d[c];if(e){var f=e.q;delete d[c],H(f,a,e.e)}},Ab=function(b,c,d,e){var f,g,h=this,i=c.a,j=c.c,k=c.d,l=c.g,m=c.i,n=c.j,o=c.k,p=c.l,q=c.m,r=c.n,s=c.o;c.b++,delete j[h.id];var t=h.$mm,u=t.key;if(k[b+1]=h,d)c.e=1,f=1,c.f=d,l.msg=d,l[b]=d,n.fire("fail",{model:h,msg:d}),g=1;else if(!m.has(u)){u&&m.set(u,h),t.time=ob();var v=t.after;v&&H(v,h),t.cls&&n.clearCache(t.cls),n.fire("done",{model:h}),g=1}if(!i.$ost&&!e){if(o==ib){var w=p?q[b]:q;w&&(r[b+1]=H(w,[f?l:a,h,l],i))}else if(o==jb){s[b]={m:h,e:f,s:d};for(var x,y,z=s.i||0;x=s[z];z++)y=p?q[z]:q,x.e&&(l.msg=x.s,l[z]=x.s),r[z+1]=H(y,[x.e?l:a,x.m,l].concat(r),i);s.i=z}c.b==c.h&&(c.e||(l=a),r[0]=l,o==kb&&(k[0]=l,r[1]=H(q,k,i)),i.$busy=0,i.doNext(r))}g&&n.fire("finish",{msg:d,model:h})},Bb=function(a,b,c,d,e){if(a.$ost)return a;if(a.$busy)return a.next(function(){Bb(this,b,c,d,e)});a.$busy=1,a.sign++;var f=a.$host,g=f.$mCache,h=f.$mReqs,i=a.$reqs;gb(b)||(b=[b]);var j=b.length,k=[],l=gb(c);l&&(k=new Array(c.length));for(var m,n={a:a,b:0,c:a.$reqs,d:new Array(j),g:{},h:j,i:g,j:f,k:d,l:l,m:c,n:k,o:[]},o=0;o<b.length;o++)if(m=b[o]){var p=f.getModel(m,e),q=p.entity,r=q.$mm.key,s=yb(Ab,q,o,n);s.id=a.id,r&&A(h,r)?h[r].q.push(s):p.update?(i[q.id]=q,r&&(h[r]={q:[s],e:q},s=zb),q.request(s,{a:h,b:r})):s()}else ub("empty model");return a},Cb=function(a,b){return function(c,d){var e=xb.call(arguments,1);return Bb(this,c,e.length>1?e:d,a,b)}};E(vb,{create:function(a,b,c){return new vb(a,b,c)}}),E(wb.prototype,{fetchAll:function(a,b){return Bb(this,a,b,kb)},save:function(a,b){return Bb(this,a,b,kb,1)},fetchOrder:Cb(jb),fetchOne:Cb(ib),next:function(a){var b=this;return b.$ost||(b.$queue.push(a),b.doNext(b.$args)),b},doNext:function(a){var b=this;if(!b.$busy&&!b.$ost){b.$busy=1;var c=++b.sign;b.$ntId=setTimeout(function(){b.$busy=0,b.$args=a;var d,e=b.$queue,f=e.shift();f&&(d=H(f,a,b),c==b.sign&&b.doNext(d===e.$?a:[null,d]))},0)}},destroy:function(){var a=this;a.$ost=1,clearTimeout(a.$ntId);var b=a.$host,c=a.$reqs,d=b.$mReqs;for(var e in c){var f,g,h=c[e],i=h.$mm.key;if(i&&A(d,i)){f=d[i],g=f.q;for(var j,k=0;k<g.length;k++)j=g[k],j.id==a.id&&(j.ost=1)}}a.$reqs={},a.$queue=[],a.$busy=0}});var Db=vb.prototype;return E(E(Db,N),{registerModels:function(a){var b=this,c=b.$mMetas;gb(a)||(a=[a]);for(var d,e,f,g=0;g<a.length;g++)d=a[g],d&&(e=d.name,e?c[e]&&ub("already exist:"+e):ub("miss name"),f=tb(d),f&&(d.cache=f),c[e]=d)},registerMethods:function(a){E(this,a)},create:function(a){var b=this,c=b.getMeta(a),d=tb(a)||c.cache,e=new b.$mClz;e.set(c),e.$mm={name:c.name,after:c.after,cls:c.cleans,key:d&&sb(c,a)},a.name&&e.set(a),e.setUrlParams(c[mb]),e.setFormParams(c[lb]),e.setUrlParams(a[mb]),e.setFormParams(a[lb]);var f=c.before;return f&&H(f,e),b.fire("start",{model:e}),e},getMeta:function(a){var b=this,c=b.$mMetas,d=a.name||a,e=c[d];return e||ub("Unfound:"+d),e},getModel:function(a,b){var c,d,e=this;return b||(c=e.getCached(a)),c||(d=1,c=e.create(a)),{entity:c,update:d}},createRequest:function(a,b,c){return a.manage(b,new wb(this),arguments.length<3||c)},clearCache:function(a){var b=this,c=b.$mCache,d=c.list();a=J.toMap((a+U).split(g));for(var e=0;e<d.length;e++){var f=d[e],h=f.v,i=h&&h.$mm;i&&A(a,i.name)&&c.del(i.key)}},getCached:function(a){var b,c,d=this,e=d.$mCache,f=d.getMeta(a),g=tb(a)||f.cache;if(g&&(c=sb(f,a)),c){var h=d.$mReqs,i=h[c];i?b=i.e:(b=e.get(c),b&&g>0&&ob()-b.$mm.time>g&&(e.del(c),b=0))}return b}}),J.Manager=vb,J})}(null,window,document,function(){},"","",",",define);