(function(e,t,n,r,i,a){a=0,i=function(e){return e.id||(e.id="mx_n_"+ ++a)},r("magix/magix",function(){var n=/\/\.\/|\/[^\/.]+?\/\.{2}\/|([^:\/])\/\/+|\.{2}\//,r=/\/[^\/]*$/,i=/[#?].*$/,a="",o=/([^=&?\/#]+)=?([^&=#?]*)/g,c="pathname",f=/^https?:\/\//i,s=0,u="/",v="vframe",m="\n",p=t.console,h=p&&p.error,l=function(){},d={tagName:v,rootId:"magix_vf_root",progress:l,coded:1,execError:function(e){h&&p.error(e)}},g=d.hasOwnProperty,x=function(e,t){return e&&g.call(e,t)},w=function(t){return function(n,r,i){switch(arguments.length){case 0:i=t;break;case 1:i=I._o(n)?C(t,n):x(t,n)?t[n]:e;break;case 2:r===e?(delete t[n],i=r):t[n]=i=r}return i}},y=function(e,t){return t.f-e.f||t.t-e.t},b=function(e,t){var n=this;return n.get?(n.c=[],n.x=e||20,n.b=n.x+(0|t||5)):n=new b(e,t),n},C=function(e,t,n){for(var r in t)n&&x(n,r)||(e[r]=t[r]);return e};C(b.prototype,{get:function(e){var t,n=this,r=n.c;return e=c+e,x(r,e)&&(t=r[e],t.f>=1&&(t.f++,t.t=s++,t=t.v)),t},list:function(){return this.c},set:function(e,t,n){var r=this,i=r.c,a=c+e,o=i[a];if(!x(i,a)){if(i.length>=r.b){i.sort(y);for(var f=r.b-r.x;f--;)o=i.pop(),delete i[o.k],o.m&&_(o.m,o.o,o)}o={},i.push(o),i[a]=o}return o.o=e,o.k=a,o.v=t,o.f=1,o.t=s++,o.m=n,t},del:function(e){e=c+e;var t=this.c,n=t[e];n&&(n.f=-1e5,n.v=a,delete t[e],n.m&&(_(n.m,n.o,n),n.m=a))},has:function(e){return e=c+e,x(this.c,e)}});var E=b(60),M=b(),_=function(e,t,n,r,i,a){for(I._a(e)||(e=[e]),t&&(I._a(t)||t.callee)||(t=[t]),r=0;e.length>r;r++)try{a=e[r],i=a&&a.apply(n,t)}catch(o){d.execError(o)}return i},I={mix:C,has:x,safeExec:_,noop:l,config:w(d),start:function(e){var t=this;C(d,e),t.use(["magix/router","magix/vom",e.iniFile],function(n,r,i){d=C(d,i,e),d["!tnc"]=d.tagName!=v,n.on("!ul",r.locChged),n.on("changed",r.locChged),r.on("progress",d.progress),t.use(d.extensions,n.start)})},keys:Object.keys||function(e){var t=[];for(var n in e)x(e,n)&&t.push(n);return t},local:w({}),path:function(e,t){var o=e+m+t,c=M.get(o);if(!c){if(f.test(t))c=t;else if(e=e.replace(i,a).replace(r,a)+u,t.charAt(0)==u){var s=f.test(e)?8:0,v=e.indexOf(u,s);c=e.substring(0,v)+t}else c=e+t;for(;n.test(c);)c=c.replace(n,"$1/");M.set(o,c)}return c},pathToObject:function(e,t){var n=e+m+t,r=E.get(n);if(!r){r={};var s={},v=a;i.test(e)?v=e.replace(i,a):~e.indexOf("=")||(v=e);var p=e.replace(v,a);if(v&&f.test(v)){var h=v.indexOf(u,8);v=~h?v.substring(h):u}p.replace(o,function(e,n,r){if(t)try{r=decodeURIComponent(r)}catch(i){}s[n]=r}),r[c]=v,r.params=s,E.set(n,r)}return r},objectToPath:function(e,t,n){var r,i=e[c],a=[],o=e.params;for(var f in o)r=o[f],(!n||r||x(n,f))&&(t&&(r=encodeURIComponent(r)),a.push(f+"="+r));return a.length&&(i=i+"?"+a.join("&")),i},listToMap:function(e,t){var n,r,i,a={};if(I._s(e)&&(e=e.split(",")),e&&(i=e.length))for(n=0;i>n;n++)r=e[n],a[t?r[t]:r]=t?r:1;return a},cache:b},V=Object.prototype.toString;return C(I,{use:function(e,t){e?seajs.use(e,t):t&&t()},_a:$.isArray,_f:$.isFunction,_o:function(e){return"[object Object]"==V.call(e)},_s:function(e){return"[object String]"==V.call(e)},_n:function(e){return"[object Number]"==V.call(e)},extend:function(e,t,n,r){e.superclass=t.prototype,t.prototype.constructor=t;var i=function(){};return i.prototype=t.prototype,e.prototype=new i,I.mix(e.prototype,n),I.mix(e,r),e.prototype.constructor=e,e}})}),r("magix/router",["magix/magix","magix/event"],function(e){var n,r,i,a,o,c,f=e("magix/magix"),s=e("magix/event"),u="",v="pathname",m="view",p=f.has,h=f.mix,l=f.keys,d=f.config(),g=f.cache(),x=f.cache(40),w={params:{},href:u},y=/#.*$/,b=/^[^#]*#?!?/,C="params",E=function(e,t,n){if(e){n=this[C],e=(e+u).split(",");for(var r=0;e.length>r&&!(t=p(n,e[r]));r++);}return t},M=function(){return this[v]},_=function(){return this[m]},I=function(e,t,n,r){return n=this,r=n[C],arguments.length>1?r[e]=t:r[e]},V=function(e){var n=f.pathToObject(e,a),r=n[v];return r&&c&&(n[v]=f.path(t.location[v],r)),n},T=h({viewInfo:function(e,t){var n,i;if(!r){r={rs:d.routes||{},nf:d.notFoundView};var a=d.defaultView;r.dv=a;var o=d.defaultPathname||u;n=r.rs,r.f=f._f(n),r.f||n[o]||!a||(n[o]=a),r[v]=o}return e||(e=r[v]),n=r.rs,i=r.f?n.call(d,e,t):n[e],{view:i||r.nf||r.dv,pathname:e}},start:function(){var e=t.history;i=d.nativeHistory,a=d.coded,o=i&&e.pushState,c=i&&!o,o?T.useState():T.useHash(),T.route()},parseQH:function(e,n){e=e||t.location.href;var r=g.get(e);if(!r){var a=e.replace(y,u),o=e.replace(b,u),c=V(a),f=V(o),s={};h(s,c[C]),h(s,f[C]),r={get:I,set:I,href:e,refHref:w.href,srcQuery:a,srcHash:o,query:c,hash:f,params:s},g.set(e,r)}if(n&&!r[m]){var p;p=r.hash[v]||i&&r.query[v];var l=T.viewInfo(p,r);h(r,l)}return r},getChged:function(e,t){var n=e.href,r=t.href,i=n+"\n"+r,a=x.get(i);if(!a){var o,c,f;a={},a[m]=f,a[v]=f,a[C]={};var s,u,p=[v,m];for(s=1;s>=0;s--)u=p[s],c=e[u],f=t[u],c!=f&&(a[u]={from:c,to:f},o=1);var h=e[C],d=t[C];for(p=l(h).concat(l(d)),s=p.length-1;s>=0;s--)u=p[s],c=h[u],f=d[u],c!=f&&(a[C][u]={from:c,to:f},o=1);a.occur=o,a.isParam=E,a.isPathname=M,a.isView=_,x.set(i,a)}return a},route:function(){var e=T.parseQH(0,1),t=!w.get,r=T.getChged(w,e);w=e,r.occur&&(n=e,T.fire("changed",{location:e,changed:r,force:t}))},navigate:function(e,t,r){if(!t&&f._o(e)&&(t=e,e=u),t&&(e=f.objectToPath({params:t,pathname:e},a)),e){var i=V(e),s={};if(s[C]=h({},i[C]),s[v]=i[v],s[v]){if(c){var m=n.query[C];for(var l in m)p(m,l)&&!p(s[C],l)&&(s[C][l]=u)}}else{var d=h({},n[C]);s[C]=h(d,s[C]),s[v]=n[v]}var g,x=f.objectToPath(s,a,n.query[C]);g=x!=n[o?"srcQuery":"srcHash"],g&&(o?(T.poped=1,history[r?"replaceState":"pushState"](u,u,x),T.route()):(h(s,n,s),s.srcHash=x,s.hash={params:s[C],pathname:s[v]},T.fire("!ul",{loc:n=s}),x="#!"+x,r?location.replace(x):location.hash=x))}}},s);return T.useState=function(){var e=T,t=location.href;$(WIN).on("popstate",function(){var n=location.href==t;(e.poped||!n)&&(e.poped=1,e.route())})},T.useHash=function(){$(WIN).on("hashchange",T.route)},T}),r("magix/body",["magix/magix"],function(r){var a,o=r("magix/magix"),c=o.has,f=o.mix,s={},u={},v=String.fromCharCode(26),m="mx-ei",p="mx-owner",h="addEventListener",l="removeEventListener",d=n.body,g=d[h],x="parentNode",w={},y="on",b=",",C=function(e,t,n){return n?e.setAttribute(t,n):n=e.getAttribute(t),n},E=function(){this.returnValue=!1},M=function(){this.cancelBubble=!0},_={special:function(e){f(s,e)},process:function(n){if(n=n||t.event,n&&!n[y]){var r=n.target||n.srcElement||d;for(n[y]=1;r&&1!=r.nodeType;)r=r[x];for(var o,f,s=r,u=n.type,h=w[u]||(w[u]=RegExp(b+u+"(?:,|$)")),l="mx-"+u,_=[];s&&1==s.nodeType&&(o=C(s,l),f=C(s,m),!o&&!h.test(f));)_.push(s),s=s[x];if(o){var I,V=o.split(v);if(V.length>1&&(I=V[0],o=V.pop()),I=I||C(s,p),!I)for(var $=s,T=a.all();$;){if(c(T,$.id)){C(s,p,I=$.id);break}$=$[x]}if(!I)throw Error("bad:"+o);var j=a.get(I),k=j&&j.view;k&&(g||(n.preventDefault=E,n.stopPropagation=M),k.pEvt({info:o,se:n,st:u,tId:i(r),cId:i(s)}))}else{for(var A;_.length;)A=_.shift(),f=C(A,m)||y,h.test(f)||(f=f+b+u,C(A,m,f));A=e}s=r=e}},act:function(t,n,r){var i=u[t]||0,o=i>0?1:0,c=_.process;if(i+=n?-o:o,!i){r&&(a=r);var f=s[t];f?_.lib(d,t,n,c):g?d[n?l:h](t,c,!1):d[y+t]=n?e:c,n||(i=1)}u[t]=i}},I={focus:2,blur:2,mouseenter:2,mouseleave:2};return _.special(I),_.lib=function(e,t,n,r){var i=I[t];1==i?$(e)[n?"off":"on"](t,r):$(e)[(n?"un":"")+"delegate"]("[mx-"+t+"]",t,r)},_}),r("magix/event",["magix/magix"],function(e){var t=e("magix/magix"),n=function(e){return"~"+e},r=t.safeExec,i={fire:function(e,t,i,a){var o=n(e),c=this,f=c[o];if(f){t||(t={}),t.type||(t.type=e);for(var s,u,v=f.length,m=v-1;v--;)s=a?v:m-v,u=f[s],(u.d||u.r)&&(f.splice(s,1),m--),u.d||r(u.f,t,c);i=i||0>m}i&&delete c[o]},on:function(e,t,r){var i=n(e),a=this[i]||(this[i]=[]),o={f:t};isNaN(r)?(o.r=r,a.push(o)):a.splice(0|r,0,o)},off:function(e,t){var r=n(e),i=this[r];if(i)if(t){for(var a,o=i.length-1;o>=0;o--)if(a=i[o],a.f==t&&!a.d){a.d=1;break}}else delete this[r]},once:function(e,t){this.on(e,t,n)}};return t.mix(t.local,i),i}),r("magix/vframe",["magix/magix","magix/event","magix/view"],function(t){var r,a,o,c,f,s,u,v,m,p,h,l=t("magix/magix"),d=t("magix/event"),g=t("magix/view"),x=l.safeExec,w=[],y=l.mix,b=l.config(),C=l.has,E="querySelectorAll",M="alter",_="created",I=function(e){return"object"==typeof e?e:n.getElementById(e)},V=function(e,t,a){return t=I(e),t&&(a=o?n[E]("#"+i(t)+c):t.getElementsByTagName(r)),a||w},$=function(e,t,n){if(e=I(e),t=I(t),e&&t)if(e!==t)try{n=s?t.contains(e):16&t.compareDocumentPosition(e)}catch(r){n=0}else n=1;return n},T=function(e){var t=this;t.id=e,t.cM={},t.cC=0,t.rC=0,t.sign=1<<30,t.rM={},t.owner=h,h.add(e,t)};return T.root=function(t,i,v){if(!u){r=b.tagName,a=b["!tnc"],f=a?"mx-vframe":"mx-defer",o=a&&n[E],c=" "+r+"[mx-vframe]";var l=n.body;s=l.contains,m=i,p=v,h=t;var d=b.rootId,g=I(d);g||(g=n.createElement(r),g.id=d,l.appendChild(g),g=e),u=new T(d)}return u},y(y(T.prototype,d),{mountView:function(e,t){var n=this,r=I(n.id);if(n._a||(n._a=1,n._t=r.innerHTML),n.unmountView(),e){var i=l.pathToObject(e),a=i.pathname,o=--n.sign;l.use(a,function(e){if(o==n.sign){g.prepare(e);var c=new e({owner:n,id:n.id,$:I,path:a,vom:h,location:m});n.view=c;var f=function(){n.mountZoneVframes()};c.on("interact",function(e){e.tmpl||(r.innerHTML=n._t,f()),c.on("primed",function(){n.viewPrimed=1,n.fire("viewMounted")}),c.on("rendered",f),c.on("prerender",function(){n.unmountZoneVframes(0,1)||n.cAlter()})},0),t=t||{},c.load(y(t,i.params,t),p)}})}},unmountView:function(){var e=this,t=e.view;if(t){v||(v={}),e.unmountZoneVframes(0,1),e.cAlter(v),e.view=0,t.oust();var n=I(e.id);n&&e._a&&(n.innerHTML=e._t),e.viewInited=0,e.viewPrimed&&(e.viewPrimed=0,e.fire("viewUnmounted")),v=0}e.sign--},mountVframe:function(e,t,n){var r=this;r.fcc&&r.cAlter();var i=h.get(e);return i||(i=new T(e),i.pId=r.id,C(r.cM,e)||r.cC++,r.cM[e]=1),i.mountView(t,n),i},mountZoneVframes:function(e,t){var n=this,r=e||n.id;n.unmountZoneVframes(r,1);var o=V(r),c=o.length,s={};if(c)for(var u,v,m,p,h=0;c>h;h++)if(u=o[h],v=i(u),!C(s,v)&&(m=u.getAttribute("mx-view"),p=!u.getAttribute(f),p=p!=a,p||m)){n.mountVframe(v,m,t);for(var l,d=V(u),g=0,x=d.length;x>g;g++)l=d[g],s[i(l)]=1}n.cCreated()},unmountVframe:function(e,t){var n=this;e=e||n.id;var r=h.get(e);if(r){var i=r.fcc;r.unmountView(),h.remove(e,i);var a=h.get(r.pId);a&&C(a.cM,e)&&(delete a.cM[e],a.cC--,t||a.cCreated())}},unmountZoneVframes:function(e,t){var n,r,i=this,a=i.cM;for(r in a)(!e||$(r,e))&&i.unmountVframe(r,n=1);return t||i.cCreated(),n},cCreated:function(e){var t=this;if(t.cC==t.rC){var n=t.view;n&&!t.fcc&&(t.fcc=1,t.fca=0,n.fire(_,e),t.fire(_,e)),h.vfCreated();var r=t.id,i=h.get(t.pId);i&&!C(i.rM,r)&&(i.rM[r]=i.cM[r],i.rC++,i.cCreated(e))}},cAlter:function(e){var t=this;e||(e={});var n=t.fcc;if(t.fcc=0,!t.fca&&n){var r=t.view,i=t.id;r&&(t.fca=1,r.fire(M,e),t.fire(M,e));var a=h.get(t.pId);a&&C(a.rM,i)&&(a.rC--,delete a.rM[i],a.cAlter(e))}},locChged:function(){var e=this,t=e.view;if(e.viewInited&&t&&t.sign>0){var n=t.olChg(p),r={location:m,changed:p,prevent:function(){this.cs=w},to:function(e){e=e||w,l._s(e)&&(e=e.split(",")),this.cs=e}};n&&x(t.locationChange,r,t);for(var i,a=r.cs||l.keys(e.cM),o=0,c=a.length;c>o;o++)i=h.get(a[o]),i&&i.locChged()}}}),T}),r("magix/view",function(e){var t=e("magix/magix"),n=e("magix/event"),r=e("magix/body"),i=t.safeExec,a=t.has,o=",",c=[],f=t.noop,s=t.mix,u="~",v=function(e){return function(){var t=this,n=t.notifyUpdate();n>0&&e.apply(t,arguments)}},m=t.cache(40),p="<",h=">",l=/\smx-(?!view|defer|owner|vframe)[a-z]+\s*=\s*"/g,d=String.fromCharCode(26),g={prevent:function(e){e=e||this.srcEvent,e.preventDefault()},stop:function(e){e=e||this.srcEvent,e.stopPropagation()},halt:function(e){this.prevent(e),this.stop(e)}},x=/(\w+)(?:<(\w+)>)?(?:\(?{([\s\S]*)}\)?)?/,w=/(\w+):([^,]+)/g,y=/([$\w]+)<([\w,]+)>/,b=function(e){var t=this;s(t,e),t.$ol={ks:[]},t.sign=1,i(b.ms,[e],t)},C=b.prototype;b.ms=[],b.prepare=function(e){if(!e[u]){e[u]=1;var t,n,r,i,a,c=e.prototype,s={};for(var m in c)if(t=c[m],n=m.match(y))for(r=n[1],i=n[2],i=i.split(o),a=i.length-1;a>-1;a--)n=i[a],s[n]=1,c[r+p+n+h]=t;else"render"==m&&t!=f&&(c[m]=v(t));i&&(c.$evts=s)}},b.mixin=function(e,t){t&&b.ms.push(t),s(C,e)},s(s(C,n),{render:f,locationChange:f,init:f,hasTmpl:!0,load:function(){var e=this,t=e.hasTmpl,n=arguments,r=function(r){t&&(e.template=e.wrapMxEvent(r)),e.dEvts(),e.fire("interact",{tmpl:t},1),i(e.init,n,e),e.fire("inited",0,1),e.owner.viewInited=1,i(e.render,c,e);var a=!t&&!e.rendered;a&&(e.rendered=1,e.fire("primed",0,1))};t?e.fetchTmpl(e.path,e.wrapAsync(r)):r()},beginUpdate:function(){var e=this;e.sign>0&&e.rendered&&e.fire("prerender")},endUpdate:function(){var e=this;e.sign>0&&(e.rendered||(e.fire("primed",0,1),e.rendered=1),e.fire("rendered"))},notifyUpdate:function(){var e=this;return e.sign>0&&(e.sign++,e.fire("rendercall")),e.sign},wrapMxEvent:function(e){return(e+"").replace(l,"$&"+this.id+d)},wrapAsync:function(e){var t=this,n=t.sign;return function(){n>0&&n==t.sign&&e&&e.apply(this,arguments)}},setViewHTML:function(e){var t,n=this;n.beginUpdate(),n.sign>0&&(t=n.$(n.id),t&&(t.innerHTML=e)),n.endUpdate()},observeLocation:function(e){var n,r=this;n=r.$ol,n.f=1;var i=n.ks;t._o(e)&&(n.pn=e.pathname,e=e.keys),e&&(n.ks=i.concat((e+"").split(o)))},olChg:function(e){var t=this,n=t.$ol,r=1;return n.f&&(r=0,n.pn&&(r=e.pathname),r||(r=e.isParam(n.ks))),r},oust:function(){var e=this;e.sign>0&&(e.sign=0,e.fire("destroy",0,1,1),e.dEvts(1)),e.sign--},pEvt:function(e){var t=this;if(t.sign>0){var n=e.info,r=e.se,a=m.get(n);a||(a=n.match(x),a={n:a[1],f:a[2],i:a[3],p:{}},a.i&&a.i.replace(w,function(e,t,n){a.p[t]=n}),m.set(n,a));var o=a.n+p+e.st+h,c=t[o];if(c){var f=g[a.f];f&&f.call(g,r),i(c,{currentId:e.cId,targetId:e.tId,type:e.st,srcEvent:r,halt:g.halt,prevent:g.prevent,stop:g.stop,params:a.p},t)}}},dEvts:function(e){var t=this,n=t.$evts,i=t.vom;for(var a in n)r.act(a,e,i)}});var E={},M="?t="+Math.random(),_={},I={};return b.prototype.fetchTmpl=function(e,t){var n=this,r="template"in n;if(r)t(n.template);else if(a(_,e))t(_[e]);else{var o=e.indexOf("/"),c=e.substring(0,o);E[c]||(E[c]=seajs.data.paths[c]);var f=E[c]+e.substring(o+1)+".html",s=I[f],u=function(n){t(_[e]=n)};s?s.push(u):(s=I[f]=[u],$.ajax({url:f+M,success:function(e){i(s,e),delete I[f]},error:function(e,t){i(s,t),delete I[f]}}))}},b.extend=function(e,n,r){var a=this,o=function(){o.superclass.constructor.apply(this,arguments),n&&i(n,arguments,this)};return o.extend=a.extend,t.extend(o,a,e,r)},b}),r("magix/vom",["magix/vframe","magix/magix","magix/event"],function(e){var t=e("magix/vframe"),n=e("magix/magix"),r=e("magix/event"),i=n.has,a=n.mix,o=0,c=0,f=0,s=0,u={},v={},m={},p=n.mix({all:function(){return u},add:function(e,t){i(u,e)||(o++,u[e]=t,p.fire("add",{vframe:t}))},get:function(e){return u[e]},remove:function(e,t){var n=u[e];n&&(o--,t&&c--,delete u[e],p.fire("remove",{vframe:n}))},vfCreated:function(){if(!s){c++;var e=c/o;e>f&&p.fire("progress",{percent:f=e},s=1==e)}},locChged:function(e){var n,r=e.loc;if(r?n=1:r=e.location,a(v,r),!n){a(m,e.changed);var i=t.root(p,v,m);m.view?i.mountView(r.view):i.locChged()}}},r);return p}),n.createElement("vframe")})(null,this,document,define);