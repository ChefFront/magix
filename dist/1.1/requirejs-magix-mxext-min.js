!function(a,b,c,d,e,f){f=0,e=function(a){return a.id||(a.id="mx_n_"+ ++f)},d("magix/magix",function(){var c=/\/\.\/|\/[^\/.]+?\/\.{2}\/|([^:\/])\/\/+|\.{2}\//,d=/\/[^\/]*$/,e=/[#?].*$/,f="",g=/([^=&?\/#]+)=?([^&=#?]*)/g,h="pathname",i=/^https?:\/\//i,j=0,k="/",l="vframe",m="\n",n=b.console,o=n&&n.error,p=function(){},q={tagName:l,rootId:"magix_vf_root",progress:p,coded:1,execError:function(a){o&&n.error(a)}},r=q.hasOwnProperty,s=function(a,b){return a&&r.call(a,b)},t=function(b){return function(c,d,e){switch(arguments.length){case 0:e=b;break;case 1:e=A._o(c)?w(b,c):s(b,c)?b[c]:a;break;case 2:d===a?(delete b[c],e=d):b[c]=e=d}return e}},u=function(a,b){return b.f-a.f||b.t-a.t},v=function(a,b){var c=this;return c instanceof v?(c.c=[],c.x=a||20,c.b=c.x+(0|b||5)):c=new v(a,b),c},w=function(a,b,c){for(var d in b)c&&s(c,d)||(a[d]=b[d]);return a};w(v.prototype,{get:function(a){var b,c=this,d=c.c;return a=h+a,s(d,a)&&(b=d[a],b.f>=1&&(b.f++,b.t=j++,b=b.v)),b},list:function(){return this.c},set:function(a,b,c){var d=this,e=d.c,f=h+a,g=e[f];if(!s(e,f)){if(e.length>=d.b){e.sort(u);for(var i=d.b-d.x;i--;)g=e.pop(),delete e[g.k],g.m&&z(g.m,g.o,g)}g={},e.push(g),e[f]=g}return g.o=a,g.k=f,g.v=b,g.f=1,g.t=j++,g.m=c,b},del:function(a){a=h+a;var b=this.c,c=b[a];c&&(c.f=-1e5,c.v=f,delete b[a],c.m&&(z(c.m,c.o,c),c.m=f))},has:function(a){return a=h+a,s(this.c,a)}});var x=v(60),y=v(),z=function(a,b,c,d,e,f){for(A._a(a)||(a=[a]),b&&(A._a(b)||b.callee)||(b=[b]),d=0;d<a.length;d++)try{f=a[d],e=f&&f.apply(c,b)}catch(g){q.execError(g)}return e},A={mix:w,has:s,safeExec:z,noop:p,config:t(q),start:function(a){var b=this;w(q,a),b.use(["magix/router","magix/vom",a.iniFile],function(c,d,e){q=w(q,e,a),q["!tnc"]=q.tagName!=l,c.on("!ul",d.locChged),c.on("changed",d.locChged),d.on("progress",q.progress),b.use(q.extensions,c.start)})},keys:Object.keys||function(a){var b=[];for(var c in a)s(a,c)&&b.push(c);return b},local:t({}),path:function(a,b){var g=a+m+b,h=y.get(g);if(!h){if(i.test(b))h=b;else if(a=a.replace(e,f).replace(d,f)+k,b.charAt(0)==k){var j=i.test(a)?8:0,l=a.indexOf(k,j);h=a.substring(0,l)+b}else h=a+b;for(;c.test(h);)h=h.replace(c,"$1/");y.set(g,h)}return h},pathToObject:function(a,b){var c=a+m+b,d=x.get(c);if(!d){d={};var j={},l=f;e.test(a)?l=a.replace(e,f):~a.indexOf("=")||(l=a);var n=a.replace(l,f);if(l&&i.test(l)){var o=l.indexOf(k,8);l=~o?l.substring(o):k}n.replace(g,function(a,c,d){if(b)try{d=decodeURIComponent(d)}catch(e){}j[c]=d}),d[h]=l,d.params=j,x.set(c,d)}return d},objectToPath:function(a,b,c){var d,e=a[h],f=[],g=a.params;for(var i in g)d=g[i],(!c||d||s(c,i))&&(b&&(d=encodeURIComponent(d)),f.push(i+"="+d));return f.length&&(e=e+"?"+f.join("&")),e},listToMap:function(a,b){var c,d,e,f={};if(A._s(a)&&(a=a.split(",")),a&&(e=a.length))for(c=0;e>c;c++)d=a[c],f[b?d[b]:d]=b?d:1;return f},cache:v},B=Object.prototype.toString;return w(A,{use:function(a,b){a?($.isArray(a)||(a=[a]),require(a,b)):b&&b()},_a:$.isArray,_f:$.isFunction,_o:function(a){return"[object Object]"==B.call(a)},_s:function(a){return"[object String]"==B.call(a)},_n:function(a){return"[object Number]"==B.call(a)},extend:function(a,b,c,d){a.superclass=b.prototype,b.prototype.constructor=b;var e=function(){};return e.prototype=b.prototype,a.prototype=new e,A.mix(a.prototype,c),A.mix(a,d),a.prototype.constructor=a,a}})}),d("magix/router",["magix/magix","magix/event"],function(a,c){var d,e,f,g,h,i,j="",k="pathname",l="view",m=a.has,n=a.mix,o=a.keys,p=a.config(),q=a.cache(),r=a.cache(40),s={params:{},href:j},t=/#.*$/,u=/^[^#]*#?!?/,v="params",w=function(a,b,c){if(a){c=this[v],a=(a+j).split(",");for(var d=0;d<a.length&&!(b=m(c,a[d]));d++);}return b},x=function(){return this[k]},y=function(){return this[l]},z=function(a,b,c,d){return c=this,d=c[v],arguments.length>1?d[a]=b:d[a]},A=function(c){var d=a.pathToObject(c,g),e=d[k];return e&&i&&(d[k]=a.path(b.location[k],e)),d},B=n({viewInfo:function(b,c){var d,f;if(!e){e={rs:p.routes||{},nf:p.notFoundView};var g=p.defaultView;e.dv=g;var h=p.defaultPathname||j;d=e.rs,e.f=a._f(d),e.f||d[h]||!g||(d[h]=g),e[k]=h}return b||(b=e[k]),d=e.rs,f=e.f?d.call(p,b,c):d[b],{view:f||e.nf||e.dv,pathname:b}},start:function(){var a=b.history;f=p.nativeHistory,g=p.coded,h=f&&a.pushState,i=f&&!h,h?B.useState():B.useHash(),B.route()},parseQH:function(a,c){a=a||b.location.href;var d=q.get(a);if(!d){var e=a.replace(t,j),g=a.replace(u,j),h=A(e),i=A(g),m={};n(m,h[v]),n(m,i[v]),d={get:z,set:z,href:a,refHref:s.href,srcQuery:e,srcHash:g,query:h,hash:i,params:m},q.set(a,d)}if(c&&!d[l]){var o;o=d.hash[k]||f&&d.query[k];var p=B.viewInfo(o,d);n(d,p)}return d},getChged:function(a,b){var c=a.href,d=b.href,e=c+"\n"+d,f=r.get(e);if(!f){var g,h,i;f={},f[l]=i,f[k]=i,f[v]={};var j,m,n=[k,l];for(j=1;j>=0;j--)m=n[j],h=a[m],i=b[m],h!=i&&(f[m]={from:h,to:i},g=1);var p=a[v],q=b[v];for(n=o(p).concat(o(q)),j=n.length-1;j>=0;j--)m=n[j],h=p[m],i=q[m],h!=i&&(f[v][m]={from:h,to:i},g=1);f.occur=g,f.isParam=w,f.isPathname=x,f.isView=y,r.set(e,f)}return f},route:function(){var a=B.parseQH(0,1),b=!s.get,c=B.getChged(s,a);s=a,c.occur&&(d=a,B.fire("changed",{location:a,changed:c,force:b}))},navigate:function(b,c,e){if(!c&&a._o(b)&&(c=b,b=j),c&&(b=a.objectToPath({params:c,pathname:b},g)),b){var f=A(b),l={};if(l[v]=n({},f[v]),l[k]=f[k],l[k]){if(i){var o=d.query[v];for(var p in o)m(o,p)&&!m(l[v],p)&&(l[v][p]=j)}}else{var q=n({},d[v]);l[v]=n(q,l[v]),l[k]=d[k]}var r,s=a.objectToPath(l,g,d.query[v]);r=s!=d[h?"srcQuery":"srcHash"],r&&(h?(B.poped=1,history[e?"replaceState":"pushState"](j,j,s),B.route()):(n(l,d,l),l.srcHash=s,l.hash={params:l[v],pathname:l[k]},B.fire("!ul",{loc:d=l}),s="#!"+s,e?location.replace(s):location.hash=s))}}},c);return B.useState=function(){var a=B,b=location.href;$(WIN).on("popstate",function(){var c=location.href==b;(a.poped||!c)&&(a.poped=1,a.route())})},B.useHash=function(){$(WIN).on("hashchange",B.route)},B}),d("magix/body",["magix/magix"],function(d){var f,g=d.has,h=d.mix,i={},j={},k=String.fromCharCode(26),l="mx-ei",m="mx-owner",n="addEventListener",o="removeEventListener",p=c.body,q=p[n],r="parentNode",s={},t="on",u=",",v=function(a,b,c){return c?a.setAttribute(b,c):c=a.getAttribute(b),c},w=function(){this.returnValue=!1},x=function(){this.cancelBubble=!0},y={special:function(a){h(i,a)},process:function(c){if(c=c||b.event,c&&!c[t]){var d=c.target||c.srcElement||p;for(c[t]=1;d&&1!=d.nodeType;)d=d[r];for(var h,i,j=d,n=c.type,o=s[n]||(s[n]=new RegExp(u+n+"(?:,|$)")),y="mx-"+n,z=[];j&&1==j.nodeType&&(h=v(j,y),i=v(j,l),!h&&!o.test(i));)z.push(j),j=j[r];if(h){var A,B=h.split(k);if(B.length>1&&(A=B[0],h=B.pop()),A=A||v(j,m),!A)for(var C=j,D=f.all();C;){if(g(D,C.id)){v(j,m,A=C.id);break}C=C[r]}if(!A)throw Error("bad:"+h);var E=f.get(A),F=E&&E.view;F&&(q||(c.preventDefault=w,c.stopPropagation=x),F.pEvt({info:h,se:c,st:n,tId:e(d),cId:e(j)}))}else{for(var G;z.length;)G=z.shift(),i=v(G,l)||t,o.test(i)||(i=i+u+n,v(G,l,i));G=a}j=d=a}},act:function(b,c,d){var e=j[b]||0,g=e>0?1:0,h=y.process;if(e+=c?-g:g,!e){d&&(f=d);var k=i[b];k?y.lib(p,b,c,h):q?p[c?o:n](b,h,!1):p[t+b]=c?a:h,c||(e=1)}j[b]=e}},z={focus:2,blur:2,mouseenter:2,mouseleave:2};return y.special(z),y.lib=function(a,b,c,d){var e=z[b];1==e?$(a)[c?"off":"on"](b,d):$(a)[(c?"un":"")+"delegate"]("[mx-"+b+"]",b,d)},y}),d("magix/event",["magix/magix"],function(a){var b=function(a){return"~"+a},c=a.safeExec,d={fire:function(a,d,e,f){var g=b(a),h=this,i=h[g];if(i){d||(d={}),d.type||(d.type=a);for(var j,k,l=i.length,m=l-1;l--;)j=f?l:m-l,k=i[j],(k.d||k.r)&&(i.splice(j,1),m--),k.d||c(k.f,d,h);e=e||0>m}e&&delete h[g]},on:function(a,c,d){var e=b(a),f=this[e]||(this[e]=[]),g={f:c};isNaN(d)?(g.r=d,f.push(g)):f.splice(0|d,0,g)},off:function(a,c){var d=b(a),e=this[d];if(e)if(c){for(var f,g=e.length-1;g>=0;g--)if(f=e[g],f.f==c&&!f.d){f.d=1;break}}else delete this[d]},once:function(a,c){this.on(a,c,b)}};return a.mix(a.local,d),d}),d("magix/vframe",["magix/magix","magix/event","magix/view"],function(b,d,f){var g,h,i,j,k,l,m,n,o,p,q,r=b.safeExec,s=[],t=b.mix,u=b.config(),v=b.has,w="querySelectorAll",x="alter",y="created",z=function(a){return"object"==typeof a?a:c.getElementById(a)},A=function(a,b,d){return b=z(a),b&&(d=i?c[w]("#"+e(b)+j):b.getElementsByTagName(g)),d||s},B=function(a,b,c){if(a=z(a),b=z(b),a&&b)if(a!==b)try{c=l?b.contains(a):16&b.compareDocumentPosition(a)}catch(d){c=0}else c=1;return c},C=function(a){var b=this;b.id=a,b.cM={},b.cC=0,b.rC=0,b.sign=1<<30,b.rM={},b.owner=q,q.add(a,b)};return C.root=function(b,d,e){if(!m){g=u.tagName,h=u["!tnc"],k=h?"mx-vframe":"mx-defer",i=h&&c[w],j=" "+g+"[mx-vframe]";var f=c.body;l=f.contains,o=d,p=e,q=b;var n=u.rootId,r=z(n);r||(r=c.createElement(g),r.id=n,f.appendChild(r),r=a),m=new C(n)}return m},t(t(C.prototype,d),{mountView:function(a,c){var d=this,e=z(d.id);if(d._a||(d._a=1,d._t=e.innerHTML),d.unmountView(),a){var g=b.pathToObject(a),h=g.pathname,i=--d.sign;b.use(h,function(a){if(i==d.sign){f.prepare(a);var b=new a({owner:d,id:d.id,$:z,path:h,vom:q,location:o});d.view=b;var j=function(){d.mountZoneVframes()};b.on("interact",function(a){a.tmpl||(e.innerHTML=d._t,j()),b.on("primed",function(){d.viewPrimed=1,d.fire("viewMounted")}),b.on("rendered",j),b.on("prerender",function(){d.unmountZoneVframes(0,1)||d.cAlter()})},0),c=c||{},b.load(t(c,g.params,c),p)}})}},unmountView:function(){var a=this,b=a.view;if(b){n||(n={}),a.unmountZoneVframes(0,1),a.cAlter(n),a.view=0,b.oust();var c=z(a.id);c&&a._a&&(c.innerHTML=a._t),a.viewInited=0,a.viewPrimed&&(a.viewPrimed=0,a.fire("viewUnmounted")),n=0}a.sign--},mountVframe:function(a,b,c){var d=this;d.fcc&&d.cAlter();var e=q.get(a);return e||(e=new C(a),e.pId=d.id,v(d.cM,a)||d.cC++,d.cM[a]=1),e.mountView(b,c),e},mountZoneVframes:function(a,b){var c=this,d=a||c.id;c.unmountZoneVframes(d,1);var f=A(d),g=f.length,i={};if(g)for(var j,l,m,n,o=0;g>o;o++)if(j=f[o],l=e(j),!v(i,l)&&(m=j.getAttribute("mx-view"),n=!j.getAttribute(k),n=n!=h,n||m)){c.mountVframe(l,m,b);for(var p,q=A(j),r=0,s=q.length;s>r;r++)p=q[r],i[e(p)]=1}c.cCreated()},unmountVframe:function(a,b){var c=this;a=a||c.id;var d=q.get(a);if(d){var e=d.fcc;d.unmountView(),q.remove(a,e);var f=q.get(d.pId);f&&v(f.cM,a)&&(delete f.cM[a],f.cC--,b||f.cCreated())}},unmountZoneVframes:function(a,b){var c,d,e=this,f=e.cM;for(d in f)(!a||B(d,a))&&e.unmountVframe(d,c=1);return b||e.cCreated(),c},cCreated:function(a){var b=this;if(b.cC==b.rC){var c=b.view;c&&!b.fcc&&(b.fcc=1,b.fca=0,c.fire(y,a),b.fire(y,a)),q.vfCreated();var d=b.id,e=q.get(b.pId);e&&!v(e.rM,d)&&(e.rM[d]=e.cM[d],e.rC++,e.cCreated(a))}},cAlter:function(a){var b=this;a||(a={});var c=b.fcc;if(b.fcc=0,!b.fca&&c){var d=b.view,e=b.id;d&&(b.fca=1,d.fire(x,a),b.fire(x,a));var f=q.get(b.pId);f&&v(f.rM,e)&&(f.rC--,delete f.rM[e],f.cAlter(a))}},locChged:function(){var a=this,c=a.view;if(a.viewInited&&c&&c.sign>0){var d=c.olChg(p),e={location:o,changed:p,prevent:function(){this.cs=s},to:function(a){a=a||s,b._s(a)&&(a=a.split(",")),this.cs=a}};d&&r(c.locationChange,e,c);for(var f,g=e.cs||b.keys(a.cM),h=0,i=g.length;i>h;h++)f=q.get(g[h]),f&&f.locChged()}}}),C}),d("magix/view",["magix/magix","magix/event","magix/body"],function(a,b,c){var d=a.safeExec,e=a.has,f=",",g=[],h=a.noop,i=a.mix,j="~",k=function(a){return function(){var b=this,c=b.notifyUpdate();c>0&&a.apply(b,arguments)}},l=a.cache(40),m="<",n=">",o=/\smx-(?!view|defer|owner|vframe)[a-z]+\s*=\s*"/g,p=String.fromCharCode(26),q={prevent:function(a){a=a||this.srcEvent,a.preventDefault()},stop:function(a){a=a||this.srcEvent,a.stopPropagation()},halt:function(a){this.prevent(a),this.stop(a)}},r=/(\w+)(?:<(\w+)>)?(?:\(?{([\s\S]*)}\)?)?/,s=/(\w+):([^,]+)/g,t=/([$\w]+)<([\w,]+)>/,u=function(a){var b=this;i(b,a),b.$ol={ks:[]},b.sign=1,d(u.ms,[a],b)},v=u.prototype;u.ms=[],u.prepare=function(a){if(!a[j]){a[j]=1;var b,c,d,e,g,i=a.prototype,l={};for(var o in i)if(b=i[o],c=o.match(t))for(d=c[1],e=c[2],e=e.split(f),g=e.length-1;g>-1;g--)c=e[g],l[c]=1,i[d+m+c+n]=b;else"render"==o&&b!=h&&(i[o]=k(b));e&&(i.$evts=l)}},u.mixin=function(a,b){b&&u.ms.push(b),i(v,a)},i(i(v,b),{render:h,locationChange:h,init:h,hasTmpl:!0,load:function(){var a=this,b=a.hasTmpl,c=arguments,e=function(e){b&&(a.template=a.wrapMxEvent(e)),a.dEvts(),a.fire("interact",{tmpl:b},1),d(a.init,c,a),a.fire("inited",0,1),a.owner.viewInited=1,d(a.render,g,a);var f=!b&&!a.rendered;f&&(a.rendered=1,a.fire("primed",0,1))};b?a.fetchTmpl(a.path,a.wrapAsync(e)):e()},beginUpdate:function(){var a=this;a.sign>0&&a.rendered&&a.fire("prerender")},endUpdate:function(){var a=this;a.sign>0&&(a.rendered||(a.fire("primed",0,1),a.rendered=1),a.fire("rendered"))},notifyUpdate:function(){var a=this;return a.sign>0&&(a.sign++,a.fire("rendercall")),a.sign},wrapMxEvent:function(a){return(a+"").replace(o,"$&"+this.id+p)},wrapAsync:function(a){var b=this,c=b.sign;return function(){c>0&&c==b.sign&&a&&a.apply(this,arguments)}},setViewHTML:function(a){var b,c=this;c.beginUpdate(),c.sign>0&&(b=c.$(c.id),b&&(b.innerHTML=a)),c.endUpdate()},observeLocation:function(b){var c,d=this;c=d.$ol,c.f=1;var e=c.ks;a._o(b)&&(c.pn=b.pathname,b=b.keys),b&&(c.ks=e.concat((b+"").split(f)))},olChg:function(a){var b=this,c=b.$ol,d=1;return c.f&&(d=0,c.pn&&(d=a.pathname),d||(d=a.isParam(c.ks))),d},oust:function(){var a=this;a.sign>0&&(a.sign=0,a.fire("destroy",0,1,1),a.dEvts(1)),a.sign--},pEvt:function(a){var b=this;if(b.sign>0){var c=a.info,e=a.se,f=l.get(c);f||(f=c.match(r),f={n:f[1],f:f[2],i:f[3],p:{}},f.i&&f.i.replace(s,function(a,b,c){f.p[b]=c}),l.set(c,f));var g=f.n+m+a.st+n,h=b[g];if(h){var i=q[f.f];i&&i.call(q,e),d(h,{currentId:a.cId,targetId:a.tId,type:a.st,srcEvent:e,halt:q.halt,prevent:q.prevent,stop:q.stop,params:f.p},b)}}},dEvts:function(a){var b=this,d=b.$evts,e=b.vom;for(var f in d)c.act(f,a,e)}});var w={},x="?t="+Math.random(),y={},z={};return u.prototype.fetchTmpl=function(a,b){var c=this,f="template"in c;if(f)b(c.template);else if(e(y,a))b(y[a]);else{var g=a.indexOf("/"),h=a.substring(0,g);w[h]||(w[h]=require.s.contexts._.config.paths[h]);var i=w[h]+a.substring(g+1)+".html",j=z[i],k=function(c){b(y[a]=c)};j?j.push(k):(j=z[i]=[k],$.ajax({url:i+x,success:function(a){d(j,a),delete z[i]},error:function(a,b){d(j,b),delete z[i]}}))}},u.extend=function(b,c,e){var f=this,g=function(){g.superclass.constructor.apply(this,arguments),c&&d(c,arguments,this)};return g.extend=f.extend,a.extend(g,f,b,e)},u}),d("magix/vom",["magix/vframe","magix/magix","magix/event"],function(a,b,c){var d=b.has,e=b.mix,f=0,g=0,h=0,i=0,j={},k={},l={},m=b.mix({all:function(){return j},add:function(a,b){d(j,a)||(f++,j[a]=b,m.fire("add",{vframe:b}))},get:function(a){return j[a]},remove:function(a,b){var c=j[a];c&&(f--,b&&g--,delete j[a],m.fire("remove",{vframe:c}))},vfCreated:function(){if(!i){g++;var a=g/f;a>h&&m.fire("progress",{percent:h=a},i=1==a)}},locChged:function(b){var c,d=b.loc;if(d?c=1:d=b.location,e(k,d),!c){e(l,b.changed);var f=a.root(m,k,l);l.view?f.mountView(d.view):f.locChged()}}},c);return m}),d("mxext/mmanager",["magix/magix","magix/event"],function(b,c){var d=b.has,e=b.safeExec,f=b._a,g=b.mix,h="mr",i=String.fromCharCode(26),j=12e5,k=function(a,b,c){b=[];for(c in a)b.push(c,h,a[c]);return b},l=function(a,b,c){for(var d,e=[b.name],f={},g=a.length-1;g>-1;g--)d=a[g],f[d]?a.splice(g,1):e.push(f[d]=k(b[d]),k(c[d]));return e.join(i)},m=function(a){var b=a.cache;if(b){var c=0|a.cacheTime;b=c?c:b===!0?j:0|b}return b},n=Date.now||function(){return+new Date},o=n(),p=function(a){throw Error(a)},q=function(a,c){var d=this;d.$mClass=a,d.$mCache=b.cache(),d.$mCacheKeys={},d.$mMetas={},c=c?f(c)?c:[c]:[],d.$sKeys=["postParams","urlParams"].concat(c),d.id="mm"+o--,e(q.ms,arguments,d)},r=[].slice,s=function(a,b,c,d){return function(){return a.apply(b,[c,d].concat(r.call(arguments)))}},t=function(a,b){var c=b.b,d=b.a,f=d[c];if(f){var g=f.q;delete d[c],e(g,a,f.e)}},u=function(b,c,d){var f,g=this,h=c.a,i=c.c,j=c.d,k=c.g,l=c.i,m=c.j,o=c.k,p=c.l,q=c.m,r=c.n,s=c.o;c.b++,delete i[g.id];var t=g.$mm,u=t.key,v=t.meta;if(j[b]=g,d)c.e=1,f=1,c.f=d,k.msg=d,k[b]=d,m.fire("fail",{model:g,meta:v,msg:d});else{if(!u||u&&!l.has(u)){u&&l.set(u,g),t.done=n();var w=t.after;w&&e(w,[g,v]),m.fire("done",{model:g,meta:v})}t.used>0&&(g.fromCache=1),t.used++}if(!h.$oust){if(o==x.ONE){var y=p?q[b]:q;y&&(r[b]=e(y,[f?k:a,g,k],h))}else if(o==x.ORDER){s[b]={m:g,e:f,s:d};for(var z,A,B=s.i||0;z=s[B];B++)A=p?q[B]:q,z.e&&(k.msg=z.s,k[B]=z.s),r[B]=e(A,[z.e?k:a,z.m,k].concat(r),h);s.i=B}c.b==c.h&&(c.e||(k=a),o==x.ALL?(j.unshift(k),r[0]=k,r[1]=e(q,j,h)):r.unshift(k),h.$ntId=setTimeout(function(){h.doNext(r)},30))}},v=function(a){return function(){var b=new y(this),c=arguments,d=c[c.length-1];return d&&d.manage&&(d.manage(b),c=r.call(c,0,-1)),b[a].apply(b,c)}},w=function(a,b){return function(c,d){var e=r.call(arguments,1);return this.send(c,e.length>1?e:d,a,b)}};g(q,{create:function(a,b){return new q(a,b)},mixin:function(a,b){b&&q.ms.push(b),g(q.prototype,a)},ms:[]});var x={ALL:1,ONE:2,ORDER:4},y=function(a){var b=this;b.$host=a,b.$reqs={},b.id=h+o--,b.$queue=[]};return g(y.prototype,{send:function(a,b,c,e){var g=this;if(g.$busy)return g.next(function(){this.send(a,b,c,e)}),g;g.$busy=1;var h=g.$host,i=h.$mCache,j=h.$mCacheKeys,k=g.$reqs;f(a)||(a=[a]);var l=a.length,m=[],n=f(b);n&&(m=new Array(b.length));for(var o,q={a:g,b:0,c:g.$reqs,d:new Array(l),g:{},h:l,i:i,j:h,k:c,l:n,m:b,n:m,o:[]},r=0;r<a.length;r++)if(o=a[r]){var v=h.getModel(o,e),w=v.cKey,x=v.entity,y=s(u,x,r,q);y.id=g.id,w&&d(j,w)?j[w].q.push(y):v.update?(k[x.id]=x,w&&(j[w]={q:[y],e:x},y=t),x.request(y,{a:j,b:w})):y()}else p("empty model");return g},fetchAll:function(a,b){return this.send(a,b,x.ALL)},saveAll:function(a,b){return this.send(a,b,x.ALL,1)},fetchOrder:w(x.ORDER),saveOrder:w(x.ORDER,1),saveOne:w(x.ONE,1),fetchOne:w(x.ONE),stop:function(){var a=this;clearTimeout(a.$ntId);var b=a.$host,c=a.$reqs,f=b.$mCacheKeys;for(var g in c){var h=c[g],i=h.$mm.key;if(i&&d(f,i)){for(var j,k=f[i],l=k.q,m=[],n=[],o=0;o<l.length;o++)j=l[o],j.id!=a.id?m.push(j):n.push(j);m.length?(e(n,"abort",k.e),k.q=m):h.abort()}else h.abort()}a.$reqs={},a.$queue=[],a.$busy=0},next:function(a){var b=this;if(b.$queue.push(a),!b.$busy){var c=b.$latest;b.doNext(c)}return b},doNext:function(a){var b=this;b.$busy=0;var c=b.$queue;if(c){var d=c.shift();d&&e(d,a,b)}b.$latest=a},destroy:function(){var a=this;a.$oust=1,a.stop()}}),g(g(q.prototype,c),{registerModels:function(a){var b=this,c=b.$mMetas;f(a)||(a=[a]);for(var d,e,g=0;g<a.length;g++)d=a[g],d&&(e=d.name,e?c[e]&&p("already exist:"+e):p("miss name"),d.cache=m(d),c[e]=d)},registerMethods:function(a){g(this,a)},createModel:function(a){var b,c=this,d=c.getModelMeta(a),f=m(a)||d.cache,g=new c.$mClass;g.set(d),g.$mm=b={used:0};var h=a.before||d.before;h&&e(h,[g,d]);var i=a.after||d.after;return b.after=i,f&&(b.key=l(c.$sKeys,d,a)),b.meta=d,a.name&&g.set(a),g.setUrlParams(d.urlParams),g.setPostParams(d.postParams),g.setUrlParams(a.urlParams),g.setPostParams(a.postParams),c.fire("inited",{model:g,meta:d}),g},getModelMeta:function(a){var b=this,c=b.$mMetas,d=a.name||a,e=c[d];return e||p("Unfound:"+d),e},getModel:function(a,b){var c,d,e=this;return b||(c=e.getCachedModel(a)),c||(d=1,c=e.createModel(a)),{entity:c,cKey:c.$mm.key,update:d}},saveAll:v("saveAll"),fetchAll:v("fetchAll"),saveOrder:v("saveOrder"),fetchOrder:v("fetchOrder"),saveOne:v("saveOne"),fetchOne:v("fetchOne"),createMRequest:function(a){var b=new y(this);return a&&a.manage&&a.manage(b),b},clearCacheByKey:function(a){var b=this,c=b.$mCache;c.del(a)},clearCacheByName:function(a){for(var b=this,c=b.$mCache,d=c.list(),e=0;e<d.length;e++){var f=d[e],g=f.v,h=g&&g.$mm;if(h){var i=h.meta.name;i==a&&c.del(h.key)}}},getCachedModel:function(b){var c,d=this,e=d.$mCache,f=a,g=d.getModelMeta(b),h=m(b)||g.cache;if(h&&(c=l(d.$sKeys,g,b)),c){var i=d.$mCacheKeys,j=i[c];j?f=j.e:(f=e.get(c),f&&h>0&&n()-f.$mm.done>h&&(d.clearCacheByKey(c),f=0))}return f}}),q}),d("mxext/model",["magix/magix"],function(a){var b=function(b,c){var d=this,e=function(){e.superclass.constructor.apply(this,arguments),c&&a.safeExec(c,arguments,this)};return a.mix(e,d,{prototype:!0}),a.extend(e,d,b)},c=+new Date,d=encodeURIComponent,e=a.has,f=a._o,g=a.toString,h=function(a){this.set(a),this.id="m"+c--};return a.mix(h,{GET:"GET",POST:"POST",extend:b}),a.mix(h.prototype,{sync:a.noop,getPostParams:function(){return this.getParams(h.POST)},getUrlParams:function(){return this.getParams(h.GET)},getParams:function(b){var c=this;b||(b=h.GET);var e,f="$"+b,g=c[f],i=[];for(var j in g){e=g[j],a._a(e)||(e=[e]);for(var k=0;k<e.length;k++)i.push(j+"="+d(e[k]))}return i.join("&")},setUrlParamsIf:function(a,b){this.setParams(a,b,h.GET,!0)},setPostParamsIf:function(a,b){var c=this;c.setParams(a,b,h.POST,!0)},setParams:function(a,b,c,d){var g=this,h="$"+c;g[h]||(g[h]={});var i=g[h];if(!f(a)&&a){var j={};j[a]=b,a=j}for(var k in a)d&&e(i,k)||(i[k]=a[k])},setPostParams:function(a,b){var c=this;c.setParams(a,b,h.POST)},setUrlParams:function(a,b){this.setParams(a,b,h.GET)},get:function(a,b,c){var d=this,e=arguments.length,f=2==e,h=d.$attrs;if(e){for(var i=(a+"").split(".");h&&i[0];)h=h[i.shift()];i[0]&&(h=c)}return f&&g.call(b)!=g.call(h)&&(h=b),h},set:function(a,b){var c=this;if(c.$attrs||(c.$attrs={}),f(a))for(var d in a)c.$attrs[d]=a[d];else a&&(c.$attrs[a]=b)},request:function(a,b){var c=this;c.$abt=0;var d=function(d,e){c.$abt||(f(e)||(e={data:e}),c.set(e),a(d,b))};c.$trans=c.sync(c.$temp=d)},abort:function(){var a=this,b=a.$trans,c=a.$temp;c&&c("abort"),a.$abt=1,b&&b.abort&&b.abort(),a.$trans=0},isAborted:function(){return this.$abt}}),h}),d("mxext/view",["magix/magix","magix/view","magix/router"],function(b,c,d){var e=window,f=0,g=b.safeExec,h=b.has,i=[],j="rendercall",k="destroy",l=function(a){e.clearTimeout(a),e.clearInterval(a)},m=function(a){var b=a&&a[k];b&&g(b,i,a)},n=function(a){var b=this,c=b.$res,d=a.type==j,e=a.type!=k;for(var f in c){var g=c[f];(!d||g.mr)&&b.destroyManaged(f,e)}},o=c.extend({navigate:d.navigate,manage:function(a,c,d){var e=this,g=arguments,h=1,i=e.$res;1==g.length?(c=a,a="res_"+f++,h=0):e.destroyManaged(a);var j;j=b._n(c)?l:m;var k={hk:h,res:c,ol:d,mr:c&&c.$reqs,oust:j};return i[a]=k,c},getManaged:function(b,c){var d=this,e=d.$res,f=a;if(h(e,b)){var g=e[b];f=g.res,c&&delete e[b]}return f},removeManaged:function(a){return this.getManaged(a,1)},destroyManaged:function(a,b){var c,d=this,e=d.$res,f=e[a];return!f||b&&f.ol||(c=f.res,f.oust(c),f.hk&&b||delete e[a]),c}},function(){var a=this;a.$res={},a.on("interact",function(){a.on(j,n),a.on("prerender",n),a.on(k,n)}),g(o.ms,arguments,a)},{ms:[],mixin:function(a,c){c&&o.ms.push(c),b.mix(o.prototype,a)}});return o}),c.createElement("vframe")}(null,this,document,define);