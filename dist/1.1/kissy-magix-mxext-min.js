!function(a,b,c,d,e,f){f=0,e=function(a){return a.id||(a.id="mx_n_"+ ++f)},d.add("magix/magix",function(c){var d=[].slice,e=/\/\.\/|\/[^\/.]+?\/\.{2}\/|([^:\/])\/\/+|\.{2}\//,f=/\/[^\/]*$/,g=/[#?].*$/,h="",i=/([^=&?\/#]+)=?([^&=#?]*)/g,j="pathname",k=/^https?:\/\//i,l=0,m="/",n="vframe",o="\n",p=b.console,q=p&&p.error,r=function(){},s={tagName:n,rootId:"magix_vf_root",progress:r,coded:1,execError:function(a){q&&p.error(a)}},t=s.hasOwnProperty,u=function(a,b){return a&&t.call(a,b)},v=function(b){return function(c,d,e){switch(arguments.length){case 0:e=b;break;case 1:e=C._o(c)?y(b,c):u(b,c)?b[c]:a;break;case 2:d===a?(delete b[c],e=d):b[c]=e=d}return e}},w=function(a,b){return b.f-a.f||b.t-a.t},x=function(a,b){var c=this;return c instanceof x?(c.c=[],c.x=a||20,c.b=c.x+(0|b||5)):c=new x(a,b),c},y=function(a,b,c){for(var d in b)c&&u(c,d)||(a[d]=b[d]);return a};y(x.prototype,{get:function(a){var b,c=this,d=c.c;return a=j+a,u(d,a)&&(b=d[a],b.f>=1&&(b.f++,b.t=l++,b=b.v)),b},list:function(){return this.c},set:function(a,b,c){var d=this,e=d.c,f=j+a,g=e[f];if(!u(e,f)){if(e.length>=d.b){e.sort(w);for(var h=d.b-d.x;h--;)g=e.pop(),delete e[g.k],g.m&&B(g.m,g.o,g)}g={},e.push(g),e[f]=g}return g.o=a,g.k=f,g.v=b,g.f=1,g.t=l++,g.m=c,b},del:function(a){a=j+a;var b=this.c,c=b[a];c&&(c.f=-1e5,c.v=h,delete b[a],c.m&&(B(c.m,c.o,c),c.m=h))},has:function(a){return a=j+a,u(this.c,a)}});var z=x(60),A=x(),B=function(a,b,c,d,e,f){for(C._a(a)||(a=[a]),b&&(C._a(b)||b.callee)||(b=[b]),d=0;d<a.length;d++)try{f=a[d],e=f&&f.apply(c,b)}catch(g){s.execError(g)}return e},C={mix:y,has:u,safeExec:B,noop:r,config:v(s),start:function(a){var b=this;y(s,a),b.use(["magix/router","magix/vom",a.iniFile],function(c,d,e){s=y(s,e,a),s["!tnc"]=s.tagName!=n,c.on("!ul",d.locChged),c.on("changed",d.locChged),d.on("progress",s.progress),b.use(s.extensions,c.start)})},keys:Object.keys||function(a){var b=[];for(var c in a)u(a,c)&&b.push(c);return b},local:v({}),path:function(a,b){var c=a+o+b,d=A.get(c);if(!d){if(k.test(b))d=b;else if(a=a.replace(g,h).replace(f,h)+m,b.charAt(0)==m){var i=k.test(a)?8:0,j=a.indexOf(m,i);d=a.substring(0,j)+b}else d=a+b;for(;e.test(d);)d=d.replace(e,"$1/");A.set(c,d)}return d},pathToObject:function(a,b){var c=a+o+b,d=z.get(c);if(!d){d={};var e={},f=h;g.test(a)?f=a.replace(g,h):~a.indexOf("=")||(f=a);var l=a.replace(f,h);if(f&&k.test(f)){var n=f.indexOf(m,8);f=~n?f.substring(n):m}l.replace(i,function(a,c,d){if(b)try{d=decodeURIComponent(d)}catch(f){}e[c]=d}),d[j]=f,d.params=e,z.set(c,d)}return d},objectToPath:function(a,b,c){var d,e=a[j],f=[],g=a.params;for(var h in g)d=g[h],(!c||d||u(c,h))&&(b&&(d=encodeURIComponent(d)),f.push(h+"="+d));return f.length&&(e=e+"?"+f.join("&")),e},listToMap:function(a,b){var c,d,e,f={};if(C._s(a)&&(a=a.split(",")),a&&(e=a.length))for(c=0;e>c;c++)d=a[c],f[b?d[b]:d]=b?d:1;return f},cache:x};return y(C,{use:function(a,b){c.use(a&&a+h,function(a){b&&b.apply(a,d.call(arguments,1))})},_a:c.isArray,_f:c.isFunction,_o:c.isObject,_s:c.isString,_n:c.isNumber})}),d.add("magix/router",function(a,c,d,e){var f,g,h,i,j,k,l="",m="pathname",n="view",o=c.has,p=c.mix,q=c.keys,r=c.config(),s=c.cache(),t=c.cache(40),u={params:{},href:l},v=/#.*$/,w=/^[^#]*#?!?/,x="params",y=function(a,b,c){if(a){c=this[x],a=(a+l).split(",");for(var d=0;d<a.length&&!(b=o(c,a[d]));d++);}return b},z=function(){return this[m]},A=function(){return this[n]},B=function(a,b,c,d){return c=this,d=c[x],arguments.length>1?d[a]=b:d[a]},C=function(a){var d=c.pathToObject(a,i),e=d[m];return e&&k&&(d[m]=c.path(b.location[m],e)),d},D=p({viewInfo:function(a,b){var d,e;if(!g){g={rs:r.routes||{},nf:r.notFoundView};var f=r.defaultView;g.dv=f;var h=r.defaultPathname||l;d=g.rs,g.f=c._f(d),g.f||d[h]||!f||(d[h]=f),g[m]=h}return a||(a=g[m]),d=g.rs,e=g.f?d.call(r,a,b):d[a],{view:e||g.nf||g.dv,pathname:a}},start:function(){var a=b.history;h=r.nativeHistory,i=r.coded,j=h&&a.pushState,k=h&&!j,j?D.useState():D.useHash(),D.route()},parseQH:function(a,c){a=a||b.location.href;var d=s.get(a);if(!d){var e=a.replace(v,l),f=a.replace(w,l),g=C(e),i=C(f),j={};p(j,g[x]),p(j,i[x]),d={get:B,set:B,href:a,refHref:u.href,srcQuery:e,srcHash:f,query:g,hash:i,params:j},s.set(a,d)}if(c&&!d[n]){var k;k=d.hash[m]||h&&d.query[m];var o=D.viewInfo(k,d);p(d,o)}return d},getChged:function(a,b){var c=a.href,d=b.href,e=c+"\n"+d,f=t.get(e);if(!f){var g,h,i;f={},f[n]=i,f[m]=i,f[x]={};var j,k,l=[m,n];for(j=1;j>=0;j--)k=l[j],h=a[k],i=b[k],h!=i&&(f[k]={from:h,to:i},g=1);var o=a[x],p=b[x];for(l=q(o).concat(q(p)),j=l.length-1;j>=0;j--)k=l[j],h=o[k],i=p[k],h!=i&&(f[x][k]={from:h,to:i},g=1);f.occur=g,f.isParam=y,f.isPathname=z,f.isView=A,t.set(e,f)}return f},route:function(){var a=D.parseQH(0,1),b=!u.get,c=D.getChged(u,a);u=a,c.occur&&(f=a,D.fire("changed",{location:a,changed:c,force:b}))},navigate:function(a,b,d){if(!b&&c._o(a)&&(b=a,a=l),b&&(a=c.objectToPath({params:b,pathname:a},i)),a){var e=C(a),g={};if(g[x]=p({},e[x]),g[m]=e[m],g[m]){if(k){var h=f.query[x];for(var n in h)o(h,n)&&!o(g[x],n)&&(g[x][n]=l)}}else{var q=p({},f[x]);g[x]=p(q,g[x]),g[m]=f[m]}var r,s=c.objectToPath(g,i,f.query[x]);r=s!=f[j?"srcQuery":"srcHash"],r&&(j?(D.poped=1,history[d?"replaceState":"pushState"](l,l,s),D.route()):(p(g,f,g),g.srcHash=s,g.hash={params:g[x],pathname:g[m]},D.fire("!ul",{loc:f=g}),s="#!"+s,d?location.replace(s):location.hash=s))}}},d);return D.useState=function(){var a=location.href;e.on(b,"popstate",function(){var b=location.href==a;(D.poped||!b)&&(D.poped=1,D.route())})},D.useHash=function(){e.on(b,"hashchange",D.route)},D},{requires:["magix/magix","magix/event","event"]}),d.add("magix/body",function(d,f){var g,h=f.has,i=f.mix,j={},k={},l=String.fromCharCode(26),m="mx-ei",n="mx-owner",o="addEventListener",p="removeEventListener",q=c.body,r=q[o],s="parentNode",t={},u="on",v=",",w=function(a,b,c){return c?a.setAttribute(b,c):c=a.getAttribute(b),c},x=function(){this.returnValue=!1},y=function(){this.cancelBubble=!0},z={special:function(a){i(j,a)},process:function(c){if(c=c||b.event,c&&!c[u]){var d=c.target||c.srcElement||q;for(c[u]=1;d&&1!=d.nodeType;)d=d[s];for(var f,i,j=d,k=c.type,o=t[k]||(t[k]=new RegExp(v+k+"(?:,|$)")),p="mx-"+k,z=[];j&&1==j.nodeType&&(f=w(j,p),i=w(j,m),!f&&!o.test(i));)z.push(j),j=j[s];if(f){var A,B=f.split(l);if(B.length>1&&(A=B[0],f=B.pop()),A=A||w(j,n),!A)for(var C=j,D=g.all();C;){if(h(D,C.id)){w(j,n,A=C.id);break}C=C[s]}if(!A)throw Error("bad:"+f);var E=g.get(A),F=E&&E.view;F&&(r||(c.preventDefault=x,c.stopPropagation=y),F.pEvt({info:f,se:c,st:k,tId:e(d),cId:e(j)}))}else{for(var G;z.length;)G=z.shift(),i=w(G,m)||u,o.test(i)||(i=i+v+k,w(G,m,i));G=a}j=d=a}},act:function(b,c,d){var e=k[b]||0,f=e>0?1:0,h=z.process;if(e+=c?-f:f,!e){d&&(g=d);var i=j[b];i?z.lib(q,b,c,h):r?q[c?p:o](b,h,!1):q[u+b]=c?a:h,c||(e=1)}k[b]=e}},A={change:1,submit:1,focusin:1,focusout:1,mouseenter:2,mouseleave:2,mousewheel:1};return z.special(A),z.lib=function(a,b,c,e){d.use("event",function(d,f){var g=A[b];1==g?(g=c?"detach":"on",f[g](a,b,e)):(g=(c?"un":"")+"delegate",f[g](a,b,"[mx-"+b+"]",e))})},z},{requires:["magix/magix"]}),d.add("magix/event",function(a,b){var c=function(a){return"~"+a},d=b.safeExec,e={fire:function(a,b,e,f){var g=c(a),h=this,i=h[g];if(i){b||(b={}),b.type||(b.type=a);for(var j,k,l=i.length,m=l-1;l--;)j=f?l:m-l,k=i[j],(k.d||k.r)&&(i.splice(j,1),m--),k.d||d(k.f,b,h);e=e||0>m}e&&delete h[g]},on:function(a,b,d){var e=c(a),f=this[e]||(this[e]=[]),g={f:b};isNaN(d)?(g.r=d,f.push(g)):f.splice(0|d,0,g)},off:function(a,b){var d=c(a),e=this[d];if(e)if(b){for(var f,g=e.length-1;g>=0;g--)if(f=e[g],f.f==b&&!f.d){f.d=1;break}}else delete this[d]},once:function(a,b){this.on(a,b,c)}};return b.mix(b.local,e),e},{requires:["magix/magix"]}),d.add("magix/vframe",function(b,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=d.safeExec,t=[],u=d.mix,v=d.config(),w=d.has,x="querySelectorAll",y="alter",z="created",A=function(a){return"object"==typeof a?a:c.getElementById(a)},B=function(a,b,d){return b=A(a),b&&(d=j?c[x]("#"+e(b)+k):b.getElementsByTagName(h)),d||t},C=function(a,b,c){if(a=A(a),b=A(b),a&&b)if(a!==b)try{c=m?b.contains(a):16&b.compareDocumentPosition(a)}catch(d){c=0}else c=1;return c},D=function(a){var b=this;b.id=a,b.cM={},b.cC=0,b.rC=0,b.sign=1<<30,b.rM={},b.owner=r,r.add(a,b)};return D.root=function(b,d,e){if(!n){h=v.tagName,i=v["!tnc"],l=i?"mx-vframe":"mx-defer",j=i&&c[x],k=" "+h+"[mx-vframe]";var f=c.body;m=f.contains,p=d,q=e,r=b;var g=v.rootId,o=A(g);o||(o=c.createElement(h),o.id=g,f.appendChild(o),o=a),n=new D(g)}return n},u(u(D.prototype,f),{mountView:function(a,b){var c=this,e=A(c.id);if(c._a||(c._a=1,c._t=e.innerHTML),c.unmountView(),a){var f=d.pathToObject(a),h=f.pathname,i=--c.sign;d.use(h,function(a){if(i==c.sign){g.prepare(a);var d=new a({owner:c,id:c.id,$:A,path:h,vom:r,location:p});c.view=d;var j=function(){c.mountZoneVframes()};d.on("interact",function(a){a.tmpl||(e.innerHTML=c._t,j()),d.on("primed",function(){c.viewPrimed=1,c.fire("viewMounted")}),d.on("rendered",j),d.on("prerender",function(){c.unmountZoneVframes(0,1)||c.cAlter()})},0),b=b||{},d.load(u(b,f.params,b),q)}})}},unmountView:function(){var a=this,b=a.view;if(b){o||(o={}),a.unmountZoneVframes(0,1),a.cAlter(o),a.view=0,b.oust();var c=A(a.id);c&&a._a&&(c.innerHTML=a._t),a.viewInited=0,a.viewPrimed&&(a.viewPrimed=0,a.fire("viewUnmounted")),o=0}a.sign--},mountVframe:function(a,b,c){var d=this;d.fcc&&d.cAlter();var e=r.get(a);return e||(e=new D(a),e.pId=d.id,w(d.cM,a)||d.cC++,d.cM[a]=1),e.mountView(b,c),e},mountZoneVframes:function(a,b){var c=this,d=a||c.id;c.unmountZoneVframes(d,1);var f=B(d),g=f.length,h={};if(g)for(var j,k,m,n,o=0;g>o;o++)if(j=f[o],k=e(j),!w(h,k)&&(m=j.getAttribute("mx-view"),n=!j.getAttribute(l),n=n!=i,n||m)){c.mountVframe(k,m,b);for(var p,q=B(j),r=0,s=q.length;s>r;r++)p=q[r],h[e(p)]=1}c.cCreated()},unmountVframe:function(a,b){var c=this;a=a||c.id;var d=r.get(a);if(d){var e=d.fcc;d.unmountView(),r.remove(a,e);var f=r.get(d.pId);f&&w(f.cM,a)&&(delete f.cM[a],f.cC--,b||f.cCreated())}},unmountZoneVframes:function(a,b){var c,d,e=this,f=e.cM;for(d in f)(!a||C(d,a))&&e.unmountVframe(d,c=1);return b||e.cCreated(),c},cCreated:function(a){var b=this;if(b.cC==b.rC){var c=b.view;c&&!b.fcc&&(b.fcc=1,b.fca=0,c.fire(z,a),b.fire(z,a)),r.vfCreated();var d=b.id,e=r.get(b.pId);e&&!w(e.rM,d)&&(e.rM[d]=e.cM[d],e.rC++,e.cCreated(a))}},cAlter:function(a){var b=this;a||(a={});var c=b.fcc;if(b.fcc=0,!b.fca&&c){var d=b.view,e=b.id;d&&(b.fca=1,d.fire(y,a),b.fire(y,a));var f=r.get(b.pId);f&&w(f.rM,e)&&(f.rC--,delete f.rM[e],f.cAlter(a))}},locChged:function(){var a=this,b=a.view;if(a.viewInited&&b&&b.sign>0){var c=b.olChg(q),e={location:p,changed:q,prevent:function(){this.cs=t},to:function(a){a=a||t,d._s(a)&&(a=a.split(",")),this.cs=a}};c&&s(b.locationChange,e,b);for(var f,g=e.cs||d.keys(a.cM),h=0,i=g.length;i>h;h++)f=r.get(g[h]),f&&f.locChged()}}}),D},{requires:["magix/magix","magix/event","magix/view"]}),d.add("magix/view",function(a,b,c,d,e){var f=b.safeExec,g=b.has,h=",",i=[],j=b.noop,k=b.mix,l="~",m=function(a){return function(){var b=this,c=b.notifyUpdate();c>0&&a.apply(b,arguments)}},n=b.cache(40),o="<",p=">",q=/\smx-(?!view|defer|owner|vframe)[a-z]+\s*=\s*"/g,r=String.fromCharCode(26),s={prevent:function(a){a=a||this.srcEvent,a.preventDefault()},stop:function(a){a=a||this.srcEvent,a.stopPropagation()},halt:function(a){this.prevent(a),this.stop(a)}},t=/(\w+)(?:<(\w+)>)?(?:\(?{([\s\S]*)}\)?)?/,u=/(\w+):([^,]+)/g,v=/([$\w]+)<([\w,]+)>/,w=function(a){var b=this;k(b,a),b.$ol={ks:[]},b.sign=1,f(w.ms,[a],b)},x=w.prototype;w.ms=[],w.prepare=function(a){if(!a[l]){a[l]=1;var b,c,d,e,f,g=a.prototype,i={};for(var k in g)if(b=g[k],c=k.match(v))for(d=c[1],e=c[2],e=e.split(h),f=e.length-1;f>-1;f--)c=e[f],i[c]=1,g[d+o+c+p]=b;else"render"==k&&b!=j&&(g[k]=m(b));e&&(g.$evts=i)}},w.mixin=function(a,b){b&&w.ms.push(b),k(x,a)},k(k(x,c),{render:j,locationChange:j,init:j,hasTmpl:!0,load:function(){var a=this,b=a.hasTmpl,c=arguments,d=function(d){b&&(a.template=a.wrapMxEvent(d)),a.dEvts(),a.fire("interact",{tmpl:b},1),f(a.init,c,a),a.fire("inited",0,1),a.owner.viewInited=1,f(a.render,i,a);var e=!b&&!a.rendered;e&&(a.rendered=1,a.fire("primed",0,1))};b?a.fetchTmpl(a.path,a.wrapAsync(d)):d()},beginUpdate:function(){var a=this;a.sign>0&&a.rendered&&a.fire("prerender")},endUpdate:function(){var a=this;a.sign>0&&(a.rendered||(a.fire("primed",0,1),a.rendered=1),a.fire("rendered"))},notifyUpdate:function(){var a=this;return a.sign>0&&(a.sign++,a.fire("rendercall")),a.sign},wrapMxEvent:function(a){return(a+"").replace(q,"$&"+this.id+r)},wrapAsync:function(a){var b=this,c=b.sign;return function(){c>0&&c==b.sign&&a&&a.apply(this,arguments)}},setViewHTML:function(a){var b,c=this;c.beginUpdate(),c.sign>0&&(b=c.$(c.id),b&&(b.innerHTML=a)),c.endUpdate()},observeLocation:function(a){var c,d=this;c=d.$ol,c.f=1;var e=c.ks;b._o(a)&&(c.pn=a.pathname,a=a.keys),a&&(c.ks=e.concat((a+"").split(h)))},olChg:function(a){var b=this,c=b.$ol,d=1;return c.f&&(d=0,c.pn&&(d=a.pathname),d||(d=a.isParam(c.ks))),d},oust:function(){var a=this;a.sign>0&&(a.sign=0,a.fire("destroy",0,1,1),a.dEvts(1)),a.sign--},pEvt:function(a){var b=this;if(b.sign>0){var c=a.info,d=a.se,e=n.get(c);e||(e=c.match(t),e={n:e[1],f:e[2],i:e[3],p:{}},e.i&&e.i.replace(u,function(a,b,c){e.p[b]=c}),n.set(c,e));var g=e.n+o+a.st+p,h=b[g];if(h){var i=s[e.f];i&&i.call(s,d),f(h,{currentId:a.cId,targetId:a.tId,type:a.st,srcEvent:d,halt:s.halt,prevent:s.prevent,stop:s.stop,params:e.p},b)}}},dEvts:function(a){var b=this,c=b.$evts,e=b.vom;for(var f in c)d.act(f,a,e)}});var y="?t="+a.now(),z=a.Env.mods,A={},B={};return w.prototype.fetchTmpl=function(a,b){var c=this,d="template"in c;if(d)b(c.template);else if(g(A,a))b(A[a]);else{var h,i=z[a];i&&(h=i.uri||i.fullpath,h=h.slice(0,h.indexOf(a)+a.length));var j=h+".html",k=B[j],l=function(c){b(A[a]=c)};k?k.push(l):(k=B[j]=[l],e({url:j+y,complete:function(a,b){f(k,a||b),delete B[j]}}))}},w.extend=function(b,c,d){var e=this,g=function(){g.superclass.constructor.apply(this,arguments),c&&f(c,arguments,this)};return g.extend=e.extend,a.extend(g,e,b,d)},w},{requires:["magix/magix","magix/event","magix/body","ajax"]}),d.add("magix/vom",function(a,b,c,d){var e=c.has,f=c.mix,g=0,h=0,i=0,j=0,k={},l={},m={},n=c.mix({all:function(){return k},add:function(a,b){e(k,a)||(g++,k[a]=b,n.fire("add",{vframe:b}))},get:function(a){return k[a]},remove:function(a,b){var c=k[a];c&&(g--,b&&h--,delete k[a],n.fire("remove",{vframe:c}))},vfCreated:function(){if(!j){h++;var a=h/g;a>i&&n.fire("progress",{percent:i=a},j=1==a)}},locChged:function(a){var c,d=a.loc;if(d?c=1:d=a.location,f(l,d),!c){f(m,a.changed);var e=b.root(n,l,m);m.view?e.mountView(d.view):e.locChged()}}},d);return n},{requires:["magix/vframe","magix/magix","magix/event"]}),d.add("mxext/mmanager",function(b,c,d){var e=c.has,f=c.safeExec,g=c._a,h=c.mix,i="mr",j=String.fromCharCode(26),k=12e5,l=function(a,b,c){b=[];for(c in a)b.push(c,i,a[c]);return b},m=function(a,b,c){for(var d,e=[b.name],f={},g=a.length-1;g>-1;g--)d=a[g],f[d]?a.splice(g,1):e.push(f[d]=l(b[d]),l(c[d]));return e.join(j)},n=function(a){var b=a.cache;if(b){var c=0|a.cacheTime;b=c?c:b===!0?k:0|b}return b},o=Date.now||function(){return+new Date},p=o(),q=function(a){throw Error(a)},r=function(a,b){var d=this;d.$mClass=a,d.$mCache=c.cache(),d.$mCacheKeys={},d.$mMetas={},b=b?g(b)?b:[b]:[],d.$sKeys=["postParams","urlParams"].concat(b),d.id="mm"+p--,f(r.ms,arguments,d)},s=[].slice,t=function(a,b,c,d){return function(){return a.apply(b,[c,d].concat(s.call(arguments)))}},u=function(a,b){var c=b.b,d=b.a,e=d[c];if(e){var g=e.q;delete d[c],f(g,a,e.e)}},v=function(b,c,d){var e,g=this,h=c.a,i=c.c,j=c.d,k=c.g,l=c.i,m=c.j,n=c.k,p=c.l,q=c.m,r=c.n,s=c.o;c.b++,delete i[g.id];var t=g.$mm,u=t.key,v=t.meta;if(j[b]=g,d)c.e=1,e=1,c.f=d,k.msg=d,k[b]=d,m.fire("fail",{model:g,meta:v,msg:d});else{if(!u||u&&!l.has(u)){u&&l.set(u,g),t.done=o();var w=t.after;w&&f(w,[g,v]),m.fire("done",{model:g,meta:v})}t.used>0&&(g.fromCache=1),t.used++}if(!h.$oust){if(n==y.ONE){var x=p?q[b]:q;x&&(r[b]=f(x,[e?k:a,g,k],h))}else if(n==y.ORDER){s[b]={m:g,e:e,s:d};for(var z,A,B=s.i||0;z=s[B];B++)A=p?q[B]:q,z.e&&(k.msg=z.s,k[B]=z.s),r[B]=f(A,[z.e?k:a,z.m,k].concat(r),h);s.i=B}c.b==c.h&&(c.e||(k=a),n==y.ALL?(j.unshift(k),r[0]=k,r[1]=f(q,j,h)):r.unshift(k),h.$ntId=setTimeout(function(){h.doNext(r)},30))}},w=function(a){return function(){var b=new z(this),c=arguments,d=c[c.length-1];return d&&d.manage&&(d.manage(b),c=s.call(c,0,-1)),b[a].apply(b,c)}},x=function(a,b){return function(c,d){var e=s.call(arguments,1);return this.send(c,e.length>1?e:d,a,b)}};h(r,{create:function(a,b){return new r(a,b)},mixin:function(a,b){b&&r.ms.push(b),h(r.prototype,a)},ms:[]});var y={ALL:1,ONE:2,ORDER:4},z=function(a){var b=this;b.$host=a,b.$reqs={},b.id=i+p--,b.$queue=[]};return h(z.prototype,{send:function(a,b,c,d){var f=this;if(f.$busy)return f.next(function(){this.send(a,b,c,d)}),f;f.$busy=1;var h=f.$host,i=h.$mCache,j=h.$mCacheKeys,k=f.$reqs;g(a)||(a=[a]);var l=a.length,m=[],n=g(b);n&&(m=new Array(b.length));for(var o,p={a:f,b:0,c:f.$reqs,d:new Array(l),g:{},h:l,i:i,j:h,k:c,l:n,m:b,n:m,o:[]},r=0;r<a.length;r++)if(o=a[r]){var s=h.getModel(o,d),w=s.cKey,x=s.entity,y=t(v,x,r,p);y.id=f.id,w&&e(j,w)?j[w].q.push(y):s.update?(k[x.id]=x,w&&(j[w]={q:[y],e:x},y=u),x.request(y,{a:j,b:w})):y()}else q("empty model");return f},fetchAll:function(a,b){return this.send(a,b,y.ALL)},saveAll:function(a,b){return this.send(a,b,y.ALL,1)},fetchOrder:x(y.ORDER),saveOrder:x(y.ORDER,1),saveOne:x(y.ONE,1),fetchOne:x(y.ONE),stop:function(){var a=this;clearTimeout(a.$ntId);var b=a.$host,c=a.$reqs,d=b.$mCacheKeys;for(var g in c){var h=c[g],i=h.$mm.key;if(i&&e(d,i)){for(var j,k=d[i],l=k.q,m=[],n=[],o=0;o<l.length;o++)j=l[o],j.id!=a.id?m.push(j):n.push(j);m.length?(f(n,"abort",k.e),k.q=m):h.abort()}else h.abort()}a.$reqs={},a.$queue=[],a.$busy=0},next:function(a){var b=this;if(b.$queue.push(a),!b.$busy){var c=b.$latest;b.doNext(c)}return b},doNext:function(a){var b=this;b.$busy=0;var c=b.$queue;if(c){var d=c.shift();d&&f(d,a,b)}b.$latest=a},destroy:function(){var a=this;a.$oust=1,a.stop()}}),h(h(r.prototype,d),{registerModels:function(a){var b=this,c=b.$mMetas;g(a)||(a=[a]);for(var d,e,f=0;f<a.length;f++)d=a[f],d&&(e=d.name,e?c[e]&&q("already exist:"+e):q("miss name"),d.cache=n(d),c[e]=d)},registerMethods:function(a){h(this,a)},createModel:function(a){var b,c=this,d=c.getModelMeta(a),e=n(a)||d.cache,g=new c.$mClass;g.set(d),g.$mm=b={used:0};var h=a.before||d.before;h&&f(h,[g,d]);var i=a.after||d.after;return b.after=i,e&&(b.key=m(c.$sKeys,d,a)),b.meta=d,a.name&&g.set(a),g.setUrlParams(d.urlParams),g.setPostParams(d.postParams),g.setUrlParams(a.urlParams),g.setPostParams(a.postParams),c.fire("inited",{model:g,meta:d}),g},getModelMeta:function(a){var b=this,c=b.$mMetas,d=a.name||a,e=c[d];return e||q("Unfound:"+d),e},getModel:function(a,b){var c,d,e=this;return b||(c=e.getCachedModel(a)),c||(d=1,c=e.createModel(a)),{entity:c,cKey:c.$mm.key,update:d}},saveAll:w("saveAll"),fetchAll:w("fetchAll"),saveOrder:w("saveOrder"),fetchOrder:w("fetchOrder"),saveOne:w("saveOne"),fetchOne:w("fetchOne"),createMRequest:function(a){var b=new z(this);return a&&a.manage&&a.manage(b),b},clearCacheByKey:function(a){var b=this,c=b.$mCache;c.del(a)},clearCacheByName:function(a){for(var b=this,c=b.$mCache,d=c.list(),e=0;e<d.length;e++){var f=d[e],g=f.v,h=g&&g.$mm;if(h){var i=h.meta.name;i==a&&c.del(h.key)}}},getCachedModel:function(b){var c,d=this,e=d.$mCache,f=a,g=d.getModelMeta(b),h=n(b)||g.cache;if(h&&(c=m(d.$sKeys,g,b)),c){var i=d.$mCacheKeys,j=i[c];j?f=j.e:(f=e.get(c),f&&h>0&&o()-f.$mm.done>h&&(d.clearCacheByKey(c),f=0))}return f}}),r},{requires:["magix/magix","magix/event"]}),d.add("mxext/model",function(a,b){var c=function(c,d){var e=function(){e.superclass.constructor.apply(this,arguments),d&&b.safeExec(d,[],this)};return b.mix(e,this,{prototype:!0}),a.extend(e,this,c)},d=+new Date,e=encodeURIComponent,f=b.has,g=b._o,h=b.toString,i=function(a){this.set(a),this.id="m"+d--};return b.mix(i,{GET:"GET",POST:"POST",extend:c}),b.mix(i.prototype,{sync:b.noop,getPostParams:function(){return this.getParams(i.POST)},getUrlParams:function(){return this.getParams(i.GET)},getParams:function(a){var c=this;a||(a=i.GET);var d,f="$"+a,g=c[f],h=[];for(var j in g){d=g[j],b._a(d)||(d=[d]);for(var k=0;k<d.length;k++)h.push(j+"="+e(d[k]))}return h.join("&")},setUrlParamsIf:function(a,b){this.setParams(a,b,i.GET,!0)},setPostParamsIf:function(a,b){var c=this;c.setParams(a,b,i.POST,!0)},setParams:function(a,b,c,d){var e=this,h="$"+c;e[h]||(e[h]={});var i=e[h];if(!g(a)&&a){var j={};j[a]=b,a=j}for(var k in a)d&&f(i,k)||(i[k]=a[k])},setPostParams:function(a,b){var c=this;c.setParams(a,b,i.POST)},setUrlParams:function(a,b){this.setParams(a,b,i.GET)},get:function(a,b,c){var d=this,e=arguments.length,f=2==e,g=d.$attrs;if(e){for(var i=(a+"").split(".");g&&i[0];)g=g[i.shift()];i[0]&&(g=c)}return f&&h.call(b)!=h.call(g)&&(g=b),g},set:function(a,b){var c=this;if(c.$attrs||(c.$attrs={}),g(a))for(var d in a)c.$attrs[d]=a[d];else a&&(c.$attrs[a]=b)},request:function(a,b){var c=this;c.$abt=0;var d=function(d,e){c.$abt||(g(e)||(e={data:e}),c.set(e),a(d,b))};c.$trans=c.sync(c.$temp=d)},abort:function(){var a=this,b=a.$trans,c=a.$temp;c&&c("abort"),a.$abt=1,b&&b.abort&&b.abort(),a.$trans=0},isAborted:function(){return this.$abt}}),i},{requires:["magix/magix"]}),d.add("mxext/view",function(b,c,d,e){var f=window,g=0,h=c.safeExec,i=c.has,j=[],k="rendercall",l="destroy",m=function(a){f.clearTimeout(a),f.clearInterval(a)},n=function(a){var b=a&&a[l];b&&h(b,j,a)},o=function(a){var b=this,c=b.$res,d=a.type==k,e=a.type!=l;for(var f in c){var g=c[f];(!d||g.mr)&&b.destroyManaged(f,e)}},p=d.extend({navigate:e.navigate,manage:function(a,b,d){var e=this,f=arguments,h=1,i=e.$res;1==f.length?(b=a,a="res_"+g++,h=0):e.destroyManaged(a);var j;j=c._n(b)?m:n;var k={hk:h,res:b,ol:d,mr:b&&b.$reqs,oust:j};return i[a]=k,b},getManaged:function(b,c){var d=this,e=d.$res,f=a;if(i(e,b)){var g=e[b];f=g.res,c&&delete e[b]}return f},removeManaged:function(a){return this.getManaged(a,1)},destroyManaged:function(a,b){var c,d=this,e=d.$res,f=e[a];return!f||b&&f.ol||(c=f.res,f.oust(c),f.hk&&b||delete e[a]),c}},function(){var a=this;a.$res={},a.on("interact",function(){a.on(k,o),a.on("prerender",o),a.on(l,o)}),h(p.ms,arguments,a)},{ms:[],mixin:function(a,b){b&&p.ms.push(b),c.mix(p.prototype,a)}});return p},{requires:["magix/magix","magix/view","magix/router"]}),c.createElement("vframe")}(null,this,document,KISSY);