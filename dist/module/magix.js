/*!3.8.3 MIT kooboy_li@163.com*/let e,t,r=e=>t=>Object.prototype.toString.call(t).slice(8,-1)==e,i=r("Object"),n=r("Array"),o=0,a="",l=[],f=",",s=window,d=document,$=s.setTimeout,h="changed",c="change",u="pageunload",p="value",m=function(){},g=JSON.stringify,v="\x1e",b="object",w="prototype",y="params",x="path",k="mx-view",V=/[#?].*$/,I=/([^=&?\/#]+)=?([^&#?]*)/g,P=/(?!^)=|&/,S=e=>(e||"mx_")+o++,E=S(),T={rootId:S(),defaultView:E,error(e){throw e}},j=e=>typeof e==b?e:d.getElementById(e),O=e=>!e||typeof e!=b,A=(e,t,r)=>{if(e=j(e),t=j(t),e&&t&&!(r=e==t))try{r=16==(16&t.compareDocumentPosition(e))}catch(e){}return r},{assign:C,keys:H,hasOwnProperty:L}=Object,M=document.head,U=document.createElement("div"),q=(e,t)=>{t&&!q[e]&&(q[e]=1,U.innerHTML=`<style>${t}`,M.appendChild(U.firstChild))},D=e=>e.id||(e.$a=1,e.id=S()),Z=(e,t,r,i,o)=>{t=t||l,n(e)||(e=[e]),n(t)||(t=[t]);for(o of e)try{i=o&&o.apply(r,t)}catch(e){T.error(e)}return i},N=(e,t)=>e&&L.call(e,t),_=(e,t,r)=>{let i,n;for(i in t)n=t[i],r[i]=(n+a)[0]==v?e[n]:n},z=(e,t)=>t.f-e.f||t.t-e.t,B=function(e,t,r,i){(i=this).c=[],i.b=t||5,i.x=i.b+(e||20),i.r=r};C(B[w],{get(e){let t=this.c[v+e];return t&&(t.f++,t.t=o++,t=t.v),t},each(e,t,r,i,n){i=(r=this).c;for(n of i)e(n.v,t,r)},set(e,t){let r=this,i=r.c,n=v+e,a=i[n],l=r.b;if(!a){if(i.length>=r.x)for(i.sort(z);l--;)(a=i.pop()).f>0&&r.del(a.o);a={o:e},i.push(a),i[n]=a}a.v=t,a.f=1,a.t=o++},del(e){e=v+e;let t=this.c,r=t[e],i=this.r;r&&(r.f=-1,r.v=a,delete t[e],i&&Z(i,r.o))},has(e){return N(this.c,v+e)}});let R=(e,r)=>{if(e)if(E==e)t||(t=Lt.extend()),r(t);else{let t=[],i=0;i(e)||(e=[e]);let n=e=>n=>{t[e]=n.default,++i==t.length&&r(...t)},o=T.paths;for(let t,r,i,a=e.length;a--;)(r=(t=e[a]).indexOf("/"))>-1&&(i=t.slice(0,r),t=t.slice(r+1),t=(o[i]||`unset/${i}/path/`)+t),t.endsWith(".js")||(t+=".js"),import(t).then(n(a))}else r()},W=function(){},F=(e,t,r,i,n)=>(W[w]=t[w],n=new W,C(n,r),C(e,i),n.constructor=e,e[w]=n,e),J=(e,t,r)=>{let i=d.createEvent("Events");i.initEvent(t,!0,!0);for(let e in r)i[e]=r[e];e.dispatchEvent(i)},Q=(e,t)=>{if(!t||!e||1!==e.nodeType)return 0;return(e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector).call(e,t)},G=e=>e._mx||(e._mx=S("e")),K={},X=()=>!0,Y=()=>!1,ee={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},te=(e,t,r,i)=>{let n=G(e),o=K[n]||(K[n]=[]),a={$a:r&&r.i,$b:i,$d:t,$e(t){(t=(e=>{if(!e.isDefaultPrevented){for(let t in ee){let r=ee[t],i=e[t];e[t]=((...t)=>(e[r]=X,i&&i.apply(e,t))),e[r]=Y}(void 0!==e.defaultPrevented?e.defaultPrevented:"returnValue"in e?!1===e.returnValue:e.getPreventDefault&&e.getPreventDefault())&&(e.isDefaultPrevented=X)}return e})(t)).isImmediatePropagationStopped()||i.call(e,t,r)}};o.push(a),e.addEventListener(t,a.$e,!1)},re=(e,t)=>{e.eventTarget=t.e,Z(t.f,e,t.v)},ie=(e,t,r,i,n)=>{i?((e,t,r,i)=>{let n=G(e),o=K[n];if(o){let n;for(let e,a=o.length;a--;)if((e=o[a]).$d==t&&e.$b===i){let t=e.$a;if(!r||r&&r.i==t){n=e,o.splice(a,1);break}}n&&e.removeEventListener(t,n.$e,!1)}})(e,t,n,r):te(e,t,n,r)};let ne,oe=new B,ae=0,le=(e,t,r)=>{try{r=decodeURIComponent(r)}catch(e){}ne[t]=r},fe=e=>{let t,r=oe.get(e);return r||(ne={},e==(t=e.replace(V,a))&&P.test(t)&&(t=a),e.replace(t,a).replace(I,le),oe.set(e,r={a:t,b:ne})),{path:r.a,params:{...r.b}}},se=(e,t,r)=>{let i,n,o,l=[];for(n in t)i=t[n]+a,(!r||i||N(r,n))&&(i=encodeURIComponent(i),l.push(o=n+"="+i));return o&&(e+=(e&&(~e.indexOf("?")?"&":"?"))+l.join("&")),e},de=(e,t)=>{let r,i={};if(e)for(r of e)i[t&&r?r[t]:r]=t?r:1+(0|i[r]);return i},$e={config:(e,t)=>(t=T,e&&(t=i(e)?C(t,e):t[e]),t),boot(e){C(T,e),R(T.ini,t=>{C(T,t,e),R(T.exts,()=>{_e.on(h,Ge),be.on(h,Ge),ae=1,qe()})})},toMap:de,toTry:Z,toUrl:se,parseUrl:fe,mix:C,has:N,keys:H,inside:A,node:j,applyStyle:q,guid:S,use:R,Cache:B,nodeId:D},he={fire(e,t,r,i){let n,o,l,f,s=this,d=s[v+e];if(t||(t={}),t.type||(t.type=e),d)for(o=(n=d.length)-1;n--;)(f=d[l=i?n:o-n]).f?(f.x=1,Z(f.f,t,s),f.x=a):f.x||(d.splice(l,1),o--);(d=s[`on${e}`])&&Z(d,t,s),r&&s.off(e)},on(e,t){let r=v+e;(this[r]||(this[r]=[])).push({f:t})},off(e,t){let r,i=v+e,n=this,o=n[i];if(t){if(o)for(r of o)if(r.f==t){r.f=a;break}}else delete n[i],delete n[`on${e}`]}};$e.Event=he;let ce={},ue={},pe={},me=0,ge=e=>{e=(e+a).split(",");for(let t of e)N(ue,t)?ue[t]++:ue[t]=1;return e},ve=e=>{let t,r;for(t of e)N(ue,t)&&((r=--ue[t])||(delete ue[t],delete ce[t]))};let be={get(e){let t=e?ce[e]:ce;return t},set(e){me=((e,t,r)=>{let i,n,o,a=0;for(o in e)i=e[o],n=t[o],O(i)&&n===i||(r[o]=1,a=1),t[o]=i;return a})(e,ce,pe)||me},digest(e){e&&be.set(e),me&&(me=0,this.fire(h,{keys:pe}),pe={})},diff:()=>pe,clean:e=>({ctor(){e=ge(e),this.on("destroy",()=>ve(e))}}),...he};$e.State=be;let we,ye,xe,ke,Ve,Ie,Pe,Se,Ee="view",Te=new B,je=new B,Oe=s.location,Ae=0,Ce={query:{},params:{},href:a},He=/(?:^.*\/\/[^\/]+|#.*$)/gi,Le=/^[^#]*#?!?/,Me=function(e){return this[y][e]||a},Ue=(e,t)=>{e=`#!${e}`,t?Oe.replace(e):Oe.hash=e},qe=()=>{let e,t,r=Ze().srcHash;ie(s,"hashchange",(i,n,o)=>{t||(n=Ze(),(e=n.srcHash)!=r&&(o=(()=>{i.p=1,r=e,t=a,Ue(e),Ne()}),i={reject(){i.p=1,t=a,Ue(r)},resolve:o,prevent(){t=1}},_e.fire(c,i),t||i.p||o()))}),s.onbeforeunload=((e,t,r)=>{if(e=e||s.event,t={},_e.fire(u,t),r=t.msg)return e&&(e.returnValue=r),r}),Ne()},De=d.title,Ze=e=>{e=e||Oe.href;let t,r,n,o,l,f=Te.get(e);return f||(t=e.replace(He,a),r=e.replace(Le,a),n=fe(t),o=fe(r),l={...n[y],...o[y]},f={get:Me,href:e,srcQuery:t,srcHash:r,query:n,hash:o,params:l},ae&&(((e,t)=>{if(ye||(ye=T.routes||{},xe=T.unmatchView,ke=T.defaultView,Ve=T.defaultPath||"/",Ie=T.rewrite),!e[Ee]){let r=e.hash[x]||Ve;Ie&&(r=Ie(r,e[y],ye)),t=ye[r]||xe||ke,e[x]=r,e[Ee]=t,i(t)&&C(e,t)}})(f),Te.set(e,f))),f},Ne=()=>{let e=Ze(),t=((e,t)=>{let r=e.href,i=t.href,n=r+v+i,o=je.get(n);if(!o){let i,a;o={params:a={},force:!r};let l,f=e[y],s=t[y],d=H(f).concat(H(s)),$=e=>{let t=f[e],r=s[e];t!=r&&(a[e]={from:t,to:r},i=1)};for(l of d)$(l);f=e,s=t,a=o,$(x),$(Ee),je.set(n,o={a:i,b:o})}return o})(Ce,Ce=e);return!Ae&&t.a&&((we=t.b)[x]&&(d.title=e.title||De),_e.fire(h,we)),Ae=0,we},_e={parse:Ze,diff:Ne,to(e,t,r,n){!t&&i(e)&&(t=e,e=a);let o=fe(e),l=o[y],f=o[x],s=Ce[x],d=Ce[y],$=Ce.query[y];if(C(l,t),f)for(s in $)N(l,s)||(l[s]=a);else d&&(f=s,l={...d,...l});var h,c,u,p;c=Ce,u=r,p=n,(h=se(h=f,l,$))!=c.srcHash&&(Ae=p,Ue(h,u))},...he};$e.Router=_e;let ze=e=>{if(!e.$a&&!e.$b&&e.$cc==e.$rc){e.$cr||(e.$cr=1,e.$ca=0,e.fire("created"));let t,{id:r,pId:i}=e;(t=Re[i])&&!N(t.$d,r)&&(t.$d[r]=1,t.$rc++,ze(t))}},Be=(e,t)=>{if(!e.$ca&&e.$cr){e.$cr=0,e.$ca=1,e.fire("alter",t);let r,{id:i,pId:n}=e;(r=Re[n])&&N(r.$d,i)&&(r.$rc--,delete r.$d[i],Be(r,t))}},Re={},We=(e,t,r)=>{for(t=e.$e;t.length;)(r=t.shift()).r||e.invoke(r.n,r.a),delete t[r.k]},Fe=[],Je=0,Qe=(e,t,r)=>{if(e&&e.$f!=Je&&(r=e.$v)&&r.$a>1){(t?((e,t,r)=>{let i,n=e.$os;if(n)for(i of n)if(r=N(t,i))break;return r})(r,t):Ht(r))&&r.$b();let i,n=e.children();for(i of n)Qe(Re[i],t)}},Ge=t=>{let r,i=(t=>(Pe||(e=d.body,t=T.rootId,j(t)||(e.id=t),Pe=new Ke(t)),Pe))();(r=t[Ee])?i.mountView(r.to):(Je=o++,Qe(i,t.keys))},Ke=function(e,t,r){var i,n;(r=this).id=e,r.$c={},r.$cc=0,r.$rc=0,r.$g=1,r.$d={},r.$e=[],r.pId=t,n=r,N(Re,i=e)||(Re[i]=n,Ke.fire("add",{vframe:n}),(i=j(i))&&(i.vframe=n))};C(Ke,{all:()=>Re,get:e=>Re[e]},he),C(Ke[w],he,{mountView(e,t){let r,i,n,o,a,l,f=this,{id:s,pId:d,$g:$}=f,h=j(s);!f.$h&&h&&(f.$h=1,f.$i=h.innerHTML),f.unmountView(),f.$a=0,h&&e&&(f[x]=e,r=fe(e),n=r[x],i=++$,o=r[y],l=(l=(l=(l=Re[d])&&l.$v)&&l.$d)&&l.$a,e.indexOf(v)>0&&_(l,o,o),f.$n=r[x],C(o,t),R(n,e=>{if(i==f.$g){if(!e)return T.error(Error(`id:${s} cannot load:${n}`));a=Ct(e),n=new e(s,f,o,a),f.$v=n,f.$f=Je,jt(n),Z(n.init,o,n),n.$b(),n.$e||(f.$h=0,n.$f||n.endUpdate())}}))},unmountView(){let e,t,r=this,{$v:i,id:n}=r;r.$e=[],i&&(Se||(t=1,Se={id:n}),r.$a=1,r.unmountZone(0,1),Be(r,Se),r.$v=0,i.$a>0&&(i.$a=0,i.fire("destroy",0,1,1),St(i,1),jt(i,1),i.owner=0),i.$a--,(e=j(n))&&r.$h&&(e.innerHTML=r.$i),t&&(Se=0)),r.$g++},mountVframe(e,t,r){let i,n=this,o=n.id,a=n.$c;return Be(n,{id:e}),(i=Re[e])||(N(a,e)||(n.$o=0,n.$cc++),a[e]=e,(i=Fe.pop())?Ke.call(i,e,o):i=new Ke(e,o)),i.mountView(t,r),i},mountZone(e,t){let r,i,n=this,o=[],a=(e=>d.querySelectorAll(e))(`#${e=e||n.id} [${k}]`);n.$b=1;for(r of a)i=D(r),r.$b||(r.$b=1,o.push([i,r.getAttribute(k)]));for([i,r]of o)o[i]?T.error(Error(`vf.id duplicate:${i} at ${n[x]}`)):n.mountVframe(o[i]=i,r);n.$b=0,t||ze(n)},unmountVframe(e,t){let r;if(e=e?this.$c[e]:this.id,r=Re[e]){let{$cr:a,pId:l}=r;r.unmountView(),n=a,(o=Re[i=e])&&(delete Re[i],Ke.fire("remove",{vframe:o,fcc:n}),(i=j(i))&&(i.$b=0),i&&(i.vframe=0),i&&(i.$d=0)),r.id=r.pId=r.$c=r.$d=0,r.$h=0,r.off("alter"),r.off("created"),Fe.push(r),(r=Re[l])&&N(r.$c,e)&&(delete r.$c[e],r.$o=0,r.$cc--,t||ze(r))}var i,n,o},unmountZone(e,t){let r,i=this;for(r in i.$c)(!e||r!=e&&A(r,e))&&i.unmountVframe(r,1);t||ze(i)},parent(e,t){for(t=this,e=e>>>0||1;t&&e--;)t=Re[t.pId];return t},children(e){return(e=this).$o||(e.$o=H(e.$c))},invoke(e,t){let r,i,n,o,a,l=this.$e;return(i=this.$v)&&i.$f?r=(n=i[e])&&Z(n,t,i):((o=l[a=v+e])&&(o.r=t===o.a),o={n:e,a:t,k:a},l.push(o),l[a]=o),r}}),$e.Vframe=Ke;let Xe=new B(30,10),Ye=/(?:([\w\-]+)\x1e)?([^(]+)\(([\s\S]*)?\)/,et={},tt={},rt=(t,r)=>{let i,n,o,a,f,s,d,$=[],h=t,c=t.getAttribute(`mx-${r}`),u=[],p=0;if(c&&((f=Xe.get(c))||((f={v:(f=c.match(Ye)||l)[1],n:f[2],i:f[3]}).p=f.i&&Z(Function(`return ${f.i}`),l,t),Xe.set(c,f)),f={...f,r:c},$.push(f)),f&&!f.v||tt[r]){if(!(d=t.$a))for(u.push(h);h!=e&&(h=h.parentNode);){if(Re[n=h.id]||(n=h.$v)){d=n;break}u.push(h)}if(d){for(c of u)c.$a=d;h=t.id,Re[h]&&(p=d=h);do{if((i=Re[d])&&(s=i.$v)){a=(o=s.$so)[r];for(n in a)o={r:n,v:d,n:n},n?Q(t,n)&&$.push(o):p&&$.unshift(o);if(s.$e&&!p){f&&!f.v&&(f.v=d);break}p=0}}while(i&&(d=i.pId))}}return $},it=t=>{let r,i,n,o,a,l,f,s,{target:d,type:$}=t,h=[];for(;d!=e;){if((r=rt(d,$)).length){h=[];for(let{v:e,r:i,n:h,p:c,i:u}of r){if(f!=e){if(f&&t.isPropagationStopped())break;f=e}if(o=(n=Re[e])&&n.$v){if((l=o[a=h+v+$])&&(t.eventTarget=d,s=c||{},u&&u.indexOf(v)>0&&_(o.$d.$a,s,s={}),t[y]=s,Z(l,t,o),t.isImmediatePropagationStopped()))break;0}else t.stopPropagation();0}}if((i=d.$)&&i[$]||t.isPropagationStopped())break;h.push(d),d=d.parentNode||e}for(d of h)(i=d.$||(d.$={}))[$]=1},nt=(t,r,i)=>{let n=0|et[t],o=i?-1:1;n&&i!==n||ie(e,t,it,i),et[t]=n+o,r&&(tt[t]=(0|tt[t])+o)},ot={input:1,br:1,hr:1,img:1,embed:1,source:1,area:1,param:1,col:1,track:1,wbr:1},at={input:[p,"checked"],textarea:[p],option:["selected"]},lt="#text";let ft=/^<([a-z\d]+)((?:\s+[-A-Za-z\d_]+(?:="[^"]*")?)*)\s*(\/?)>/,st=/([-A-Za-z\d_]+)(?:="([^"]*)")?/g,dt=/^<\/[a-z\d+]+>/,$t={},ht=/&#?[^\W]+;?/g,ct=d.createElement("div"),ut=e=>(N($t,e)||(ct.innerHTML=e,$t[e]=ct.innerText),$t[e]),pt=e=>e.replace(ht,ut),mt=(e,t)=>{let r=D(t);e.$c[r]?e.unmountVframe(r,1):e.unmountZone(r,1)},gt=(e,t,r,i)=>{let n,o,l,f,s=t.d,d=e.attributes,$=t.h;for(f=d.length;f--;)o=d[f].name,N($,o)||("id"==o?i||r.d.push([e,a]):(r.c=1,e.removeAttribute(o)));for(n of t.e)o=n.f,l=pt(n.g),"id"==o?r.d.push([e,l]):e.getAttribute(o)!=l&&(r.c=1,e.setAttribute(o,l));let h=at[s];if(h)for(n of h)e[n]=N($,n)?n!=p||$[n]:n==p&&a},vt=(e,t,r,i,n)=>(n=e.d)==lt?d.createTextNode(e.b):(i=d.createElementNS("svg"==n?"http://www.w3.org/2000/svg":t.namespaceURI,n),gt(i,e,r),i.innerHTML=e.b,i),bt=(e,t,r,i,n)=>{let o,a,l,f,s,d,$,h,c,u,p={};for(o=(f=e.childNodes).length,a=(s=t.a).length,l=0;l<o;l++)c=(d=f[l]).id,d.$a&&(c=(u=Re[c])&&u.$n),c&&(c=p[c]||(p[c]=[])).push(d);for(l=0;l<a;l++)d=f[l],(c=p[($=s[l]).i])&&(c=c.shift())?(c!=d&&e.insertBefore(c,d),wt(c,e,$,r,i,n)):d?p[d.i]?(o++,r.c=1,e.insertBefore(vt($,e,r),d)):wt(d,e,$,r,i,n):(e.appendChild(vt($,e,r)),r.c=1);for(l=a;l<o;l++)h=e.lastChild,mt(i,h),e.removeChild(h),r.c=1},wt=(e,t,r,i,n,o)=>{let a=e.nodeName.toLowerCase();if(a==r.d)if(a==lt)e.nodeValue!=r.b&&(e.nodeValue=pt(r.b));else{let t,a,l,f,s,d,$,h,c,u=r.h[k],p=r.b,m=Re[e.id];u&&m&&(f=(d=m.$v).$g,$=fe(u),c=p!=m.$i,s=u.indexOf("?")>0||c),u&&m&&m.$n==$[x]?s&&(f?(h=$[y],u.indexOf(v)>-1&&_(o,h,h),m.$i=p,m[x]=u,$={inner:p,deep:!d.$e,html:c},gt(e,r,i,1),Z(f,[h,$],d)&&d.$b(),a=$.deep):(l=1,a=1,t=1)):(t=1,a=1,l=m),l&&m.unmountVframe(0,1),t&&gt(e,r,i,m&&u),a&&bt(e,r,i,n,o)}else mt(n,e),t.replaceChild(vt(r,t,i),e),i.c=1},yt=e=>{let t,r,i,n,o=e.$b,f=Re[o],s=e.$a,$=f&&f.$v,h={d:[]},c=j(o);if($&&$.$a>0&&(t=$.$e)){n=(e=>{let t,r,i,n,o,f,s,d,$,h,c,u=e.length,m=0,g={a:[],b:e},v=[g];for(;m<u;)t=1,"<"==(i=e.slice(m))[0]&&("/"==i[1]?(n=i.match(dt))&&(s=v.pop(),f=e.slice(s.c,m),"textarea"==s.d?(s.e.push({f:p,g:f}),s.h[p]=f,s.a=l):s.b=f,g=v[v.length-1],m+=n[0].length,t=0):(n=i.match(ft))&&(o=n[1],f=[],d={},c=a,n[2].replace(st,(e,t,r)=>{r=r||a,"id"==t?c=r:t==k&&r&&!c&&(c=fe(r)[x]),f.push({f:t,g:r}),d[t]=r}),m+=n[0].length,h=n[3]||N(ot,o),s={i:c,d:o,e:f,h:d,a:[],c:m},g.a.push(s),h?s.j=1:(v.push(s),g=s),t=0)),t&&(m+=($=(r=i.indexOf("<"))<0?i:i.substring(0,r)).length,s={d:lt,b:$},g.a.push(s));return g})(r=It(t(s),o)),bt(c,n,h,f,s);for(i of h.d)i[0].id=i[1];h.c&&($.endUpdate(o),J(d,"htmlchanged",{vId:o}))}$.fire("domready")},xt=function(e){this.$b=e,this.$a={vId:e,[v]:1}};C(xt[w],{get(e,t){return t=this.$a,e&&(t=t[e]),t},set(e){return C(this.$a,e),this},digest(e,t){return this.set(e),yt(this),this},snapshot(){return this.$d=g(this.$a),this},altered(){let e=this;if(e.$d)return e.$d!=g(e.$a)}});let kt=/^(\$?)([^<]*)<([^>]+)>$/,Vt=/\x1f/g,It=(e,t)=>(e+a).replace(Vt,t),Pt=(e,t,r)=>(e.$h?r=e:((r=function(e){Z(r.$h,e,this)}).$h=[e],r.$i=1),r.$h=r.$h.concat(t.$h||t),r),St=(e,t)=>{let r,i,n=e.$r;for(r in n)i=n[r],(t||i.x)&&Et(n,r,1)},Et=(e,t,r,i)=>{let n,o,a=e[t];return a&&a!=i&&((n=(o=a.e).destroy)&&r&&Z(n,l,o),delete e[t]),o},Tt=(e,t,r,i,n)=>{i=e[t],e[t]=e[r]=function(...e){(n=this).$a>0&&(n.$a++,n.fire("rendercall"),St(n),Z(i,e,n))}},jt=(e,t)=>{let r,{$eo:i,$so:n,$el:o,id:a}=e;for(r in i)nt(r,n[r],t);for(r of o)ie(r.e,r.n,re,t,{i:a,v:e,f:r.f,e:r.e})},Ot=[],At={win:s,doc:d},Ct=e=>{if(!e[v]){e[v]=[];let t,r,i,n,o,a,l,s,d,$=e[w],h={},c=[],u={},p={};if(r=$.mixins){for(o of r)for(l in o)t=o[l],i=p[l],"ctor"!=l?(kt.test(l)&&(i?t=Pt(i,t):t.$i=1),p[l]=t):e[v].push(t);for(l in p)N($,l)||($[l]=p[l])}for(l in $)if(t=$[l],r=l.match(kt)){[,a,i,n]=r,n=n.split(f);for(s of n){if(o=At[i],d=1,a){if(o){c.push({f:t,e:o,n:s});continue}d=2,(o=u[s])||(o=u[s]={}),o[i]=1}h[s]=h[s]|d,(o=$[s=i+v+s])?o.$i&&(t.$i?$[s]=Pt(o,t):N($,l)&&($[s]=t)):$[s]=t}}Tt($,"render","$b"),$.$eo=h,$.$el=c,$.$so=u,$.$e=$.tmpl,$.$g=$.assign}return e[v]},Ht=e=>{let t,r,i,n=e.$l;if(n.f&&(n.p&&(t=we[x]),!t&&n.k)){i=we[y];for(r of n.k)if(t=N(i,r))break}return t},Lt=function(e,t,r,i){(i=this).owner=t,i.id=e,i.$l={k:[]},i.$r={},i.$a=1,i.updater=i.$d=new xt(i.id),Z(Ot,r,i)},Mt=Lt[w];C(Lt,{merge(...e){let t,r;for(t of e)(r=t&&t.ctor)&&Ot.push(r),C(Mt,t)},extend(e,t){let r=this,i=(e=e||{}).ctor,n=[];i&&n.push(i);let o=function(e,t,i,o){r.call(this,e,t,i),Z(n.concat(o),i,this)};return o.extend=r.extend,F(o,r,e,t)}}),C(Mt,he,{init:m,wrapEvent(e){return It(e,this.id)},beginUpdate(e,t){(t=this).$a>0&&t.$f&&t.owner.unmountZone(e,1)},endUpdate(e,t,r,i,n){(r=this).$a>0&&(e=e||r.id,t?n=t:(n=r.$f,r.$f=1),(i=r.owner).mountZone(e,t),n||$(r.wrapAsync(We),0,i))},wrapAsync(e,t){let r=this,i=r.$a;return(...n)=>{if(i>0&&i==r.$a)return e.apply(t||r,n)}},observeLocation(e,t){let r;(r=this.$l).f=1,i(e)&&(t=e[x],e=e[y]),r.p=t,e&&(r.k=(e+a).split(f))},observeState(e){this.$os=(e+a).split(f)},capture(e,t,r,i){return i=this.$r,t?(Et(i,e,1,t),i[e]={e:t,x:r}):t=(i=i[e])&&i.e,t},release(e,t){return Et(this.$r,e,t)},leaveTip(e,t){let r=this,i=n=>{let o="a",a="b";n.type!=c&&(o="b",a="a"),i[o]?(n.prevent(),n.reject()):t()?(n.prevent(),i[a]=1,r.leaveConfirm(e,()=>{i[a]=0,n.resolve()},()=>{i[a]=0,n.reject()})):n.resolve()},n=r=>{t()&&(r.msg=e)};_e.on(c,i),_e.on(u,n),r.on("unload",i),r.on("destroy",()=>{_e.off(c,i),_e.off(u,n)})},render:m}),$e.View=Lt;let Ut=Date.now,qt=function(){this.id=S("b"),this.$={}};C(qt[w],{get(e,t,i){let o,l=t!=i,f=this.$;if(e){let t,r=n(e)?e.slice():(e+a).split(".");for(;(t=r.shift())&&f;)f=f[t];t&&(f=i)}return l&&(o=r(t))!=r(f)&&(f=t),f},set(e,t){i(e)||(e={[e]:t}),C(this.$,e)}});let Dt=function(e,t,r){(r=this[e])&&(delete this[e],Z(r,t,r.e))},Zt=(e,t,r,i,n,o)=>{let a=[],l=0,f=0;return function(s,d){let $,h=this;f++;let c=h.$b,u=c.k;a[s+1]=h;let p,m={bag:h,error:d};if(d?(l=d,t.fire("fail",m),$=1):o.has(u)||(u&&o.set(u,h),c.t=Ut(),(p=c.a)&&Z(p,h,h),(p=c.x)&&t.clear(p),t.fire("done",m),$=1),!r.$d){let t=f==i;t&&(r.$e=0,2==n&&(a[0]=l,Z(e,a,r))),1==n&&Z(e,[d||null,h,t,s],r)}$&&t.fire("end",m)}},Nt=(e,t,r,i,o)=>{if(e.$d)return e;if(e.$e)return e.enqueue(Nt.bind(e,e,t,r,i,o));e.$e=1,n(t)||(t=[t]);let a=e.constructor,l=0,f=a.$f,s=Zt(r,a,e,t.length,i,a.$c);for(let e of t)if(e){let t,r=a.get(e,o),i=r.e,n=i.$b.k,d=s.bind(i,l++);n&&f[n]?f[n].push(d):r.u?(n&&((t=[d]).e=i,f[n]=t,d=Dt.bind(f,n)),a.$s(i,d)):d()}return e},_t=function(){let e=this;e.id=S("s"),e.$g=[]};C(_t[w],{all(e,t){return Nt(this,e,t,2)},save(e,t){return Nt(this,e,t,2,1)},one(e,t){return Nt(this,e,t,1)},enqueue(e){let t=this;return t.$d||(t.$g.push(e),t.dequeue(t.$h)),t},dequeue(...e){let t,r=this;r.$e||r.$d||(r.$e=1,$(()=>{r.$e=0,r.$d||(t=r.$g.shift())&&Z(t,r.$h=e)},0))},destroy(e){(e=this).$d=1,e.$g=0}});let zt=(e,t)=>[g(t),g(e)].join(v),Bt=(e,t,r,i)=>{(i=e&&e.$b)&&t[i.n]&&r.del(i.k)},Rt={add(e){let t,r=this.$b;n(e)||(e=[e]);for(t of e)if(t){let{name:e,cache:i}=t;t.cache=0|i,r[e]=t}},create(e){let t=this.meta(e),r=0|e.cache||t.cache,n=new qt;n.set(t),n.$b={n:t.name,a:t.after,x:t.cleans,k:r&&zt(t,e)},i(e)&&n.set(e);let o=t.before;return o&&Z(o,n,n),this.fire("begin",{bag:n}),n},meta(e){return this.$b[e.name||e]||e},get(e,t){let r,i,n=this;return t||(r=n.cached(e)),r||(r=n.create(e),i=1),{e:r,u:i}},clear(e){this.$c.each(Bt,de((e+a).split(f)))},cached(e){let t,r,i=this,n=i.$c,o=i.meta(e),a=0|e.cache||o.cache;if(a&&(r=zt(o,e)),r){let e=i.$f[r];e?t=e.e:(t=n.get(r))&&Ut()-t.$b.t>a&&(n.del(r),t=0)}return t},...he};_t.extend=((e,t,r)=>{let i=function(){_t.call(this)};return i.$s=e,i.$c=new B(t,r),i.$f={},i.$b={},F(i,_t,null,Rt)}),$e.Service=_t,C(m[w],he),m.extend=function e(t,r){let i=this,n=t&&t.ctor,o=function(...e){i.apply(this,e),n&&n.apply(this,e)};return o.extend=e,F(o,i,t,r)},$e.Base=m,$e.trigger=J;export default $e