/*Magix3.1.0 Licensed MIT*/define("magix",["$"],function(n){var t,e=function(n,t){n?(u(n)||(n=[n]),require(n,t)):t&&t()},r=function(){},i=function(n,t,e,i,o){return r[g]=t[g],o=new r,j(o,e),j(n,i),o.constructor=n,n[g]=o,n},o=n.isPlainObject,u=n.isArray,f=function(t,e){n(t).html(e)},c=0,a="",s=[],$=s.slice,d=function(){},p=",",l=(window,document),v="#",h="",m="object",g="prototype",w=/[#?].*$/,y=/([^=&?\/#]+)=?([^&#?]*)/g,b=/(?!^)=|&/,x=function(n){return(n||"mx_")+c++},V=x(),I={rootId:x(),defaultView:V,error:function(n){throw n}},S=I.hasOwnProperty,U=function(n){return typeof n==m?n:l.getElementById(n)},k=function(n,t,e){if(n=U(n),t=U(t),n&&t&&(e=n==t,!e))try{e=t.contains?t.contains(n):16&t.compareDocumentPosition(n)}catch(r){}return e},j=function(n,t,e){for(e in t)n[e]=t[e];return n},A=function(n,t,e,r,i,o){for(u(n)||(n=[n]),u(t)||(t=[t]),r=0;o=n[r];r++)try{i=o&&o.apply(e,t)}catch(f){I.error(f)}return i},T=function(n,t){return n&&S.call(n,t)},Z=function(n,t){return t.f-n.f||t.t-n.t},M=function(n,t,e,r){r=this,r.c=[],r.b=0|t||5,r.x=r.b+(n||20),r.r=e};j(M[g],{get:function(n){var t=this,e=t.c,r=e[h+n];return r&&(r.f++,r.t=c++,r=r.v),r},set:function(n,t){var e=this,r=e.c,i=h+n,o=r[i],u=e.b;if(!o){if(r.length>=e.x)for(r.sort(Z);u--;)o=r.pop(),o.f>0&&e.del(o.o);o={o:n},r.push(o),r[i]=o}o.v=t,o.f=1,o.t=c++},del:function(n){n=h+n;var t=this.c,e=t[n],r=this.r;e&&(e.f=-1,e.v=a,delete t[n],r&&A(r,e.o,e))},has:function(n){return T(this.c,h+n)}});var O,H=new M,L=function(n,t,e){try{e=decodeURIComponent(e)}catch(r){}O[t]=e},P=function(n){var t,e=H.get(n);return e||(O={},t=n.replace(w,a),n==t&&b.test(t)&&(t=a),n.replace(t,a).replace(y,L),H.set(n,e={a:t,b:O})),{path:e.a,params:j({},e.b)}},q=function(n,t,e){var r,i,o,u=[];for(i in t)r=t[i]+a,(!e||r||T(e,i))&&(r=encodeURIComponent(r),u.push(o=i+"="+r));return o&&(n+=(n&&(~n.indexOf("?")?"&":"?"))+u.join("&")),n},C=function(n,t){var e,r,i,o={};if(n&&(i=n.length))for(e=0;i>e;e++)r=n[e],o[t&&r?r[t]:r]=t?r:(0|o[r])+1;return o},E={config:function(n,t){return t=I,n&&(t=o(n)?j(t,n):t[n]),t},boot:function(n){j(I,n),e(I.exts,function(){_().mountView(I.defaultView)})},toMap:C,toTry:A,toUrl:q,parseUrl:P,mix:j,has:T,inside:k,node:U,guid:x,Cache:M},N="on",F={fire:function(n,t,e,r){var i,o,u,f,c=h+n,a=this,s=a[c];if(t||(t={}),t.type||(t.type=n),s)for(i=s.length,o=i-1;i--;)u=r?i:o-i,f=s[u],f.d?(s.splice(u,1),o--):A(f.f,t,a);s=a[N+n],s&&A(s,t,a),e&&a.off(n)},on:function(n,t){var e=this,r=h+n,i=e[r]||(e[r]=[]);i.push({f:t})},off:function(n,t){var e,r,i=h+n,o=this,u=o[i];if(t){if(u)for(e=u.length;e--;)if(r=u[e],r.f==t&&!r.d){r.d=1;break}}else delete o[i],delete o[N+n]}};E.Event=F;var J,R,B=/\{(.+)\}/,D=function(n,t,e){n.$d||n.$h||n.$cc!=n.$rc||(n.$cr||(n.$cr=1,n.$ca=0,n.fire("created")),t=n.id,e=z[n.pId],e&&!T(e.$r,t)&&(e.$r[t]=1,e.$rc++,D(e)))},K=function(n,t,e,r){t||(t={}),!n.$ca&&n.$cr&&(n.$cr=0,n.$ca=1,n.fire("alter",t),e=n.id,r=z[n.pId],r&&T(r.$r,e)&&(r.$rc--,delete r.$r[e],K(r,t)))},_=function(n,e){return J||(t=l.body,n=I.rootId,e=U(n),e||(t.id=n),J=new W(n)),J},z={},G=function(n,t){T(z,n)||(z[n]=t,W.fire("add",{vframe:t}))},Q=function(n,t,e){e=z[n],e&&(delete z[n],W.fire("remove",{vframe:e,fcc:t}))},W=function(n,t,e){e=this,e.id=n,e.$c={},e.$cc=0,e.$rc=0,e.$s=1,e.$r={},e.pId=t,G(n,e)};j(W,j({root:_,all:function(){return z},get:function(n){return z[n]}},F)),j(j(W[g],F),{mountView:function(n,t){var r,i,o,u=this,f=U(u.id);!u.$a&&f&&(u.$a=1,u.$t=f.innerHTML),u.unmountView(),u.$d=0,f&&n&&(u.path=n,r=P(n),i=++u.$s,e(r.path,function(n){if(i==u.$s){xn(n);var e,f,c=r.params,a=u.parent();if(a=a&&a.$v,a=a&&a.$updater)for(e in c)f=c[e],f=f.match(B),f&&(c[e]=a.get(f[1]));var s=j(c,t);o=new n({owner:u,id:u.id},s),u.$v=o,bn(o),o.init(s),o.render(),o.tmpl||o.$p||o.endUpdate()}}))},unmountView:function(){var n,t,e=this,r=e.$v;r&&(R||(t=1,R={id:e.id}),e.$d=1,e.unmountZone(0,1),K(e,R),e.$v=0,Vn(r),n=U(e.id),n&&e.$a&&f(n,e.$t),t&&(R=0)),e.$s++},mountVframe:function(n,t,e){var r,i=this;return K(i),r=z[n],r||(T(i.$c,n)||i.$cc++,i.$c[n]=n,r=new W(n,i.id)),r.mountView(t,e),r},mountZone:function(t,e){var r,i,o,u=this;t=t||u.id;var f=n(v+t+" [mx-view]");for(u.$h=1,u.unmountZone(t,1),r=f.length-1;r>=0;r--)i=f[r],o=i.id||(i.id=x()),u.mountVframe(o,i.getAttribute("mx-view"),e);u.$h=0,D(u)},unmountVframe:function(n,t){var e,r,i,o=this;n=n?o.$c[n]:o.id,e=z[n],e&&(r=e.$cr,i=e.pId,e.unmountView(),Q(n,r),e.id=e.pId=a,e=z[i],e&&T(e.$c,n)&&(delete e.$c[n],e.$cc--,t||D(e)))},unmountZone:function(n,t){var e,r=this,i=r.$c;for(e in i)(!n||e!=n&&k(e,n))&&r.unmountVframe(e,1);t||D(r)}}),E.Vframe=W;var X=function(t,e,r,i){n(t)[i?"off":N](e,r)},Y="parentNode",nn=new M(30,10),tn=/([^\(]+)\(([\s\S]*)?\)/,en={},rn=function(n){for(var e,r,i,o,u,f,c,a,$,d,p=n.target,l=n.type,v="mx-"+l,m=[];p!=t&&1==p.nodeType;){if(e=p.getAttribute(v)){if(m=[],u=p.$f,!u)for(f=p;f=f[Y];)if(T(z,c=f.id)){p.$f=u=c;break}u?(i=z[u],o=i&&i.$v,o&&o.$s>0&&(a=nn.get(e),a||(a=e.match(tn)||s,a={n:a[1],i:a[2]},a.p=a.i&&A(Function("return "+a.i))||{},nn.set(e,a)),$=a.n+h+l,d=o[$],d&&(n.current=p,n.params=a.p,A(d,n,o)))):I.error(Error("bad:"+e))}if((r=p.$)&&r[l]||n.mxStop||n.isPropagationStopped())break;m.push(p),p=p[Y]||t}for(;p=m.pop();)r=p.$||(p.$={}),r[l]=1},on=function(n,e){var r=0|en[n],i=r>0?1:0;r+=e?-i:i,r||(X(t,n,rn,e),e||(r=1)),en[n]=r},un={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},fn=/\\|'|\r|\n|\u2028|\u2029/g,cn=function(n){return"\\"+un[n]},an=/<%=([\s\S]+?)%>|<%!([\s\S]+?)%>|<%([\s\S]+?)%>|$/g,sn=function(n){var t=0,e="$p+='";n.replace(an,function(r,i,o,u,f){return e+=n.slice(t,f).replace(fn,cn),t=f+r.length,i?e+="'+\n(($t=("+i+"))==null?'':$e($t))+\n'":o?e+="'+\n(($t=("+o+"))==null?'':$t)+\n'":u&&(e+="';\n"+u+"\n$p+='"),r}),e+="';\n",e="with($mx){\n"+e+"}\n",e="var $t,$p='',$em={'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\\'':'&#x27;','`':'&#x60;'},$er=/[&<>\"'`]/g,$ef=function(m){return $em[m]},$e=function(v){v=v==null?'':''+v;return v.replace($er,$ef)};\n"+e+"return $p;\n";var r;try{r=Function("$mx",e)}catch(i){throw i.source=e,i}return r},$n=new M,dn=function(n,t){var e=$n.get(n);return e||(e=sn(n),$n.set(n,e)),e(t)},pn=/\u001f/g,ln=/@(\d+)\-\u001f/g,vn=JSON.stringify,hn=function(n,t,e,r){var i=n.$v,o=i.tmpl,u=i.id,f=function(n,t){return dn(n,t).replace(pn,u)},c=o.html,a=o.subs;if(t||!n.$rd)if(n.$rd&&e&&a)for(var s,$,d,p,l,v,h,m,g={},w=function(n){var t=n.id||(n.id=x("n"));if(!g[t]){g[t]=1;var e=$.view&&z[t];if(p)for(var o=$.attrs.length-1;o>=0;o--){var u=$.attrs[o],c=f(u.v,r);u.p?n[u.n]=c:n.setAttribute(u.n,c)}e&&e.unmountView(),$.tmpl&&d&&i.setHTML(t,f($.tmpl,r)),e&&e.mountView(f($.view,r))}},y=a.length-1;y>=0;y--){if(d=0,p=0,$=a[y],l=1,h=$.mask,s=$.pKeys)for(v=s.length;--v>=0;)if(T(e,s[v])){l=0;break}if(l){for(s=$.keys,v=s.length,l=0;--v>=0;)if(T(e,s[v])){if(l=1,!h||d&&p){d=$.tmpl,p=$.attrs;break}m=h.charAt(v),d=d||1&m,p=p||2&m}if(l){l="#"+u+" "+$.selector.replace(pn,u);var b=document.querySelectorAll(l);for(v=0;v<b.length;)w(b[v++])}}}else{var V,I,S=function(n,t){return V[t].tmpl};if(a){if(!a.$)for(a.$=V={},I=a.length;I>0;){var U=a[--I];U.guid&&(V[U.guid]=U,U.tmpl=U.tmpl.replace(ln,S),delete U.guid)}V=a.$}n.$rd=1;var k=c.replace(ln,S);i.setHTML(u,f(k,r))}},mn=function(n){var t=this;t.$v=n,t.$data={},t.$json={}},gn=mn.prototype;j(gn,F),j(gn,{get:function(n){var t=this.$data;return n&&(t=t[n]),t},set:function(n){var t=this;return j(t.$data,n),t},digest:function(){var n,t,e,r,i,o=this,u=o.$data,f=o.$json,c={};for(e in u)t=u[e],i=0,r=vn(t),T(f,e)?(i=r!=f[e],f[e]=r):(f[e]=r,i=1),i&&(c[e]=n=1);return hn(o,n,c,u),n&&(o.fire("changed",{keys:c}),delete o.$lss),o},snapshot:function(){var n=this;return n.$ss=vn(n.$json),n},altered:function(){var n=this;return n.$ss?(n.$lss||(n.$lss=JSON.stringify(n.$json)),n.$ss!=n.$lss):!0}});var wn=/^([^<]+)<([^>]+)>$/,yn=function(n,t,e){t=n.render,n.render=function(){e=this,e.$s>0&&(e.$s++,e.fire("rendercall"),A(t,$.call(arguments),e))}},bn=function(n,t){var e,r=n.$eo;for(e in r)on(e,t)},xn=function(n){if(!n[h]){n[h]=1;var t,e,r,i,o,u=n[g],f={};for(o in u)if(t=u[o],e=o.match(wn))for(r=e[1],i=e[2],i=i.split(p);e=i.pop();)f[e]=1,u[r+h+e]=t;yn(u),u.$eo=f}},Vn=function(n){n.$s>0&&(n.$s=0,n.fire("destroy",0,1,1),bn(n,1)),n.$s--},In=function(n,t){t=this,j(t,n),t.$s=1,t.$updater=new mn(t)},Sn=In[g];return j(In,{extend:function(n,t){var e=this;n=n||{};var r=n.ctor,o=function(n,t){e.call(this,n,t),r&&r.call(this,t)};return o.extend=e.extend,i(o,e,n,t)}}),j(j(Sn,F),{render:d,init:d,beginUpdate:function(n,t){t=this,t.$s>0&&t.$p&&t.owner.unmountZone(n,1)},endUpdate:function(n,t){t=this,t.$s>0&&(t.$p=1,t.owner.mountZone(n))},wrapAsync:function(n,t){var e=this,r=e.$s;return function(){r>0&&r==e.$s&&n&&n.apply(t||e,arguments)}},setHTML:function(n,t){var e,r=this;r.beginUpdate(n),r.$s>0&&(e=U(n),e&&f(e,t)),r.endUpdate(n)}}),E.View=In,define(V,function(){return In.extend()}),E});