/*!3.8.4 MIT kooboy_li@163.com*/module.exports=function(){var t,e=require("$"),n=e.isPlainObject,r=e.isArray,i=0,o="",a=[],f=",",u=window,c=document,s=e(c),h=u.setTimeout,d="changed",v="change",$="pageunload",l="value",p="mxs",g=function(){},m=JSON.stringify,b="\x1e",w="object",y="prototype",x="params",k="path",V="mx-view",I=/[#?].*$/,A=/([^=&?\/#]+)=?([^&#?]*)/g,T=/(?!^)=|&/,C=function(t){return(t||"mx_")+i++},S=C(),O={rootId:C(),defaultView:S,error:function(t){throw t}},P=function(t){return typeof t==w?t:c.getElementById(t)},U=function(t){return!t||typeof t!=w},j=function(t,e,n){if(t=P(t),e=P(e),t&&e&&!(n=t==e))try{n=16==(16&e.compareDocumentPosition(t))}catch(t){}return n},q=function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])R(e,i)&&(t[i]=e[i]);return t},E=function(t,e,n){for(n in e=[],t)R(t,n)&&e.push(n);return e},H=O.hasOwnProperty,N=e("head"),L=function(t,e){e&&!L[t]&&(L[t]=1,N.append("<style>"+e))},Z=function(t){return t.id||(t.$a=1,t.id=C())},M=function(t,e,n,i,o){e=e||a,r(t)||(t=[t]),r(e)||(e=[e]);for(var f=0,u=t;f<u.length;f++){o=u[f];try{i=o&&o.apply(n,e)}catch(t){O.error(t)}}return i},R=function(t,e){return t&&H.call(t,e)},B=function(t,e,n){var r,i;for(r in e)i=e[r],n[r]=(i+o)[0]==b?t[i]:i},D=function(t,e){return e.f-t.f||e.t-t.t},z=function(t,e,n,r){(r=this).c=[],r.b=e||5,r.x=r.b+(t||20),r.r=n};q(z[y],{get:function(t){var e=this.c[b+t];return e&&(e.f++,e.t=i++,e=e.v),e},each:function(t,e,n){for(var r=0,i=(n=this).c;r<i.length;r++)t(i[r].v,e,n)},set:function(t,e){var n=this.c,r=b+t,o=n[r],a=this.b;if(!o){if(n.length>=this.x)for(n.sort(D);a--;)(o=n.pop()).f>0&&this.del(o.o);o={o:t},n.push(o),n[r]=o}o.v=e,o.f=1,o.t=i++},del:function(t){t=b+t;var e=this.c,n=e[t],r=this.r;n&&(n.f=-1,n.v=o,delete e[t],r&&M(r,n.o))},has:function(t){return R(this.c,b+t)}});var F,J,Q=e.isFunction,X=function(t,e){var n=O.views||g;if(n[S]||(n[S]=F),!t)return e();r(t)||(t=[t]);for(var i,o=[],a=0,f=function(){a||e.apply(ft,o)},u=function(t,e,n){(t=t(n=function(t){o[e]||(a--,o[e]=t,f())})).then&&t.then(n)},c=0;c<t.length;c++)i=n[t[c]],Q(i)&&!i.extend?(a++,u(i,c)):o[c]=n[t[c]];f()},_=function(){},G=function(t,e,n,r,i){return _[y]=e[y],i=new _,q(i,n),q(t,r),i.constructor=t,t[y]=i,t},K=e.find||e.zepto,W=K.matchesSelector||K.matches,Y=function(t,e){e=t.data,t.eventTarget=e.e,M(e.f,t,e.v)},tt=function(t,n,r,i,o){o&&(n+="."+o.i),i?e(t).off(n,r):e(t).on(n,o,r)},et=new z,nt=0,rt=function(t,e,n){try{n=decodeURIComponent(n)}catch(t){}J[e]=n},it=function(t){var e,n=et.get(t);return n||(J={},t==(e=t.replace(I,o))&&T.test(e)&&(e=o),t.replace(e,o).replace(A,rt),et.set(t,n={a:e,b:J})),{path:n.a,params:q({},n.b)}},ot=function(t,e,n){var r,i,a,f=[];for(i in e)r=e[i]+o,(!n||r||R(n,i))&&(r=encodeURIComponent(r),f.push(a=i+"="+r));return a&&(t+=(t&&(~t.indexOf("?")?"&":"?"))+f.join("&")),t},at=function(t,e){var n,r={};if(t)for(var i=0,o=t;i<o.length;i++)n=o[i],r[e&&n?n[e]:n]=e?n:1+(0|r[n]);return r},ft={config:function(t,e){return e=O,t&&(e=n(t)?q(e,t):e[t]),e},boot:function(t){q(O,t),X(O.ini,function(e){q(O,e,t),X(O.exts,function(){Ht.on(d,Rt),lt.on(d,Rt),nt=1,Ut()})})},toMap:at,toTry:M,toUrl:ot,parseUrl:it,mix:q,has:R,keys:E,inside:j,node:P,applyStyle:L,guid:C,use:X,Cache:z,nodeId:Z},ut={fire:function(t,e,n,r){var i,a,f,u,c=this,s=c[b+t];if(e||(e={}),e.type||(e.type=t),s)for(a=(i=s.length)-1;i--;)(u=s[f=r?i:a-i]).f?(u.x=1,M(u.f,e,c),u.x=o):u.x||(s.splice(f,1),a--);(s=c["on"+t])&&M(s,e,c),n&&c.off(t)},on:function(t,e){var n=b+t;(this[n]||(this[n]=[])).push({f:e})},off:function(t,e){var n,r=b+t,i=this[r];if(e){if(i)for(var a=0,f=i;a<f.length;a++)if((n=f[a]).f==e){n.f=o;break}}else delete this[r],delete this["on"+t]}};ft.Event=ut;var ct={},st={},ht={},dt=0,vt=function(t){for(var e=0,n=t=(t+o).split(",");e<n.length;e++){var r=n[e];R(st,r)?st[r]++:st[r]=1}return t},$t=function(t){for(var e,n=0,r=t;n<r.length;n++)e=r[n],R(st,e)&&(--st[e]||(delete st[e],delete ct[e]))};var lt=q({get:function(t){var e=t?ct[t]:ct;return e},set:function(t){dt=function(t,e,n){var r,i,o,a=0;for(o in t)r=t[o],i=e[o],U(r)&&i===r||(n[o]=1,a=1),e[o]=r;return a}(t,ct,ht)||dt},digest:function(t){t&&lt.set(t),dt&&(dt=0,this.fire(d,{keys:ht}),ht={})},diff:function(){return ht},clean:function(t){return{ctor:function(){t=vt(t),this.on("destroy",function(){return $t(t)})}}}},ut);ft.State=lt;var pt,gt,mt,bt,wt,yt,xt="view",kt=new z,Vt=new z,It=u.location,At=0,Tt={query:{},params:{},href:o},Ct=/(?:^.*\/\/[^\/]+|#.*$)/gi,St=/^[^#]*#?!?/,Ot=function(t){return this[x][t]||o},Pt=function(t,e){t="#!"+t,e?It.replace(t):It.hash=t},Ut=function(){var t,e,n=qt().srcHash;tt(u,"hashchange",function(r,i,a){e||(i=qt(),(t=i.srcHash)!=n&&(a=function(){r.p=1,n=t,e=o,Pt(t),Et()},r={reject:function(){r.p=1,e=o,Pt(n)},resolve:a,prevent:function(){e=1}},Ht.fire(v,r),e||r.p||a()))}),u.onbeforeunload=function(t,e,n){if(t=t||u.event,e={},Ht.fire($,e),n=e.msg)return t&&(t.returnValue=n),n},Et()},jt=c.title,qt=function(t){t=t||It.href;var e,r,i,a,f,u=kt.get(t);return u||(e=t.replace(Ct,o),r=t.replace(St,o),i=it(e),a=it(r),f=q({},i[x],a[x]),u={get:Ot,href:t,srcQuery:e,srcHash:r,query:i,hash:a,params:f},nt&&(!function(t,e){if(gt||(gt=O.routes||{},mt=O.unmatchView,bt=O.defaultView,wt=O.defaultPath||"/",yt=O.rewrite),!t[xt]){var r=t.hash[k]||wt;yt&&(r=yt(r,t[x],gt)),e=gt[r]||mt||bt,t[k]=r,t[xt]=e,n(e)&&q(t,e)}}(u),kt.set(t,u))),u},Et=function(){var t=qt(),e=function(t,e){var n=t.href,r=e.href,i=n+b+r,o=Vt.get(i);if(!o){var a,f;o={params:f={},force:!n};for(var u=t[x],c=e[x],s=function(t){var e=u[t],n=c[t];e!=n&&(f[t]={from:e,to:n},a=1)},h=0,d=E(u).concat(E(c));h<d.length;h++)s(d[h]);u=t,c=e,f=o,s(k),s(xt),Vt.set(i,o={a:a,b:o})}return o}(Tt,Tt=t);return!At&&e.a&&((pt=e.b)[k]&&(c.title=t.title||jt),Ht.fire(d,pt)),At=0,pt},Ht=q({parse:qt,diff:Et,to:function(t,e,r,i){!e&&n(t)&&(e=t,t=o);var a,f,u,c,s=it(t),h=s[x],d=s[k],v=Tt[k],$=Tt[x],l=Tt.query[x];if(q(h,e),d)for(v in l)R(h,v)||(h[v]=o);else $&&(d=v,h=q({},$,h));f=Tt,u=r,c=i,(a=ot(a=d,h,l))!=f.srcHash&&(At=c,Pt(a,u))}},ut);ft.Router=Ht;var Nt,Lt,Zt=0,Mt=function(t,e,n,r,i,o){if(t&&t.$a!=Zt&&(n=t.$v)&&n.$a>1){(e?function(t,e,n){var r,i=t.$os;if(i)for(var o=0,a=i;o<a.length&&(r=a[o],!(n=R(e,r)));o++);return n}(n,e):ye(n))&&n.$b();for(var a=0,f=t.children();a<f.length;a++)o=f[a],Mt(Ft[o],e)}},Rt=function(t,e,n){e=zt(),(n=t[xt])?e.mountView(n.to):(Zt=i++,Mt(e,t.keys))},Bt=function(t){if(!t.$b&&!t.$d&&t.$cc==t.$rc){t.$cr||(t.$cr=1,t.$ca=0,t.fire("created"));var e=void 0,n=t.id,r=t.pId;(e=Ft[r])&&!R(e.$e,n)&&(e.$e[n]=1,e.$rc++,Bt(e))}},Dt=function(t,e){if(!t.$ca&&t.$cr){t.$cr=0,t.$ca=1,t.fire("alter",e);var n=void 0,r=t.id,i=t.pId;(n=Ft[i])&&R(n.$e,r)&&(n.$rc--,delete n.$e[r],Dt(n,e))}},zt=function(e){return Nt||(t=c.body,P(e=O.rootId)||(t.id=e),Nt=new Qt(e)),Nt},Ft={},Jt=[],Qt=function(t,e,n){var r,i;(n=this).id=t,n.$c={},n.$cc=0,n.$rc=0,n.$g=1,n.$e={},n.$f=[],n.pId=e,i=n,R(Ft,r=t)||(Ft[r]=i,Qt.fire("add",{vframe:i}),(r=P(r))&&(r.vframe=i))};q(Qt,{all:function(){return Ft},get:function(t){return Ft[t]}},ut),q(Qt[y],ut,{mountView:function(t,e){var n,r,i,o,a,f,u=this,c=u.id,s=u.pId,h=u.$g,d=P(c);!u.$h&&d&&(u.$h=1,u.$i=d.innerHTML),u.unmountView(),u.$b=0,d&&t&&(u[k]=t,n=it(t),i=n[k],r=++h,o=n[x],f=(f=(f=(f=Ft[s])&&f.$v)&&f.$d)&&f.$a,t.indexOf(b)>0&&B(f,o,o),u.$n=n[k],q(o,e),X(i,function(t){if(r==u.$g){if(!t)return O.error(Error("id:"+c+" cannot load:"+i));a=we(t),i=new t(c,u,o,a),u.$v=i,u.$a=Zt,ge(i),M(i.init,o,i),i.$b(),i.$e||(u.$h=0,i.$f||i.endUpdate())}}))},unmountView:function(){var t,n,r=this,i=r.$v,o=r.id;r.$f=[],i&&(Lt||(n=1,Lt={id:o}),r.$b=1,r.unmountZone(0,1),Dt(r,Lt),r.$v=0,i.$a>0&&(i.$a=0,i.fire("destroy",0,1,1),le(i,1),ge(i,1),i.owner=0),i.$a--,(t=P(o))&&r.$h&&e(t).html(r.$i),n&&(Lt=0)),r.$g++},mountVframe:function(t,e,n){var r,i=this,o=i.id,a=i.$c;return Dt(i,{id:t}),(r=Ft[t])||(R(a,t)||(i.$o=0,i.$cc++),a[t]=t,(r=Jt.pop())?Qt.call(r,t,o):r=new Qt(t,o)),r.mountView(e,n),r},mountZone:function(t,n){var r,i,o=this,a=[];t=t||o.id;var f,u=e("#"+t+" ["+V+"]");o.$d=1;for(var c=0,s=u;c<s.length;c++)r=s[c],i=Z(r),r.$b||(r.$b=1,a.push([i,r.getAttribute(V)]));for(var h=0,d=a;h<d.length;h++)i=(f=d[h])[0],r=f[1],a[i]?O.error(Error("vf.id duplicate:"+i+" at "+o[k])):o.mountVframe(a[i]=i,r);o.$d=0,n||Bt(o)},unmountVframe:function(t,e){var n,r,i,o;if(t=t?this.$c[t]:this.id,n=Ft[t]){var a=n.$cr,f=n.pId;n.unmountView(),i=a,(o=Ft[r=t])&&(delete Ft[r],Qt.fire("remove",{vframe:o,fcc:i}),(r=P(r))&&(r.$b=0),r&&(r.vframe=0),r&&(r.$d=0)),n.id=n.pId=n.$c=n.$e=0,n.$h=0,n.off("alter"),n.off("created"),Jt.push(n),(n=Ft[f])&&R(n.$c,t)&&(delete n.$c[t],n.$o=0,n.$cc--,e||Bt(n))}},unmountZone:function(t,e){var n;for(n in this.$c)(!t||n!=t&&j(n,t))&&this.unmountVframe(n,1);e||Bt(this)},parent:function(t,e){for(e=this,t=t>>>0||1;e&&t--;)e=Ft[e.pId];return e},children:function(t){return(t=this).$o||(t.$o=E(t.$c))},invoke:function(t,e){var n,r,i,o,a,f=this.$f;return(r=this.$v)&&r.$f?n=(i=r[t])&&M(i,e,r):((o=f[a=b+t])&&(o.r=e===o.a),o={n:t,a:e,k:a},f.push(o),f[a]=o),n}}),ft.Vframe=Qt,e.fn.invokeView=function(t,e){if(this.length){var n=this[0],r=n.vframe;if(void 0===e)return r&&r.invoke(t);for(var i=0;i<this.length;i++)(r=(n=this[i]).vframe)&&r.invoke(t,e)}};var Xt=new z(30,10),_t=/(?:([\w\-]+)\x1e)?([^(]+)\(([\s\S]*)?\)/,Gt={},Kt={},Wt=function(e,n){var r,i,o,f,u,c,s=[],h=e,d=e.getAttribute("mx-"+n),v=[],$=0;if(d&&((f=Xt.get(d))||((f={v:(f=d.match(_t)||a)[1],n:f[2],i:f[3]}).p=f.i&&M(Function("return "+f.i),a,e),Xt.set(d,f)),f=q({},f,{r:d}),s.push(f)),f&&!f.v||Kt[n]){if(!(c=e.$a))for(v.push(h);h!=t&&(h=h.parentNode);){if(Ft[i=h.id]||(i=h.$v)){c=i;break}v.push(h)}if(c){for(var l=0,p=v;l<p.length;l++)(d=p[l]).$a=c;h=e.id,Ft[h]&&($=c=h);do{if((r=Ft[c])&&(u=r.$v)){for(i in(o=u.$so)[n])o={r:i,v:c,n:i},i?W(e,i)&&s.push(o):$&&s.unshift(o);if(u.$e&&!$){f&&!f.v&&(f.v=c);break}$=0}}while(r&&(c=r.pId))}}return s},Yt=function(e){for(var n,r,i,o,a,f,u,c=e.target,s=e.type,h=[];c!=t;){if((n=Wt(c,s)).length){h=[];for(var d=0,v=n;d<v.length;d++){var $=v[d],l=$.v,p=($.r,$.n),g=$.p,m=$.i;if(f!=l){if(f&&e.isPropagationStopped())break;f=l}if(o=(i=Ft[l])&&i.$v){if((a=o[p+b+s])&&(e.eventTarget=c,u=g||{},m&&m.indexOf(b)>0&&B(o.$d.$a,u,u={}),e[x]=u,M(a,e,o),e.isImmediatePropagationStopped()))break;0}else e.stopPropagation();0}}if((r=c.$)&&r[s]||e.isPropagationStopped())break;h.push(c),c=c.parentNode||t}for(var w=0,y=h;w<y.length;w++)(r=(c=y[w]).$||(c.$={}))[s]=1},te="http://www.w3.org/2000/svg",ee={option:[1,"<select multiple>"],thead:[1,"<table>"],col:[2,"<table><colgroup>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],area:[1,"<map>"],param:[1,"<object>"],g:[1,'<svg xmlns="'+te+'">'],all:[0,""]},ne=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;ee.optgroup=ee.option,ee.tbody=ee.tfoot=ee.colgroup=ee.caption=ee.thead,ee.th=ee.td;var re=c.implementation.createHTMLDocument(o),ie=re.createElement("base");ie.href=c.location.href,re.head.appendChild(ie);var oe=function(t,e){var n=Z(e);t.$c[n]?t.unmountVframe(n,1):t.unmountZone(n,1)},ae={INPUT:[l,"checked"],TEXTAREA:[l],OPTION:["selected"]},fe=function(t,e,n,r){var i,o,a,f,u=t.attributes,c=e.attributes,s=t.nodeName;for(o=u.length;o--;)i=u[o].name,e.getAttribute(i)||("id"==i?r||n.d.push([t,""]):(n.c=1,t.removeAttribute(i)));for(o=c.length;o--;)a=(i=c[o]).name,f=i[l],t.getAttribute(a)!=f&&("id"==a?n.d.push([t,f]):(n.c=1,t.setAttribute(a,f)));var h=ae[s];if(h)for(var d=0,v=h;d<v.length;d++)t[o=v[d]]!=e[o]&&(t[o]=e[o])},ue=function(t,e,n){return(e=t.$a?o:t.id)||1!=t.nodeType||(e=t.getAttribute(p)||(n=Ft[e])&&n.$n),e},ce=function(t,e,n,r,i){for(var o,a,f,u,c=t.lastChild,s=e.firstChild,h=0,d={};c;)h++,f=ue(a=c),c=c.previousSibling,f&&(f=d[f]||(d[f]=[])).push(a);for(c=t.firstChild;s;)h--,o=s,s=s.nextSibling,(u=d[f=ue(o)])&&(u=u.pop())?(u!=c?t.insertBefore(u,c):c=c.nextSibling,se(u,o,t,n,r,i)):c?(f=ue(a=c))&&d[f]?(h++,n.c=1,t.insertBefore(o,a)):(c=c.nextSibling,se(a,o,t,n,r,i)):(t.appendChild(o),n.c=1);for(;h-- >0;)a=t.lastChild,oe(r,a),t.removeChild(a),n.c=1},se=function(t,e,n,r,i,a){if(t.nodeName===e.nodeName)if(1===t.nodeType){var f=t.getAttribute(p);if(f&&f==e.getAttribute(p))return;var u=e.getAttribute(V),c=e.innerHTML,s=t.getAttribute("mxa"),h=!s||s!=e.getAttribute("mxa"),d=void 0,v=void 0,$=Ft[t.id],l=void 0,g=void 0,m=void 0,w=void 0,y=void 0,I=void 0;u&&$&&(l=(m=$.$v).$g,w=it(u),I=c!=$.$i,g=u.indexOf("?")>0||I),u&&$&&$.$n==w[k]?g&&(l?(y=w[x],u.indexOf(b)>-1&&B(a,y,y),$.$i=c,$[k]=u,w={node:e,deep:!m.$e,html:I},h&&(h=o,fe(t,e,r,1)),M(l,[y,w],m)&&r.v.push(m),d=w.deep):(v=1,d=1)):(d=1,v=$),v&&$.unmountVframe(0,1),h&&(v&&(r.c=1),fe(t,e,r,$&&u)),d&&ce(t,e,r,i,a)}else t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);else oe(i,t),n.replaceChild(e,t),r.c=1},he=function(t){var e,n,r,i=t.$b,o=Ft[i],a=t.$a,f=o&&o.$v,u={d:[],v:[]},c=P(i);if(f&&f.$a>0&&(e=f.$e)){n=e(a,i),ce(c,function(t,e){var n=re.createElement("div"),r=te==e.namespaceURI?"g":(ne.exec(t)||[0,""])[1].toLowerCase(),i=ee[r]||ee.all;n.innerHTML=i[1]+t;for(var o=i[0];o--;)n=n.lastChild;return n}(n,c),u,o,a);for(var h=0,d=u.d;h<d.length;h++)(r=d[h])[0].id=r[1];for(var v=0,$=u.v;v<$.length;v++)(r=$[v]).$b();u.c&&(f.endUpdate(i),s.trigger({type:"htmlchanged",vId:i})),f.fire("domready")}},de=function(t){var e;this.$b=t,this.$a=((e={vId:t})[b]=1,e)};q(de[y],{get:function(t,e){return e=this.$a,t&&(e=e[t]),e},set:function(t){return q(this.$a,t),this},digest:function(t){return this.set(t),he(this),this},snapshot:function(){return this.$d=m(this.$a),this},altered:function(){if(this.$d)return this.$d!=m(this.$a)}});var ve=/^(\$?)([^<]*)<([^>]+)>$/,$e=function(t,e,n){return t.$h?n=t:((n=function(t){M(n.$h,t,this)}).$h=[t],n.$i=1),n.$h=n.$h.concat(e.$h||e),n},le=function(t,e){var n,r,i=t.$r;for(n in i)r=i[n],(e||r.x)&&pe(i,n,1)},pe=function(t,e,n,r){var i,o,f=t[e];return f&&f!=r&&((i=(o=f.e).destroy)&&n&&M(i,a,o),delete t[e]),o},ge=function(e,n){var r,i,o,a,f,u,c=e.$eo,s=e.$so,h=e.$el,d=e.id;for(r in c)i=r,o=s[r],a=n,void 0,void 0,f=0|Gt[i],u=a?-1:1,f&&a!==f||tt(t,i,Yt,a),Gt[i]=f+u,o&&(Kt[i]=(0|Kt[i])+u);for(var v=0,$=h;v<$.length;v++)r=$[v],tt(r.e,r.n,Y,n,{i:d,v:e,f:r.f,e:r.e})},me=[],be={win:u,doc:c},we=function(t){if(!t[b]){t[b]=[];var e=t[y],n=void 0,r=void 0,i=void 0,o={},a=[],u={},c=void 0,s=void 0,h=void 0,d=void 0,v=void 0,$={};if(r=e.mixins){for(var l=0,p=r;l<p.length;l++)for(h in c=p[l])n=c[h],i=$[h],"ctor"!=h?(ve.test(h)&&(i?n=$e(i,n):n.$i=1),$[h]=n):t[b].push(n);for(h in $)R(e,h)||(e[h]=$[h])}for(h in e)if(n=e[h],r=h.match(ve)){s=r[1],i=r[2];for(var g=0,m=r[3].split(f);g<m.length;g++){if(d=m[g],c=be[i],v=1,s){if(c){a.push({f:n,e:c,n:d});continue}v=2,(c=u[d])||(c=u[d]={}),c[i]=1}o[d]=o[d]|v,(c=e[d=i+b+d])?c.$i&&(n.$i?e[d]=$e(c,n):R(e,h)&&(e[d]=n)):e[d]=n}}k="$b",V=(w=e)[x="render"],w[x]=w[k]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(I=this).$a>0&&(I.$a++,I.fire("rendercall"),le(I),M(V,t,I))},e.$eo=o,e.$el=a,e.$so=u,e.$e=e.tmpl,e.$g=e.assign}var w,x,k,V,I;return t[b]},ye=function(t){var e,n,r,i=t.$l;if(i.f&&(i.p&&(e=pt[k]),!e&&i.k)){r=pt[x];for(var o=0,a=i.k;o<a.length&&(n=a[o],!(e=R(r,n)));o++);}return e},xe=function(t,e,n,r){(r=this).owner=e,r.id=t,r.$l={k:[]},r.$r={},r.$a=1,r.updater=r.$d=new de(r.id),M(me,n,r)},ke=xe[y];q(xe,{merge:function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++)(e=(t=o[i])&&t.ctor)&&me.push(e),q(ke,t)},extend:function(t,e){var n=this,r=(t=t||{}).ctor,i=[];r&&i.push(r);var o=function(t,e,r,o){n.call(this,t,e,r),M(i.concat(o),r,this)};return o.extend=n.extend,G(o,n,t,e)}}),q(ke,ut,{init:g,beginUpdate:function(t,e){(e=this).$a>0&&e.$f&&e.owner.unmountZone(t,1)},endUpdate:function(t,e,n,r,i){(n=this).$a>0&&(t=t||n.id,e?i=e:(i=n.$f,n.$f=1),(r=n.owner).mountZone(t,e),i||h(n.wrapAsync(function(){!function(t,e,n){for(e=t.$f;e.length;)(n=e.shift()).r||t.invoke(n.n,n.a),delete e[n.k]}(r)}),0))},wrapAsync:function(t,e){var n=this,r=n.$a;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(r>0&&r==n.$a)return t.apply(e||n,i)}},observeLocation:function(t,e){var r;(r=this.$l).f=1,n(t)&&(e=t[k],t=t[x]),r.p=e,t&&(r.k=(t+o).split(f))},observeState:function(t){this.$os=(t+o).split(f)},capture:function(t,e,n,r){return r=this.$r,e?(pe(r,t,1,e),r[t]={e:e,x:n}):e=(r=r[t])&&r.e,e},release:function(t,e){return pe(this.$r,t,e)},leaveTip:function(t,e){var n=this,r=function(i){var o="a",a="b";i.type!=v&&(o="b",a="a"),r[o]?(i.prevent(),i.reject()):e()?(i.prevent(),r[a]=1,n.leaveConfirm(t,function(){r[a]=0,i.resolve()},function(){r[a]=0,i.reject()})):i.resolve()},i=function(n){e()&&(n.msg=t)};Ht.on(v,r),Ht.on($,i),n.on("unload",r),n.on("destroy",function(){Ht.off(v,r),Ht.off($,i)})},render:g}),ft.View=xe;var Ve=e.type,Ie=e.now||Date.now,Ae=function(){this.id=C("b"),this.$={}};q(Ae[y],{get:function(t,e,n){var i=e!=n,a=this.$;if(t){for(var f=r(t)?t.slice():(t+o).split("."),u=void 0;(u=f.shift())&&a;)a=a[u];u&&(a=n)}return i&&Ve(e)!=Ve(a)&&(a=e),a},set:function(t,e){var r;n(t)||((r={})[t]=e,t=r),q(this.$,t)}});var Te=function(t,e,n){(n=this[t])&&(delete this[t],M(n,e,n.e))},Ce=function(t,e,n,i,o){if(t.$d)return t;if(t.$e)return t.enqueue(Ce.bind(t,t,e,n,i,o));t.$e=1,r(e)||(e=[e]);for(var a,f,u,c,s,h,d,v,$,l=t.constructor,p=0,g=l.$f,m=(a=n,f=l,u=t,c=e.length,s=i,h=l.$c,d=[],v=0,$=0,function(t,e){var n,r=this;$++;var i=r.$b,o=i.k;d[t+1]=r;var l,p={bag:r,error:e};if(e?(v=e,f.fire("fail",p),n=1):h.has(o)||(o&&h.set(o,r),i.t=Ie(),(l=i.a)&&M(l,r,r),(l=i.x)&&f.clear(l),f.fire("done",p),n=1),!u.$d){var g=$==c;g&&(u.$e=0,2==s&&(d[0]=v,M(a,d,u))),1==s&&M(a,[e||null,r,g,t],u)}n&&f.fire("end",p)}),b=0,w=e;b<w.length;b++){var y=w[b];if(y){var x=l.get(y,o),k=x.e,V=k.$b.k,I=m.bind(k,p++),A=void 0;V&&g[V]?g[V].push(I):x.u?(V&&((A=[I]).e=k,g[V]=A,I=Te.bind(g,V)),l.$s(k,I)):I()}}return t},Se=function(){var t=this;t.id=C("s"),t.$g=[]};q(Se[y],{all:function(t,e){return Ce(this,t,e,2)},save:function(t,e){return Ce(this,t,e,2,1)},one:function(t,e){return Ce(this,t,e,1)},enqueue:function(t){var e=this;return e.$d||(e.$g.push(t),e.dequeue(e.$h)),e},dequeue:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,r=this;r.$e||r.$d||(r.$e=1,h(function(){r.$e=0,r.$d||(n=r.$g.shift())&&M(n,r.$h=t)},0))},destroy:function(t){(t=this).$d=1,t.$g=0}});var Oe=function(t,e){return[m(e),m(t)].join(b)},Pe=function(t,e,n,r){(r=t&&t.$b)&&e[r.n]&&n.del(r.k)},Ue=q({add:function(t){var e,n=this.$b;r(t)||(t=[t]);for(var i=0,o=t;i<o.length;i++)if(e=o[i]){var a=e.name,f=e.cache;e.cache=0|f,n[a]=e}},create:function(t){var e=this.meta(t),r=0|t.cache||e.cache,i=new Ae;i.set(e),i.$b={n:e.name,a:e.after,x:e.cleans,k:r&&Oe(e,t)},n(t)&&i.set(t);var o=e.before;return o&&M(o,i,i),this.fire("begin",{bag:i}),i},meta:function(t){return this.$b[t.name||t]||t},get:function(t,e){var n,r;return e||(n=this.cached(t)),n||(n=this.create(t),r=1),{e:n,u:r}},clear:function(t){this.$c.each(Pe,at((t+o).split(f)))},cached:function(t){var e,n,r=this.$c,i=this.meta(t),o=0|t.cache||i.cache;if(o&&(n=Oe(i,t)),n){var a=this.$f[n];a?e=a.e:(e=r.get(n))&&Ie()-e.$b.t>o&&(r.del(n),e=0)}return e}},ut);return Se.extend=function(t,e,n){var r=function(){Se.call(this)};return r.$s=t,r.$c=new z(e,n),r.$f={},r.$b={},G(r,Se,null,Ue)},ft.Service=Se,q(g[y],ut),g.extend=function t(e,n){var r=this,i=e&&e.ctor,o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.apply(this,t),i&&i.apply(this,t)};return o.extend=t,G(o,r,e,n)},ft.Base=g,F=xe.extend(),ft}();