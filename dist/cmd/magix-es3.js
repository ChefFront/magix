/*!3.8.0 MIT kooboy_li@163.com*/define("magix",["$"],function(e){var t,n=e("$"),r=n.isPlainObject,i=n.isArray,o=0,a=[],f=window,u=document,c=n(u),s=f.setTimeout,h=function(){},d=JSON.stringify,$=/[#?].*$/,v=/([^=&?\/#]+)=?([^&#?]*)/g,l=/(?!^)=|&/,p=function(e){return(e||"mx_")+o++},m=p(),g={rootId:p(),defaultView:m,error:function(e){throw e}},b=function(e){return"object"==typeof e?e:u.getElementById(e)},y=function(e){return!e||"object"!=typeof e},w=function(e,t,n){var r,i,o,a=0;for(o in e)r=e[o],i=t[o],y(r)&&i===r||(n[o]=1,a=1),t[o]=r;return a},x=function(e,t,n){if(e=b(e),t=b(t),e&&t&&!(n=e==t))try{n=16==(16&t.compareDocumentPosition(e))}catch(e){}return n},k=function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)T(t,i)&&(e[i]=t[i])}return e},I=function(e,t,n){t=[];for(n in e)T(e,n)&&t.push(n);return t},V=g.hasOwnProperty,N=n("head"),S=function(e,t){t&&!S[e]&&(S[e]=1,N.append("<style>"+t))},C=function(e,t,n,r,o){t=t||a,i(e)||(e=[e]),i(t)||(t=[t]);for(var f=0,u=e;f<u.length;f++){o=u[f];try{r=o&&o.apply(n,t)}catch(e){g.error(e)}}return r},T=function(e,t){return e&&V.call(e,t)},j=function(e,t,n){var r,i;for(r in t)i=t[r],n[r]="\x1e"==(i+"")[0]?e[i]:i},U=function(e,t,n){n=t.params,j(e,n,n);try{return d(t)}catch(e){}},q=function(e,t){return t.f-e.f||t.t-e.t},A=function(e,t,n,r){(r=this).c=[],r.b=t||5,r.x=r.b+(e||20),r.r=n};k(A.prototype,{get:function(e){var t=this.c["\x1e"+e];return t&&(t.f++,t.t=o++,t=t.v),t},each:function(e,t,n,r){for(var i=0,o=r=(n=this).c;i<o.length;i++)e(o[i].v,t,n)},set:function(e,t){var n=this.c,r="\x1e"+e,i=n[r],a=this.b;if(!i){if(n.length>=this.x)for(n.sort(q);a--;)(i=n.pop()).f>0&&this.del(i.o);i={o:e},n.push(i),n[r]=i}i.v=t,i.f=1,i.t=o++},del:function(e){e="\x1e"+e;var t=this.c,n=t[e],r=this.r;n&&(n.f=-1,n.v="",delete t[e],r&&C(r,n.o))},has:function(e){return T(this.c,"\x1e"+e)}});var P,E,O=function(t,n){if(t){var r=[],o=void 0;if(m==t)P||(P=$t.extend()),n(P);else if(f.seajs)seajs.use(t,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,o=e;i<o.length;i++){var a=o[i];r.push(a&&a.__esModule&&a.default||a)}n&&n.apply(void 0,r)});else{i(t)||(t=[t]);for(var a=0,u=t;a<u.length;a++)o=u[a],o=e(o),r.push(o&&o.__esModule&&o.default||o);n&&n.apply(void 0,r)}}else n()},H=function(){},M=function(e,t,n,r,i){return H.prototype=t.prototype,i=new H,k(i,n),k(e,r),i.constructor=e,e.prototype=i,e},R=n.find||n.zepto,L=R.matchesSelector||R.matches,Z=function(e,t){t=e.data,e.eventTarget=t.e,C(t.f,e,t.v)},_=function(e,t,r,i,o){o&&(t+="."+o.i),i?n(e).off(t,r):n(e).on(t,o,r)},B=new A,D=function(e,t,n){try{n=decodeURIComponent(n)}catch(e){}E[t]=n},z=function(e){var t,n=B.get(e);return n||(E={},e==(t=e.replace($,""))&&l.test(t)&&(t=""),e.replace(t,"").replace(v,D),B.set(e,n={a:t,b:E})),{path:n.a,params:k({},n.b)}},F=function(e,t,n){var r,i,o,a=[];for(i in t)r=t[i]+"",(!n||r||T(n,i))&&(r=encodeURIComponent(r),a.push(o=i+"="+r));return o&&(e+=(e&&(~e.indexOf("?")?"&":"?"))+a.join("&")),e},J=function(e,t){var n,r={};if(e)for(var i=0,o=e;i<o.length;i++)n=o[i],r[t&&n?n[t]:n]=t?n:1+(0|r[n]);return r},Q={config:function(e,t){return t=g,e&&(t=r(e)?k(t,e):t[e]),t},boot:function(e){k(g,e),O(g.ini,function(t){k(g,t,e),O(g.exts,function(){xe.on("changed",Ue),ne.on("changed",Ue),ge()})})},toMap:J,toTry:C,toUrl:F,parseUrl:z,mix:k,has:T,keys:I,inside:x,node:b,applyStyle:S,guid:p,use:O,Cache:A},X={fire:function(e,t,n,r){var i,o,a,f,u=this,c=u["\x1e"+e];if(t||(t={}),t.type||(t.type=e),c)for(o=(i=c.length)-1;i--;)(f=c[a=r?i:o-i]).f?(f.x=1,C(f.f,t,u),f.x=""):f.x||(c.splice(a,1),o--);(c=u["on"+e])&&C(c,t,u),n&&u.off(e)},on:function(e,t){var n="\x1e"+e;(this[n]||(this[n]=[])).push({f:t})},off:function(e,t){var n,r="\x1e"+e,i=this[r];if(t){if(i)for(var o=0,a=i;o<a.length;o++)if((n=a[o]).f==t){n.f="";break}}else delete this[r],delete this["on"+e]}};Q.Event=X;var G={},K={},W={},Y=0,ee=function(e){for(var t=0,n=e=(e+"").split(",");t<n.length;t++){var r=n[t];T(K,r)?K[r]++:K[r]=1}return e},te=function(e){for(var t,n=0,r=e;n<r.length;n++)t=r[n],T(K,t)&&(--K[t]||(delete K[t],delete G[t]))},ne=k({get:function(e){var t=e?G[e]:G;return t},set:function(e){Y=w(e,G,W)||Y},digest:function(e){e&&ne.set(e),Y&&(Y=0,this.fire("changed",{keys:W}),W={})},diff:function(){return W},clean:function(e){return{ctor:function(){e=ee(e),this.on("destroy",function(){return te(e)})}}}},X);Q.State=ne;var re,ie,oe,ae,fe,ue,ce=new A,se=new A,he=f.location,de=0,$e={query:{},params:{},href:""},ve=/(?:^.*\/\/[^\/]+|#.*$)/gi,le=/^[^#]*#?!?/,pe=function(e){return this.params[e]||""},me=function(e,t){e="#!"+e,t?he.replace(e):he.hash=e},ge=function(){var e,t,n=ye().srcHash;_(f,"hashchange",function(r,i,o){t||(i=ye(),(e=i.srcHash)!=n&&(o=function(){r.p=1,n=e,t="",me(e),we()},r={reject:function(){r.p=1,t="",me(n)},resolve:o,prevent:function(){t=1}},xe.fire("change",r),t||r.p||o()))}),f.onbeforeunload=function(e,t,n){if(e=e||f.event,t={},xe.fire("pageunload",t),n=t.msg)return e&&(e.returnValue=n),n},we()},be=u.title,ye=function(e){e=e||he.href;var t,n,i,o,a,f=ce.get(e);return f||(t=e.replace(ve,""),n=e.replace(le,""),i=z(t),o=z(n),a=k({},i.params,o.params),function(e,t){if(ie||(ie=g.routes||{},oe=g.unmatchView,ae=g.defaultView,fe=g.defaultPath||"/",ue=g.rewrite),!e.view){var n=e.hash.path||0||fe;ue&&(n=ue(n,e.params,ie)),t=ie[n]||oe||ae,e.path=n,e.view=t,r(t)&&k(e,t)}}(f={get:pe,href:e,srcQuery:t,srcHash:n,query:i,hash:o,params:a}),ce.set(e,f)),f},we=function(){var e=ye(),t=function(e,t){var n=e.href,r=n+"\x1e"+t.href,i=se.get(r);if(!i){var o,a;i={params:a={},force:!n};for(var f=e.params,u=t.params,c=function(e){var t=f[e],n=u[e];t!=n&&(a[e]={from:t,to:n},o=1)},s=0,h=I(f).concat(I(u));s<h.length;s++)c(h[s]);f=e,u=t,a=i,c("path"),c("view"),se.set(r,i={a:o,b:i})}return i}($e,$e=e);return!de&&t.a&&((re=t.b).path&&(u.title=e.title||be),xe.fire("changed",re)),de=0,re},xe=k({parse:ye,diff:we,to:function(e,t,n,i){!t&&r(e)&&(t=e,e="");var o=z(e),a=o.params,f=o.path,u=$e.path,c=$e.params,s=$e.query.params;if(k(a,t),f)for(u in s)T(a,u)||(a[u]="");else c&&(f=u,a=k({},c,a));!function(e,t,n,r,i,o){(e=F(e,t,o))!=n.srcHash&&(de=i,me(e,r))}(f,a,$e,n,i,s)}},X);Q.Router=xe;var ke,Ie,Ve=function(e){if(!e.$a&&!e.$b&&e.$cc==e.$rc){e.$cr||(e.$cr=1,e.$ca=0,e.fire("created"));var t=void 0,n=e.id,r=e.pId;(t=Se[r])&&!T(t.$d,n)&&(t.$d[n]=1,t.$rc++,Ve(t))}},Ne=function(e,t){if(!e.$ca&&e.$cr){e.$cr=0,e.$ca=1,e.fire("alter",t);var n=void 0,r=e.id,i=e.pId;(n=Se[i])&&T(n.$d,r)&&(n.$rc--,delete n.$d[r],Ne(n,t))}},Se={},Ce=[],Te=0,je=function(e,t,n){if(e&&e.$f!=Te&&(n=e.$v)&&n.$a>1){(t?function(e,t,n){var r,i=e.$os;if(i)for(var o=0,a=i;o<a.length&&(r=a[o],!(n=T(t,r)));o++);return n}(n,t):dt(n))&&n.$b();for(var r=void 0,i=0,o=e.children();i<o.length;i++)r=o[i],je(Se[r],t)}},Ue=function(e){var n,r=function(e){return ke||(t=u.body,b(e=g.rootId)||(t.id=e),ke=new qe(e)),ke}();(n=e.view)?r.mountView(n.to):(Te=o++,je(r,e.keys))},qe=function(e,t,n){(n=this).id=e,n.$c={},n.$cc=0,n.$rc=0,n.$g=1,n.$d={},n.$e=[],n.pId=t,function(e,t){T(Se,e)||(Se[e]=t,qe.fire("add",{vframe:t}),(e=b(e))&&(e.vframe=t))}(e,n)};k(qe,{all:function(){return Se},get:function(e){return Se[e]}},X),k(qe.prototype,X,{mountView:function(e,t){var n,r,i,o,a,f,u=this,c=u.id,s=u.pId,h=u.$g,d=b(c);!u.$h&&d&&(u.$h=1,u.$i=d.innerHTML),u.unmountView(),u.$a=0,d&&e&&(u.path=e,n=z(e),i=n.path,r=++h,o=n.params,f=(f=(f=(f=Se[s])&&f.$v)&&f.$d)&&f.$a,e.indexOf("\x1e")>0&&j(f,o,o),u.$j=U(f,n),u.$n=n.path,k(o,t),O(i,function(e){if(r==u.$g){if(!e)return g.error(Error("id:"+c+" cannot load:"+i));a=ht(e),i=new e({owner:u,id:c},o,a);u.$v=i,u.$f=Te,ut(i),C(i.init,o,i),i.$b(),i.$e||(u.$h=0,i.$f||i.endUpdate())}}))},unmountView:function(){var e,t,r=this,i=r.$v,o=r.id;r.$e=[],i&&(Ie||(t=1,Ie={id:o}),r.$a=1,r.unmountZone(0,1),Ne(r,Ie),r.$v=0,i.$a>0&&(i.$a=0,i.fire("destroy",0,1,1),at(i,1),ut(i,1),i.owner=0),i.$a--,(e=b(o))&&r.$h&&n(e).html(r.$i),t&&(Ie=0)),r.$g++},mountVframe:function(e,t,n){var r,i=this,o=i.id,a=i.$c;return Ne(i,{id:e}),(r=Se[e])||(T(a,e)||(i.$o=0,i.$cc++),a[e]=e,(r=Ce.pop())?qe.call(r,e,o):r=new qe(e,o)),r.mountView(t,n),r},mountZone:function(e,t){var r,i,o=this,a=[];e=e||o.id;var f=n("#"+e+" [mx-view]");o.$b=1;for(var u=0,c=f;u<c.length;u++)i=(r=c[u]).id||(r.id=p()),r.$m||(r.$m=1,a.push([i,r.getAttribute("mx-view")]));for(var s=0,h=a;s<h.length;s++)i=(d=h[s])[0],r=d[1],a[i]?g.error(Error("vf.id duplicate:"+i+" at "+o.path)):o.mountVframe(a[i]=i,r);o.$b=0,t||Ve(o);var d},unmountVframe:function(e,t){var n;if(e=e?this.$c[e]:this.id,n=Se[e]){var r=n.$cr,i=n.pId;n.unmountView(),function(e,t,n){(n=Se[e])&&(delete Se[e],qe.fire("remove",{vframe:n,fcc:t}),(e=b(e))&&(e.$m=e.vframe=0))}(e,r),n.id=n.pId=n.$c=n.$d=n.$h=0,n.off("alter"),n.off("created"),Ce.push(n),(n=Se[i])&&T(n.$c,e)&&(delete n.$c[e],n.$o=0,n.$cc--,t||Ve(n))}},unmountZone:function(e,t){var n;for(n in this.$c)(!e||n!=e&&x(n,e))&&this.unmountVframe(n,1);t||Ve(this)},parent:function(e,t){for(t=this,e=e>>>0||1;t&&e--;)t=Se[t.pId];return t},children:function(e){return(e=this).$o||(e.$o=I(e.$c))},invoke:function(e,t){var n,r,i,o,a,f=this.$e;return(r=this.$v)&&r.$f?n=(i=r[e])&&C(i,t,r):((o=f[a="\x1e"+e])&&(o.r=t===o.a),o={n:e,a:t,k:a},f.push(o),f[a]=o),n}}),Q.Vframe=qe,n.fn.invokeView=function(e,t){if(this.length){var n=this[0],r=n.vframe;if(void 0===t)return r&&r.invoke(e);for(var i=0;i<this.length;i++)(r=(n=this[i]).vframe)&&r.invoke(e,t)}};var Ae=new A(30,10),Pe=/(?:([\w\-]+)\x1e)?([^(]+)\(([\s\S]*)?\)/,Ee={},Oe={},He=function(e,n){var r,i,o,f,u,c,s,h=[],d=e,$=e.getAttribute("mx-"+n),v=[],l=0;if($&&((u=Ae.get($))||((u={v:(u=$.match(Pe)||a)[1],n:u[2],i:u[3]}).p=u.i&&C(Function("return "+u.i),a,e),Ae.set($,u)),u=k({},u,{r:$}),h.push(u)),u&&!u.v||Oe[n]){if(!(s=e.$a))for(v.push(d);d!=t&&(d=d.parentNode);){if(Se[i=d.id]||(i=d.$v)){s=i;break}v.push(d)}if(s){for(var p=0,m=v;p<m.length;p++)($=m[p]).$a=s;d=e.id,Se[d]&&(l=s=d);do{if((r=Se[s])&&(c=r.$v)){f=(o=c.$so)[n];for(i in f)o={r:i,v:s,n:i},i?L(e,i)&&h.push(o):l&&h.unshift(o);if(c.$e&&!l){u&&!u.v&&(u.v=s);break}l=0}}while(r&&(s=r.pId))}}return h},Me=function(e){for(var n,r,i,o,a,f,u,c,s=e.target,h=e.type,d=[];s!=t;){if((n=He(s,h)).length){d=[];for(var $=0,v=n;$<v.length;$++){var l=v[$],p=l.v,m=(l.r,l.n),g=l.p,b=l.i;if(u!=p){if(u&&e.isPropagationStopped())break;u=p}if(i=Se[p],(o=i&&i.$v)&&(a=m+"\x1e"+h,(f=o[a])&&(e.eventTarget=s,c=g||{},b&&b.indexOf("\x1e")>0&&j(o.$d.$a,c,c={}),e.params=c,C(f,e,o),e.isImmediatePropagationStopped())))break}}if((r=s.$)&&r[h]||e.isPropagationStopped())break;d.push(s),s=s.parentNode||t}for(var y=0,w=d;y<w.length;y++)(r=(s=w[y]).$||(s.$={}))[h]=1},Re=function(e,n,r){var i=0|Ee[e],o=r?-1:1;i&&r!==i||_(t,e,Me,r),Ee[e]=i+o,n&&(Oe[e]=(0|Oe[e])+o)},Le=/\\|'/g,Ze=/\r|\n/g,_e=/<%([@=!])?([\s\S]*?)%>|$/g,Be=new A,De=function(e,t){var n=Be.get(e);return n||(n=function(e){var t=0,n="$p+='";return e.replace(_e,function(r,i,o,a){return n+=e.slice(t,a).replace(Le,"\\$&").replace(Ze,"\\n"),t=a+r.length,"@"==i?n+="';$p+=$i("+o+");$p+='":"="==i?n+="'+$e("+o+")+'":"!"==i?n+="'+$n("+o+")+'":o&&(n+="';"+o+";$p+='"),r}),n+="';",n="var $t,$p='',$em={'&':'amp','<':'lt','>':'gt','\"':'#34','\\'':'#39','`':'#96'},$er=/[&<>\"'`]/g,$n=function(v){return v==null?'':''+v},$ef=function(m){return '&'+$em[m]+';'},$e=function(v){return $n(v).replace($er,$ef)},$i=function(v,k,f){for(f=$$[$g];--f;)if($$[k=$g+f]===v)return k;$$[k=$g+$$[$g]++]=v;return k},$um={'!':'%21','\\'':'%27','(':'%28',')':'%29','*':'%2A'},$uf=function(m){return $um[m]},$uq=/[!')(*]/g,$eu=function(v){return encodeURIComponent($n(v)).replace($uq,$uf)},$qr=/[\\\\'\"]/g,$eq=function(v){return $n(v).replace($qr,'\\\\$&')};"+n+"return $p",Function("$g","$$",n)}(e),Be.set(e,n)),n("\x1e",t)},ze={option:[1,"<select multiple>"],thead:[1,"<table>"],col:[2,"<table><colgroup>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],area:[1,"<map>"],param:[1,"<object>"],all:[0,""]},Fe=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;ze.optgroup=ze.option,ze.tbody=ze.tfoot=ze.colgroup=ze.caption=ze.thead,ze.th=ze.td;var Je=u.implementation.createHTMLDocument(""),Qe=Je.createElement("base");Qe.href=u.location.href,Je.head.appendChild(Qe);var Xe=function(e,t){var n=function(e){return e.id||(e.id=p())}(t);e.$c[n]?e.unmountVframe(n,1):e.unmountZone(n,1)},Ge={INPUT:[{a:"defaultValue",b:"value"},{a:"defaultChecked",b:"checked"},{a:"disabled"},{a:"readonly"}],OPTION:[{a:"selected"}]};Ge.TEXTAREA=Ge.INPUT;var Ke=function(e,t,n,r,i,o){for(var a,f,u,c,s=e.firstChild,h=t.firstChild,d=0,$={};s;)d++,u=(f=s).id,s=s.nextSibling,u&&($[u]=f);for(s=e.firstChild;h;)d--,a=h,h=h.nextSibling,(u=a.id)&&(c=$[u])?(delete $[u],c!==s?e.insertBefore(c,s):s=s.nextSibling,We(c,a,e,n,r,i,o)):s?($[u=s.id]&&delete $[u],f=s,s=s.nextSibling,We(f,a,e,n,r,i,o)):(e.appendChild(a),n.c=1);for(u in $)d--,f=$[u],Xe(r,f),e.removeChild(f),n.c=1;for(;--d>=0;)f=e.lastChild,Xe(r,f),e.removeChild(f),n.c=1},We=function(e,t,n,r,i,o,a){if(e.nodeType===t.nodeType)if(1===e.nodeType)if(e.nodeName===t.nodeName){var f=t.getAttribute("mx-view"),u=t.innerHTML,c=void 0,s=void 0,h=void 0,d=Se[e.id],$=void 0,v=void 0,l=void 0,p=void 0,m=void 0,g=void 0,b=void 0,y=void 0;f&&d?(p=d.$j,$=d.$v,l=(v=z(f)).params,f.indexOf("\x1e")>-1&&j(o,l,l),g=p!=(m=U(o,v)),b=u!=d.$i,y=!$.$e,(!p||y||b||g)&&(d.$n==v.path&&$.$g?(g&&e.setAttribute("mx-view",f),d.$i=u,d.$j=m,d.path=f,m={keys:a,node:t,deep:y,data:g,html:b},C($.$g,[l,m],$)&&$.$b(),s=m.deep):(h=1,s=1,c=1))):(c=1,s=1,h=d),h&&d.unmountVframe(0,1),c&&function(e,t,n,r){var i,o,a,f,u,c,s=e.attributes,h=t.attributes,d=e.nodeName,$=Ge[d];if($)for(var v=0,l=$;v<l.length;v++)e[(u=l[v]).a]!=t[u.a]&&(e[a=u.b||u.a]=t[a]);for(a=s.length;a--;)f=(i=s[a]).namespaceURI,u=i.localName,(o=h.getNamedItemNS(f,u))||r&&"id"==u||s.removeNamedItemNS(f,u);for(a=h.length;a--;)f=(i=h[a]).namespaceURI,u=i.localName,o=s.getNamedItemNS(f,u),(c=r&&"id"==u)&&(d=i.value,i.value=""),o?o.value!==i.value&&(o.value=i.value,c&&n.d.push([o,d])):(h.removeNamedItemNS(f,u),s.setNamedItemNS(i),c&&n.d.push([i,d]))}(e,t,r,h),s&&(r.c=1,Ke(e,t,r,i,o,a))}else Xe(i,e),n.replaceChild(t,e),r.c=1;else e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue,r.c=1);else Xe(i,e),n.replaceChild(t,e),r.c=1},Ye=/\d+\x1d/g,et=function(e,t,n,r){var i,o,a,f=e.$b,u=Se[f],s=u&&u.$v,h={d:[]},d=b(f);if(s&&s.$a>0&&(i=s.$e)){if(!i["\x1e"]){i["\x1e"]=1;var $=function(e){return $[e].tmpl},v=void 0,l=i.subs;if(l){for(a=l.length;a--;)(v=l[a]).s&&($[v.s]=v,v.tmpl=v.tmpl.replace(Ye,$));i.html=i.html.replace(Ye,$)}}if(n){o=it(De(i.html,t),f),Ke(d,function(e){var t=Je.createElement("div"),n=(Fe.exec(e)||[0,""])[1].toLowerCase(),r=ze[n]||ze.all;t.innerHTML=r[1]+e;for(var i=r[0];i--;)t=t.lastChild;return t}(o),h,u,t,r);for(var p=0,m=h.d;p<m.length;p++)(a=m[p])[0].value=a[1];h.c&&(s.endUpdate(f),c.trigger({type:"htmlchanged",vId:f}))}s.fire("domready")}},tt=function(e){this.$b=e,this.$c=1,this.$a=(t={vId:e},t["\x1e"]=1,t),this.$k={};var t};k(tt.prototype,{get:function(e,t){return t=this.$a,e&&(t=t[e]),t},set:function(e){var t=this,n=t.$a,r=t.$k;return e&&(t.$c=w(e,n,r)||t.$c),t},digest:function(e,t,n){var r=this;return r.set(e),e=r.$a,t=r.$k,n=r.$c,r.$c=0,r.$k={},et(r,e,n,t),r},snapshot:function(){return this.$d=d(this.$a),this},altered:function(){if(this.$d)return this.$d!=d(this.$a)}});var nt=/^(\$?)([^<]*)<([^>]+)>$/,rt=/\x1f/g,it=function(e,t){return(e+"").replace(rt,t)},ot=function(e,t,n){return e.$h?n=e:((n=function(e){C(n.$h,e,this)}).$h=[e],n.$i=1),n.$h=n.$h.concat(t.$h||t),n},at=function(e,t){var n,r,i=e.$r;for(n in i)r=i[n],(t||r.x)&&ft(i,n,1)},ft=function(e,t,n,r){var i,o,f=e[t];return f&&f!=r&&((i=(o=f.e).destroy)&&n&&C(i,a,o),delete e[t]),o},ut=function(e,t){var n,r=e.$eo,i=e.$so,o=e.$el,a=e.id;for(n in r)Re(n,i[n],t);for(var f=0,u=o;f<u.length;f++)n=u[f],_(n.e,n.n,Z,t,{i:a,v:e,f:n.f,e:n.e})},ct=[],st={win:f,doc:u},ht=function(e){if(!e["\x1e"]){e["\x1e"]=[];var t=e.prototype,n=void 0,r=void 0,i=void 0,o=void 0,a={},f=[],u={},c=void 0,s=void 0,h=void 0,d=void 0,$=void 0,v={};if(r=t.mixins){for(var l=0,p=r;l<p.length;l++){c=p[l];for(h in c)n=c[h],i=v[h],"ctor"!=h?(nt.test(h)&&(i?n=ot(i,n):n.$i=1),v[h]=n):e["\x1e"].push(n)}for(h in v)T(t,h)||(t[h]=v[h])}for(h in t)if(n=t[h],r=h.match(nt)){s=r[1],i=r[2];for(var m=0,g=o=(o=r[3]).split(",");m<g.length;m++){if(d=g[m],c=st[i],$=1,s){if(c){f.push({f:n,e:c,n:d});continue}$=2,(c=u[d])||(c=u[d]={}),c[i]=1}a[d]=a[d]|$,(c=t[d=i+"\x1e"+d])?c.$i&&(n.$i?t[d]=ot(c,n):T(t,h)&&(t[d]=n)):t[d]=n}}!function(e,t,n,r,i){r=e[t],e[t]=e[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(i=this).$a>0&&(i.$a++,i.fire("rendercall"),at(i),C(r,e,i))}}(t,"render","$b"),t.$eo=a,t.$el=f,t.$so=u,t.$e=t.tmpl,t.$g=t.assign}return e["\x1e"]},dt=function(e){var t,n,r,i=e.$l;if(i.f&&(i.p&&(t=re.path),!t&&i.k)){r=re.params;for(var o=0,a=i.k;o<a.length&&(n=a[o],!(t=T(r,n)));o++);}return t},$t=function(e,t){k(t=this,e),t.$l={k:[]},t.$r={},t.$a=1,t.updater=t.$d=new tt(t.id),C(ct,e,t)},vt=$t.prototype;k($t,{merge:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,r,i=0,o=e;i<o.length;i++)(r=(n=o[i])&&n.ctor)&&ct.push(r),k(vt,n)},extend:function(e,t){var n=this,r=(e=e||{}).ctor,i=[];r&&i.push(r);var o=function(e,t,r){n.call(this,e,t),C(i.concat(r),t,this)};return o.extend=n.extend,M(o,n,e,t)}}),k(vt,X,{init:h,wrapEvent:function(e){return it(e,this.id)},beginUpdate:function(e,t){(t=this).$a>0&&t.$f&&t.owner.unmountZone(e,1)},endUpdate:function(e,t,n,r,i){(n=this).$a>0&&(e=e||n.id,t?i=t:(i=n.$f,n.$f=1),(r=n.owner).mountZone(e,t),i||s(n.wrapAsync(function(){!function(e,t,n){for(t=e.$e;t.length;)(n=t.shift()).r||e.invoke(n.n,n.a),delete t[n.k]}(r)}),0))},wrapAsync:function(e,t){var n=this,r=n.$a;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(r>0&&r==n.$a)return e.apply(t||n,i)}},observeLocation:function(e,t){var n;(n=this.$l).f=1,r(e)&&(t=e.path,e=e.params),n.p=t,e&&(n.k=(e+"").split(","))},observeState:function(e){this.$os=(e+"").split(",")},capture:function(e,t,n,r){return r=this.$r,t?(ft(r,e,1,t),r[e]={e:t,x:n}):t=(r=r[e])&&r.e,t},release:function(e,t){return ft(this.$r,e,t)},leaveTip:function(e,t){var n=this,r=function(i){var o="a",a="b";"change"!=i.type&&(o="b",a="a"),r[o]?(i.prevent(),i.reject()):t()?(i.prevent(),r[a]=1,n.leaveConfirm(e,function(){r[a]=0,i.resolve()},function(){r[a]=0,i.reject()})):i.resolve()},i=function(n){t()&&(n.msg=e)};xe.on("change",r),xe.on("pageunload",i),n.on("unload",r),n.on("destroy",function(){xe.off("change",r),xe.off("pageunload",i)})},render:h}),Q.View=$t;var lt=n.type,pt=n.now||Date.now,mt=function(){this.id=p("b"),this.$={}};k(mt.prototype,{get:function(e,t,n){var r=t!=n,o=this.$;if(e){for(var a=i(e)?e.slice():(e+"").split("."),f=void 0;(f=a.shift())&&o;)o=o[f];f&&(o=n)}return r&&lt(t)!=lt(o)&&(o=t),o},set:function(e,t){r(e)||((n={})[e]=t,e=n),k(this.$,e);var n}});var gt=function(e,t,n){(n=this[e])&&(delete this[e],C(n,t,n.e))},bt=function(e,t,n,r,o){if(e.$d)return e;if(e.$e)return e.enqueue(bt.bind(e,e,t,n,r,o));e.$e=1,i(t)||(t=[t]);for(var a=e.constructor,f=0,u=a.$f,c=function(e,t,n,r,i,o){var a=[],f=0,u=0;return function(c,s){var h;u++;var d=this.$b,$=d.k;a[c+1]=this;var v,l={bag:this,error:s};if(s?(f=s,t.fire("fail",l),h=1):o.has($)||($&&o.set($,this),d.t=pt(),(v=d.a)&&C(v,this,this),(v=d.x)&&t.clear(v),t.fire("done",l),h=1),!n.$d){var p=u==r;p&&(n.$e=0,2==i&&(a[0]=f,C(e,a,n))),1==i&&C(e,[s||null,this,p,c],n)}h&&t.fire("end",l)}}(n,a,e,t.length,r,a.$c),s=0,h=t;s<h.length;s++){var d=h[s];if(d){var $=a.get(d,o),v=$.e,l=v.$b.k,p=c.bind(v,f++),m=void 0;l&&u[l]?u[l].push(p):$.u?(l&&((m=[p]).e=v,u[l]=m,p=gt.bind(u,l)),a.$s(v,p)):p()}}return e},yt=function(){var e=this;e.id=p("s"),e.$g=[]};k(yt.prototype,{all:function(e,t){return bt(this,e,t,2)},save:function(e,t){return bt(this,e,t,2,1)},one:function(e,t){return bt(this,e,t,1)},enqueue:function(e){var t=this;return t.$d||(t.$g.push(e),t.dequeue(t.$h)),t},dequeue:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=this;r.$e||r.$d||(r.$e=1,s(function(){r.$e=0,r.$d||(n=r.$g.shift())&&C(n,r.$h=e)},0))},destroy:function(e){(e=this).$d=1,e.$g=0}});var wt=function(e,t){return[d(t),d(e)].join("\x1e")},xt=function(e,t,n,r){(r=e&&e.$b)&&t[r.n]&&n.del(r.k)},kt=k({add:function(e){var t,n=this.$b;i(e)||(e=[e]);for(var r=0,o=e;r<o.length;r++)if(t=o[r]){var a=t.name,f=t.cache;t.cache=0|f,n[a]=t}},create:function(e){var t=this.meta(e),n=0|e.cache||t.cache,i=new mt;i.set(t),i.$b={n:t.name,a:t.after,x:t.cleans,k:n&&wt(t,e)},r(e)&&i.set(e);var o=t.before;return o&&C(o,i,i),this.fire("begin",{bag:i}),i},meta:function(e){return this.$b[e.name||e]||e},get:function(e,t){var n,r;return t||(n=this.cached(e)),n||(n=this.create(e),r=1),{e:n,u:r}},clear:function(e){this.$c.each(xt,J((e+"").split(",")))},cached:function(e){var t,n,r=this.$c,i=this.meta(e),o=0|e.cache||i.cache;if(o&&(n=wt(i,e)),n){var a=this.$f[n];a?t=a.e:(t=r.get(n))&&pt()-t.$b.t>o&&(r.del(n),t=0)}return t}},X);return yt.extend=function(e,t,n){var r=function(){yt.call(this)};return r.$s=e,r.$c=new A(t,n),r.$f={},r.$b={},M(r,yt,null,kt)},Q.Service=yt,k(h.prototype,X),h.extend=function e(t,n){var r=this,i=t&&t.ctor,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.apply(this,e),i&&i.apply(this,e)};return o.extend=e,M(o,r,t,n)},Q.Base=h,Q.default=Q,Q});