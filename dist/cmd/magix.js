/*Magix Licensed MIT*/define("magix",["$"],function(n){var t,r=n("$"),e=function(){},i=function(n,t,r,i,o){return e[y]=t[y],o=new e,k(o,r),k(n,i),o.constructor=n,n[y]=o,n},o=function(t,r){if(t){var e=[];c(t)||(t=[t]);for(var i=0;i<t.length;i++)e.push(n(t[i]));r&&r.apply(l,e)}},f=r.isPlainObject,c=r.isArray,u=function(n,t){return 1 in arguments?r(n).html(t):t=r(n).html(),t},a=0,s="",$=[],d=$.slice,h=function(){},p=",",l=null,m=window,v=document,g="",w="object",y="prototype",b=/[#?].*$/,x=/([^=&?\/#]+)=?([^&#?]*)/g,V=/(?!^)=|&/,I=function(n){return(n||"mx_")+a++},U={rootId:I(),error:function(n){throw n}},Z=U.hasOwnProperty,A=function(n){return typeof n==w?n:v.getElementById(n)},j=function(n,t,r){if(n=A(n),t=A(t),n&&t&&(r=n==t,!r))try{r=t.contains?t.contains(n):16&t.compareDocumentPosition(n)}catch(e){}return r},k=function(n,t,r){for(r in t)n[r]=t[r];return n},C=function(n,t,r,e,i,o){for(c(n)||(n=[n]),c(t)||(t=[t]),e=0;o=n[e];e++)try{i=o&&o.apply(r,t)}catch(f){U.error(f)}return i},E=function(n,t){return n&&Z.call(n,t)},O=function(n,t){return t.f-n.f||t.t-n.t},P=function(n,t,r,e){e=this,e.c=[],e.b=0|t||5,e.x=e.b+(n||20),e.r=r};k(P[y],{get:function(n){var t=this,r=t.c,e=r[g+n];return e&&(e.f++,e.t=a++,e=e.v),e},set:function(n,t){var r=this,e=r.c,i=g+n,o=e[i],f=r.b;if(!o){if(e.length>=r.x)for(e.sort(O);f--;)o=e.pop(),o.f>0&&r.del(o.o);o={o:n},e.push(o),e[i]=o}o.v=t,o.f=1,o.t=a++},del:function(n){n=g+n;var t=this.c,r=t[n],e=this.r;r&&(r.f=-1,r.v=s,delete t[n],e&&C(e,r.o,r))},has:function(n){return E(this.c,g+n)}});var T,M=new P,R=function(n,t,r){try{r=decodeURIComponent(r)}catch(e){}T[t]=r},B=function(n){var t,r=M.get(n);return r||(T={},t=n.replace(b,s),n==t&&V.test(t)&&(t=s),n.replace(t,s).replace(x,R),M.set(n,r={a:t,b:T})),{path:r.a,params:k({},r.b)}},D=function(n,t,r){var e,i,o,f=[];for(i in t)e=t[i]+s,(!r||e||E(r,i))&&(e=encodeURIComponent(e),f.push(o=i+"="+e));return o&&(n+=(n&&(~n.indexOf("?")?"&":"?"))+f.join("&")),n},F=function(n,t){var r,e,i,o={};if(n&&(i=n.length))for(r=0;i>r;r++)e=n[r],o[t?e[t]:e]=t?e:(0|o[e])+1;return o},H={config:function(n,t){return t=U,n&&(t=f(n)?k(t,n):t[n]),t},boot:function(n){k(U,n),o(U.exts,function(){J().mountView(U.defaultView)})},toMap:F,toTry:C,toUrl:D,parseUrl:B,mix:k,has:E,inside:j,node:A,guid:I,Cache:P},L="on",N={fire:function(n,t,r,e){var i,o,f,c,u=g+n,a=this,s=a[u];if(t||(t={}),t.type||(t.type=n),s)for(i=s.length,o=i-1;i--;)f=e?i:o-i,c=s[f],c.d?(s.splice(f,1),o--):C(c.f,t,a);s=a[L+n],s&&C(s,t,a),r&&a.off(n)},on:function(n,t){var r=this,e=g+n,i=r[e]||(r[e]=[]);i.push({f:t})},off:function(n,t){var r,e,i=g+n,o=this,f=o[i];if(t){if(f)for(r=f.length;r--;)if(e=f[r],e.f==t&&!e.d){e.d=1;break}}else delete o[i],delete o[L+n]}};H.Event=N;var S,_,q=r,z=function(n,t,r){n.$d||n.$h||n.$cc!=n.$rc||(n.$cr||(n.$cr=1,n.$ca=0,n.fire("created")),t=n.id,r=K[n.pId],r&&!E(r.$r,t)&&(r.$r[t]=1,r.$rc++,z(r)))},G=function(n,t,r,e){t||(t={}),!n.$ca&&n.$cr&&(n.$cr=0,n.$ca=1,n.fire("alter",t),r=n.id,e=K[n.pId],e&&E(e.$r,r)&&(e.$rc--,delete e.$r[r],G(e,t)))},J=function(n,r){return S||(t=v.body,n=U.rootId,r=A(n),r||(t.id=n),S=new X(n)),S},K={},Q=function(n,t){E(K,n)||(K[n]=t,X.fire("add",{vframe:t}))},W=function(n,t,r){r=K[n],r&&(delete K[n],X.fire("remove",{vframe:r,fcc:t}))},X=function(n,t,r){r=this,r.id=n,r.$c={},r.$cc=0,r.$rc=0,r.$s=1,r.$r={},r.pId=t,Q(n,r)};k(X,k({root:J,all:function(){return K},get:function(n){return K[n]}},N)),k(k(X[y],N),{mountView:function(n,t){var r,e,i,f=this,c=A(f.id);!f.$a&&c&&(f.$a=1,f.$t=u(c)),f.unmountView(),f.$d=0,c&&n&&(f.path=n,r=B(n),e=++f.$s,o(r.path,function(n){e==f.$s&&(hn(n),i=new n({owner:f,id:f.id},k(r.params,t)),f.$v=i,an(i),i.render())}))},unmountView:function(){var n,t,r=this,e=r.$v;e&&(_||(t=1,_={id:r.id}),r.$d=1,r.unmountZone(0,1),G(r,_),r.$v=0,pn(e),n=A(r.id),n&&r.$a&&u(n,r.$t),t&&(_=0)),r.$s++},mountVframe:function(n,t,r){var e,i=this;return G(i),e=K[n],e||(E(i.$c,n)||i.$cc++,i.$c[n]=n,e=new X(n,i.id)),e.mountView(t,r),e},mountZone:function(n,t){var r,e,i,o=this;n=n||o.id;var f=q("#"+n+" [mx-view]");for(o.$h=1,o.unmountZone(n,1),r=f.length-1;r>=0;r--)e=f[r],i=e.id||(e.id=I()),o.mountVframe(i,e.getAttribute("mx-view"),t);o.$h=0,z(o)},unmountVframe:function(n,t){var r,e,i,o=this;n=n?o.$c[n]:o.id,r=K[n],r&&(e=r.$cr,i=r.pId,r.unmountView(),W(n,e),r.id=r.pId=s,r=K[i],r&&E(r.$c,n)&&(delete r.$c[n],r.$cc--,t||z(r)))},unmountZone:function(n,t){var r,e=this,i=e.$c;for(r in i)(!n||r!=n&&j(r,n))&&e.unmountVframe(r,1);t||z(e)}}),H.Vframe=X;var Y=function(n,t){t=n.data,C(t.f,n,t.v)},nn=function(n,t,e,i,o){r(n)[i?"off":L](t,o,e)},tn="parentNode",rn=new P(30,10),en=/([^\(]+)\(([\s\S]*)?\)/,on={},fn=function(n){for(var r,e,i,o,f,c,u,a,s,d,h=n.target,p=n.type,l="mx-"+p,m=[];h!=t&&1==h.nodeType;){if(r=h.getAttribute(l)){if(m=[],f=h.$f,!f)for(c=h;c=c[tn];)if(E(K,u=c.id)){h.$f=f=u;break}f?(i=K[f],o=i&&i.$v,o&&o.$s>0&&(a=rn.get(r),a||(a=r.match(en)||$,a={n:a[1],i:a[2]},a.p=a.i&&C(Function("return "+a.i))||{},rn.set(r,a)),s=a.n+g+p,d=o[s],d&&(n.current=h,n.params=a.p,C(d,n,o),n.previous=h))):U.error(Error("bad:"+r))}if((e=h.$)&&e[p])break;m.push(h),h=h[tn]||t}for(;h=m.pop();)e=h.$||(h.$={}),e[p]=1},cn=function(n,r){var e=0|on[n],i=e>0?1:0;e+=r?-i:i,e||(nn(t,n,fn,r),r||(e=1)),on[n]=e},un=/^([^<>]+)<([^<>]+)>$/,an=function(n,t){var r,e,i=n.$eo;for(r in i)cn(r,t);for(i=n.$el,r=i.length;r--;)e=i[r],nn(e.h,e.t,Y,t,{v:n,f:e.f})},sn=[],$n={$win:m,$doc:v},dn=function(n,t,r){t=n.render,n.render=function(){r=this,r.$s>0&&(r.$s++,r.fire("rendercall"),C(t,d.call(arguments),r))}},hn=function(n){if(!n[g]){n[g]=1;var t,r,e,i,o,f,c=n[y],u={},a=[];for(f in c)if(t=c[f],r=f.match(un))for(e=r[1],i=r[2],i=i.split(p);r=i.pop();)o=$n[e],o?a.push({f:t,t:r,h:o}):(u[r]=1,c[e+g+r]=t);dn(c),c.$eo=u,c.$el=a}},pn=function(n){n.$s>0&&(n.$s=0,n.fire("destroy",0,1,1),an(n,1)),n.$s--},ln=function(n,t){t=this,k(t,n),t.$s=1,C(sn,n,t)},mn=ln[y];return k(ln,{merge:function(n,t){t=n&&n.ctor,t&&sn.push(t),k(mn,n)},extend:function(n,t){var r=this;n=n||{};var e=n.ctor,o=function(n,t){r.call(this,n,t),e&&e.call(this,t)};return o.extend=r.extend,i(o,r,n,t)}}),k(k(mn,N),{render:h,beginUpdate:function(n,t){t=this,t.$s>0&&t.$p&&t.owner.unmountZone(n,1)},endUpdate:function(n,t,r){t=this,t.$s>0&&(t.$p=1,r=t.owner,r.mountZone(n))},wrapAsync:function(n,t){var r=this,e=r.$s;return function(){e>0&&e==r.$s&&n&&n.apply(t||r,arguments)}},setHTML:function(n,t){var r,e=this;e.beginUpdate(n),e.$s>0&&(r=A(n),r&&u(r,t)),e.endUpdate(n)}}),H.View=ln,H});