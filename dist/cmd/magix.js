/*!3.8.3 MIT kooboy_li@163.com*/define("magix",["$"],e=>{let t,r,i=e("$"),n=i.isPlainObject,o=i.isArray,f=0,a="",s=[],l=",",$=window,h=document,d=i(h),c=$.setTimeout,u="changed",p="change",m="pageunload",g="value",b=function(){},v=JSON.stringify,w="\x1e",y="object",x="prototype",k="params",V="path",I="mx-view",j=/[#?].*$/,S=/([^=&?\/#]+)=?([^&#?]*)/g,A=/(?!^)=|&/,O=e=>(e||"mx_")+f++,T=O(),C={rootId:O(),defaultView:T,error(e){throw e}},U=e=>typeof e==y?e:h.getElementById(e),P=e=>!e||typeof e!=y,Z=(e,t,r)=>{if(e=U(e),t=U(t),e&&t&&!(r=e==t))try{r=16==(16&t.compareDocumentPosition(e))}catch(e){}return r},{assign:q,keys:E,hasOwnProperty:H}=Object,N=i("head"),_=(e,t)=>{t&&!_[e]&&(_[e]=1,N.append(`<style>${t}`))},M=e=>e.id||(e.$a=1,e.id=O()),z=(e,t,r,i,n)=>{t=t||s,o(e)||(e=[e]),o(t)||(t=[t]);for(n of e)try{i=n&&n.apply(r,t)}catch(e){C.error(e)}return i},L=(e,t)=>e&&H.call(e,t),B=(e,t,r)=>{let i,n;for(i in t)n=t[i],r[i]=(n+a)[0]==w?e[n]:n},R=(e,t)=>t.f-e.f||t.t-e.t,D=function(e,t,r,i){(i=this).c=[],i.b=t||5,i.x=i.b+(e||20),i.r=r};q(D[x],{get(e){let t=this.c[w+e];return t&&(t.f++,t.t=f++,t=t.v),t},each(e,t,r,i,n){i=(r=this).c;for(n of i)e(n.v,t,r)},set(e,t){let r=this,i=r.c,n=w+e,o=i[n],a=r.b;if(!o){if(i.length>=r.x)for(i.sort(R);a--;)(o=i.pop()).f>0&&r.del(o.o);o={o:e},i.push(o),i[n]=o}o.v=t,o.f=1,o.t=f++},del(e){e=w+e;let t=this.c,r=t[e],i=this.r;r&&(r.f=-1,r.v=a,delete t[e],i&&z(i,r.o))},has(e){return L(this.c,w+e)}});let F=(e,t)=>{if(e){let i,n=[];if(T==e)r||(r=Tt.extend()),t(r);else if($.seajs)seajs.use(e,(...e)=>{for(let t of e)n.push(t&&t.__esModule&&t.default||t);t&&t(...n)});else{o(e)||(e=[e]);for(i of e)i=n(i),n.push(i&&i.__esModule&&i.default||i);t&&t(...n)}}else t()},J=function(){},Q=(e,t,r,i,n)=>(J[x]=t[x],n=new J,q(n,r),q(e,i),n.constructor=e,e[x]=n,e),W=i.find||i.zepto,G=W.matchesSelector||W.matches,K=(e,t)=>{t=e.data,e.eventTarget=t.e,z(t.f,e,t.v)},X=(e,t,r,n,o)=>{o&&(t+=`.${o.i}`),n?i(e).off(t,r):i(e).on(t,o,r)};let Y,ee=new D,te=0,re=(e,t,r)=>{try{r=decodeURIComponent(r)}catch(e){}Y[t]=r},ie=e=>{let t,r=ee.get(e);return r||(Y={},e==(t=e.replace(j,a))&&A.test(t)&&(t=a),e.replace(t,a).replace(S,re),ee.set(e,r={a:t,b:Y})),{path:r.a,params:{...r.b}}},ne=(e,t,r)=>{let i,n,o,f=[];for(n in t)i=t[n]+a,(!r||i||L(r,n))&&(i=encodeURIComponent(i),f.push(o=n+"="+i));return o&&(e+=(e&&(~e.indexOf("?")?"&":"?"))+f.join("&")),e},oe=(e,t)=>{let r,i={};if(e)for(r of e)i[t&&r?r[t]:r]=t?r:1+(0|i[r]);return i},fe={config:(e,t)=>(t=C,e&&(t=n(e)?q(t,e):t[e]),t),boot(e){q(C,e),F(C.ini,t=>{q(C,t,e),F(C.exts,()=>{He.on(u,De),ue.on(u,De),te=1,Pe()})})},toMap:oe,toTry:z,toUrl:ne,parseUrl:ie,mix:q,has:L,keys:E,inside:Z,node:U,applyStyle:_,guid:O,use:F,Cache:D,nodeId:M},ae={fire(e,t,r,i){let n,o,f,s,l=this,$=l[w+e];if(t||(t={}),t.type||(t.type=e),$)for(o=(n=$.length)-1;n--;)(s=$[f=i?n:o-n]).f?(s.x=1,z(s.f,t,l),s.x=a):s.x||($.splice(f,1),o--);($=l[`on${e}`])&&z($,t,l),r&&l.off(e)},on(e,t){let r=w+e;(this[r]||(this[r]=[])).push({f:t})},off(e,t){let r,i=w+e,n=this,o=n[i];if(t){if(o)for(r of o)if(r.f==t){r.f=a;break}}else delete n[i],delete n[`on${e}`]}};fe.Event=ae;let se={},le={},$e={},he=0,de=e=>{e=(e+a).split(",");for(let t of e)L(le,t)?le[t]++:le[t]=1;return e},ce=e=>{let t,r;for(t of e)L(le,t)&&((r=--le[t])||(delete le[t],delete se[t]))};let ue={get(e){let t=e?se[e]:se;return t},set(e){he=((e,t,r)=>{let i,n,o,f=0;for(o in e)i=e[o],n=t[o],P(i)&&n===i||(r[o]=1,f=1),t[o]=i;return f})(e,se,$e)||he},digest(e){e&&ue.set(e),he&&(he=0,this.fire(u,{keys:$e}),$e={})},diff:()=>$e,clean:e=>({ctor(){e=de(e),this.on("destroy",()=>ce(e))}}),...ae};fe.State=ue;let pe,me,ge,be,ve,we,ye,xe,ke="view",Ve=new D,Ie=new D,je=$.location,Se=0,Ae={query:{},params:{},href:a},Oe=/(?:^.*\/\/[^\/]+|#.*$)/gi,Te=/^[^#]*#?!?/,Ce=function(e){return this[k][e]||a},Ue=(e,t)=>{e=`#!${e}`,t?je.replace(e):je.hash=e},Pe=()=>{let e,t,r=qe().srcHash;X($,"hashchange",(i,n,o)=>{t||(n=qe(),(e=n.srcHash)!=r&&(o=(()=>{i.p=1,r=e,t=a,Ue(e),Ee()}),i={reject(){i.p=1,t=a,Ue(r)},resolve:o,prevent(){t=1}},He.fire(p,i),t||i.p||o()))}),$.onbeforeunload=((e,t,r)=>{if(e=e||$.event,t={},He.fire(m,t),r=t.msg)return e&&(e.returnValue=r),r}),Ee()},Ze=h.title,qe=e=>{e=e||je.href;let t,r,i,o,f,s=Ve.get(e);return s||(t=e.replace(Oe,a),r=e.replace(Te,a),i=ie(t),o=ie(r),f={...i[k],...o[k]},s={get:Ce,href:e,srcQuery:t,srcHash:r,query:i,hash:o,params:f},te&&(((e,t)=>{if(me||(me=C.routes||{},ge=C.unmatchView,be=C.defaultView,ve=C.defaultPath||"/",we=C.rewrite),!e[ke]){let r=e.hash[V]||ve;we&&(r=we(r,e[k],me)),t=me[r]||ge||be,e[V]=r,e[ke]=t,n(t)&&q(e,t)}})(s),Ve.set(e,s))),s},Ee=()=>{let e=qe(),t=((e,t)=>{let r=e.href,i=t.href,n=r+w+i,o=Ie.get(n);if(!o){let i,f;o={params:f={},force:!r};let a,s=e[k],l=t[k],$=E(s).concat(E(l)),h=e=>{let t=s[e],r=l[e];t!=r&&(f[e]={from:t,to:r},i=1)};for(a of $)h(a);s=e,l=t,f=o,h(V),h(ke),Ie.set(n,o={a:i,b:o})}return o})(Ae,Ae=e);return!Se&&t.a&&((pe=t.b)[V]&&(h.title=e.title||Ze),He.fire(u,pe)),Se=0,pe},He={parse:qe,diff:Ee,to(e,t,r,i){!t&&n(e)&&(t=e,e=a);let o=ie(e),f=o[k],s=o[V],l=Ae[V],$=Ae[k],h=Ae.query[k];if(q(f,t),s)for(l in h)L(f,l)||(f[l]=a);else $&&(s=l,f={...$,...f});var d,c,u,p;c=Ae,u=r,p=i,(d=ne(d=s,f,h))!=c.srcHash&&(Se=p,Ue(d,u))},...ae};fe.Router=He;let Ne=e=>{if(!e.$a&&!e.$b&&e.$cc==e.$rc){e.$cr||(e.$cr=1,e.$ca=0,e.fire("created"));let t,{id:r,pId:i}=e;(t=Me[i])&&!L(t.$d,r)&&(t.$d[r]=1,t.$rc++,Ne(t))}},_e=(e,t)=>{if(!e.$ca&&e.$cr){e.$cr=0,e.$ca=1,e.fire("alter",t);let r,{id:i,pId:n}=e;(r=Me[n])&&L(r.$d,i)&&(r.$rc--,delete r.$d[i],_e(r,t))}},Me={},ze=(e,t,r)=>{for(t=e.$e;t.length;)(r=t.shift()).r||e.invoke(r.n,r.a),delete t[r.k]},Le=[],Be=0,Re=(e,t,r)=>{if(e&&e.$f!=Be&&(r=e.$v)&&r.$a>1){(t?((e,t,r)=>{let i,n=e.$os;if(n)for(i of n)if(r=L(t,i))break;return r})(r,t):Ot(r))&&r.$b();let i,n=e.children();for(i of n)Re(Me[i],t)}},De=e=>{let r,i=(e=>(ye||(t=h.body,e=C.rootId,U(e)||(t.id=e),ye=new Fe(e)),ye))();(r=e[ke])?i.mountView(r.to):(Be=f++,Re(i,e.keys))},Fe=function(e,t,r){var i,n;(r=this).id=e,r.$c={},r.$cc=0,r.$rc=0,r.$g=1,r.$d={},r.$e=[],r.pId=t,n=r,L(Me,i=e)||(Me[i]=n,Fe.fire("add",{vframe:n}),(i=U(i))&&(i.vframe=n))};q(Fe,{all:()=>Me,get:e=>Me[e]},ae),q(Fe[x],ae,{mountView(e,t){let r,i,n,o,f,a,s=this,{id:l,pId:$,$g:h}=s,d=U(l);!s.$h&&d&&(s.$h=1,s.$i=d.innerHTML),s.unmountView(),s.$a=0,d&&e&&(s[V]=e,r=ie(e),n=r[V],i=++h,o=r[k],a=(a=(a=(a=Me[$])&&a.$v)&&a.$d)&&a.$a,e.indexOf(w)>0&&B(a,o,o),s.$n=r[V],q(o,t),F(n,e=>{if(i==s.$g){if(!e)return C.error(Error(`id:${l} cannot load:${n}`));f=At(e),n=new e(l,s,o,f),s.$v=n,s.$f=Be,It(n),z(n.init,o,n),n.$b(),n.$e||(s.$h=0,n.$f||n.endUpdate())}}))},unmountView(){let e,t,r=this,{$v:n,id:o}=r;r.$e=[],n&&(xe||(t=1,xe={id:o}),r.$a=1,r.unmountZone(0,1),_e(r,xe),r.$v=0,n.$a>0&&(n.$a=0,n.fire("destroy",0,1,1),xt(n,1),It(n,1),n.owner=0),n.$a--,(e=U(o))&&r.$h&&i(e).html(r.$i),t&&(xe=0)),r.$g++},mountVframe(e,t,r){let i,n=this,o=n.id,f=n.$c;return _e(n,{id:e}),(i=Me[e])||(L(f,e)||(n.$o=0,n.$cc++),f[e]=e,(i=Le.pop())?Fe.call(i,e,o):i=new Fe(e,o)),i.mountView(t,r),i},mountZone(e,t){let r,n,o=this,f=[];e=e||o.id;let a=i(`#${e} [${I}]`);o.$b=1;for(r of a)n=M(r),r.$b||(r.$b=1,f.push([n,r.getAttribute(I)]));for([n,r]of f)f[n]?C.error(Error(`vf.id duplicate:${n} at ${o[V]}`)):o.mountVframe(f[n]=n,r);o.$b=0,t||Ne(o)},unmountVframe(e,t){let r;if(e=e?this.$c[e]:this.id,r=Me[e]){let{$cr:f,pId:a}=r;r.unmountView(),n=f,(o=Me[i=e])&&(delete Me[i],Fe.fire("remove",{vframe:o,fcc:n}),(i=U(i))&&(i.$b=0),i&&(i.vframe=0),i&&(i.$d=0)),r.id=r.pId=r.$c=r.$d=0,r.$h=0,r.off("alter"),r.off("created"),Le.push(r),(r=Me[a])&&L(r.$c,e)&&(delete r.$c[e],r.$o=0,r.$cc--,t||Ne(r))}var i,n,o},unmountZone(e,t){let r,i=this;for(r in i.$c)(!e||r!=e&&Z(r,e))&&i.unmountVframe(r,1);t||Ne(i)},parent(e,t){for(t=this,e=e>>>0||1;t&&e--;)t=Me[t.pId];return t},children(e){return(e=this).$o||(e.$o=E(e.$c))},invoke(e,t){let r,i,n,o,f,a=this.$e;return(i=this.$v)&&i.$f?r=(n=i[e])&&z(n,t,i):((o=a[f=w+e])&&(o.r=t===o.a),o={n:e,a:t,k:f},a.push(o),a[f]=o),r}}),fe.Vframe=Fe,i.fn.invokeView=function(e,t){if(this.length){let r=this[0],i=r.vframe;if(void 0===t)return i&&i.invoke(e);for(r of this)(i=r.vframe)&&i.invoke(e,t)}};let Je=new D(30,10),Qe=/(?:([\w\-]+)\x1e)?([^(]+)\(([\s\S]*)?\)/,We={},Ge={},Ke=(e,r)=>{let i,n,o,f,a,l,$,h=[],d=e,c=e.getAttribute(`mx-${r}`),u=[],p=0;if(c&&((a=Je.get(c))||((a={v:(a=c.match(Qe)||s)[1],n:a[2],i:a[3]}).p=a.i&&z(Function(`return ${a.i}`),s,e),Je.set(c,a)),a={...a,r:c},h.push(a)),a&&!a.v||Ge[r]){if(!($=e.$a))for(u.push(d);d!=t&&(d=d.parentNode);){if(Me[n=d.id]||(n=d.$v)){$=n;break}u.push(d)}if($){for(c of u)c.$a=$;d=e.id,Me[d]&&(p=$=d);do{if((i=Me[$])&&(l=i.$v)){f=(o=l.$so)[r];for(n in f)o={r:n,v:$,n:n},n?G(e,n)&&h.push(o):p&&h.unshift(o);if(l.$e&&!p){a&&!a.v&&(a.v=$);break}p=0}}while(i&&($=i.pId))}}return h},Xe=e=>{let r,i,n,o,f,a,s,l,{target:$,type:h}=e,d=[];for(;$!=t;){if((r=Ke($,h)).length){d=[];for(let{v:t,r:i,n:d,p:c,i:u}of r){if(s!=t){if(s&&e.isPropagationStopped())break;s=t}if(o=(n=Me[t])&&n.$v){if((a=o[f=d+t+h])&&(e.eventTarget=$,l=c||{},u&&u.indexOf(t)>0&&B(o.$d.$a,l,l={}),e[k]=l,z(a,e,o),e.isImmediatePropagationStopped()))break;0}else e.stopPropagation();0}}if((i=$.$)&&i[h]||e.isPropagationStopped())break;d.push($),$=$.parentNode||t}for($ of d)(i=$.$||($.$={}))[h]=1},Ye=(e,r,i)=>{let n=0|We[e],o=i?-1:1;n&&i!==n||X(t,e,Xe,i),We[e]=n+o,r&&(Ge[e]=(0|Ge[e])+o)},et={input:1,br:1,hr:1,img:1,embed:1,source:1,area:1,param:1,col:1,track:1,wbr:1},tt={input:[g,"checked"],textarea:[g],option:["selected"]},rt="#text";let it=/^<([a-z\d]+)((?:\s+[-A-Za-z\d_]+(?:="[^"]*")?)*)\s*(\/?)>/,nt=/([-A-Za-z\d_]+)(?:="([^"]*)")?/g,ot=/^<\/[a-z\d+]+>/,ft={},at=/&#?[^\W]+;?/g,st=h.createElement("div"),lt=e=>(L(ft,e)||(st.innerHTML=e,ft[e]=st.innerText),ft[e]),$t=e=>e.replace(at,lt),ht=(e,t)=>{let r=M(t);e.$c[r]?e.unmountVframe(r,1):e.unmountZone(r,1)},dt=(e,t,r,i)=>{let n,o,f,s,l=t.d,$=e.attributes,h=t.h;for(s=$.length;s--;)o=$[s].name,L(h,o)||("id"==o?i||r.d.push([e,a]):(r.c=1,e.removeAttribute(o)));for(n of t.e)o=n.f,f=$t(n.g),"id"==o?r.d.push([e,f]):e.getAttribute(o)!=f&&(r.c=1,e.setAttribute(o,f));let d=tt[l];if(d)for(n of d)e[n]=L(h,n)?n!=g||h[n]:n==g&&a},ct=(e,t,r,i,n)=>(n=e.d)==rt?h.createTextNode(e.b):(i=h.createElementNS("svg"==n?"http://www.w3.org/2000/svg":t.namespaceURI,n),dt(i,e,r),i.innerHTML=e.b,i),ut=(e,t,r,i,n)=>{let o,f,a,s,l,$,h,d,c,u,p={};for(o=(s=e.childNodes).length,f=(l=t.a).length,a=0;a<o;a++)c=($=s[a]).id,$.$a&&(c=(u=Me[c])&&u.$n),c&&(c=p[c]||(p[c]=[])).push($);for(a=0;a<f;a++)$=s[a],(c=p[(h=l[a]).i])&&(c=c.shift())?(c!=$&&e.insertBefore(c,$),pt(c,e,h,r,i,n)):$?p[$.i]?(o++,r.c=1,e.insertBefore(ct(h,e,r),$)):pt($,e,h,r,i,n):(e.appendChild(ct(h,e,r)),r.c=1);for(a=f;a<o;a++)d=e.lastChild,ht(i,d),e.removeChild(d),r.c=1},pt=(e,t,r,i,n,o)=>{let f=e.nodeName.toLowerCase();if(f==r.d)if(f==rt)e.nodeValue!=r.b&&(e.nodeValue=$t(r.b));else{let t,f,a,s,l,$,h,d,c,u=r.h[I],p=r.b,m=Me[e.id];u&&m&&(s=($=m.$v).$g,h=ie(u),c=p!=m.$i,l=u.indexOf("?")>0||c),u&&m&&m.$n==h[V]?l&&(s?(d=h[k],u.indexOf(w)>-1&&B(o,d,d),m.$i=p,m[V]=u,h={inner:p,deep:!$.$e,html:c},dt(e,r,i,1),z(s,[d,h],$)&&$.$b(),f=h.deep):(a=1,f=1,t=1)):(t=1,f=1,a=m),a&&m.unmountVframe(0,1),t&&dt(e,r,i,m&&u),f&&ut(e,r,i,n,o)}else ht(n,e),t.replaceChild(ct(r,t,i),e),i.c=1},mt=e=>{let t,r,i,n,o=e.$b,f=Me[o],l=e.$a,$=f&&f.$v,h={d:[]},c=U(o);if($&&$.$a>0&&(t=$.$e)){n=(e=>{let t,r,i,n,o,f,l,$,h,d,c,u=e.length,p=0,m={a:[],b:e},b=[m];for(;p<u;)t=1,"<"==(i=e.slice(p))[0]&&("/"==i[1]?(n=i.match(ot))&&(l=b.pop(),f=e.slice(l.c,p),"textarea"==l.d?(l.e.push({f:g,g:f}),l.h[g]=f,l.a=s):l.b=f,m=b[b.length-1],p+=n[0].length,t=0):(n=i.match(it))&&(o=n[1],f=[],$={},c=a,n[2].replace(nt,(e,t,r)=>{r=r||a,"id"==t?c=r:t==I&&r&&!c&&(c=ie(r)[V]),f.push({f:t,g:r}),$[t]=r}),p+=n[0].length,d=n[3]||L(et,o),l={i:c,d:o,e:f,h:$,a:[],c:p},m.a.push(l),d?l.j=1:(b.push(l),m=l),t=0)),t&&(p+=(h=(r=i.indexOf("<"))<0?i:i.substring(0,r)).length,l={d:rt,b:h},m.a.push(l));return m})(r=wt(t(l),o)),ut(c,n,h,f,l);for(i of h.d)i[0].id=i[1];h.c&&($.endUpdate(o),d.trigger({type:"htmlchanged",vId:o}))}$.fire("domready")},gt=function(e){this.$b=e,this.$a={vId:e,[w]:1}};q(gt[x],{get(e,t){return t=this.$a,e&&(t=t[e]),t},set(e){return q(this.$a,e),this},digest(e,t){return this.set(e),mt(this),this},snapshot(){return this.$d=v(this.$a),this},altered(){let e=this;if(e.$d)return e.$d!=v(e.$a)}});let bt=/^(\$?)([^<]*)<([^>]+)>$/,vt=/\x1f/g,wt=(e,t)=>(e+a).replace(vt,t),yt=(e,t,r)=>(e.$h?r=e:((r=function(e){z(r.$h,e,this)}).$h=[e],r.$i=1),r.$h=r.$h.concat(t.$h||t),r),xt=(e,t)=>{let r,i,n=e.$r;for(r in n)i=n[r],(t||i.x)&&kt(n,r,1)},kt=(e,t,r,i)=>{let n,o,f=e[t];return f&&f!=i&&((n=(o=f.e).destroy)&&r&&z(n,s,o),delete e[t]),o},Vt=(e,t,r,i,n)=>{i=e[t],e[t]=e[r]=function(...e){(n=this).$a>0&&(n.$a++,n.fire("rendercall"),xt(n),z(i,e,n))}},It=(e,t)=>{let r,{$eo:i,$so:n,$el:o,id:f}=e;for(r in i)Ye(r,n[r],t);for(r of o)X(r.e,r.n,K,t,{i:f,v:e,f:r.f,e:r.e})},jt=[],St={win:$,doc:h},At=e=>{if(!e[w]){e[w]=[];let t,r,i,n,o,f,a,s,$,h=e[x],d={},c=[],u={},p={};if(r=h.mixins){for(o of r)for(a in o)t=o[a],i=p[a],"ctor"!=a?(bt.test(a)&&(i?t=yt(i,t):t.$i=1),p[a]=t):e[w].push(t);for(a in p)L(h,a)||(h[a]=p[a])}for(a in h)if(t=h[a],r=a.match(bt)){[,f,i,n]=r,n=n.split(l);for(s of n){if(o=St[i],$=1,f){if(o){c.push({f:t,e:o,n:s});continue}$=2,(o=u[s])||(o=u[s]={}),o[i]=1}d[s]=d[s]|$,(o=h[s=i+w+s])?o.$i&&(t.$i?h[s]=yt(o,t):L(h,a)&&(h[s]=t)):h[s]=t}}Vt(h,"render","$b"),h.$eo=d,h.$el=c,h.$so=u,h.$e=h.tmpl,h.$g=h.assign}return e[w]},Ot=e=>{let t,r,i,n=e.$l;if(n.f&&(n.p&&(t=pe[V]),!t&&n.k)){i=pe[k];for(r of n.k)if(t=L(i,r))break}return t},Tt=function(e,t,r,i){(i=this).owner=t,i.id=e,i.$l={k:[]},i.$r={},i.$a=1,i.updater=i.$d=new gt(i.id),z(jt,r,i)},Ct=Tt[x];q(Tt,{merge(...e){let t,r;for(t of e)(r=t&&t.ctor)&&jt.push(r),q(Ct,t)},extend(e,t){let r=this,i=(e=e||{}).ctor,n=[];i&&n.push(i);let o=function(e,t,i,o){r.call(this,e,t,i),z(n.concat(o),i,this)};return o.extend=r.extend,Q(o,r,e,t)}}),q(Ct,ae,{init:b,wrapEvent(e){return wt(e,this.id)},beginUpdate(e,t){(t=this).$a>0&&t.$f&&t.owner.unmountZone(e,1)},endUpdate(e,t,r,i,n){(r=this).$a>0&&(e=e||r.id,t?n=t:(n=r.$f,r.$f=1),(i=r.owner).mountZone(e,t),n||c(r.wrapAsync(ze),0,i))},wrapAsync(e,t){let r=this,i=r.$a;return(...n)=>{if(i>0&&i==r.$a)return e.apply(t||r,n)}},observeLocation(e,t){let r;(r=this.$l).f=1,n(e)&&(t=e[V],e=e[k]),r.p=t,e&&(r.k=(e+a).split(l))},observeState(e){this.$os=(e+a).split(l)},capture(e,t,r,i){return i=this.$r,t?(kt(i,e,1,t),i[e]={e:t,x:r}):t=(i=i[e])&&i.e,t},release(e,t){return kt(this.$r,e,t)},leaveTip(e,t){let r=this,i=n=>{let o="a",f="b";n.type!=p&&(o="b",f="a"),i[o]?(n.prevent(),n.reject()):t()?(n.prevent(),i[f]=1,r.leaveConfirm(e,()=>{i[f]=0,n.resolve()},()=>{i[f]=0,n.reject()})):n.resolve()},n=r=>{t()&&(r.msg=e)};He.on(p,i),He.on(m,n),r.on("unload",i),r.on("destroy",()=>{He.off(p,i),He.off(m,n)})},render:b}),fe.View=Tt;let Ut=i.type,Pt=i.now||Date.now,Zt=function(){this.id=O("b"),this.$={}};q(Zt[x],{get(e,t,r){let i,n=t!=r,f=this.$;if(e){let t,i=o(e)?e.slice():(e+a).split(".");for(;(t=i.shift())&&f;)f=f[t];t&&(f=r)}return n&&(i=Ut(t))!=Ut(f)&&(f=t),f},set(e,t){n(e)||(e={[e]:t}),q(this.$,e)}});let qt=function(e,t,r){(r=this[e])&&(delete this[e],z(r,t,r.e))},Et=(e,t,r,i,n,o)=>{let f=[],a=0,s=0;return function(l,$){let h,d=this;s++;let c=d.$b,u=c.k;f[l+1]=d;let p,m={bag:d,error:$};if($?(a=$,t.fire("fail",m),h=1):o.has(u)||(u&&o.set(u,d),c.t=Pt(),(p=c.a)&&z(p,d,d),(p=c.x)&&t.clear(p),t.fire("done",m),h=1),!r.$d){let t=s==i;t&&(r.$e=0,2==n&&(f[0]=a,z(e,f,r))),1==n&&z(e,[$||null,d,t,l],r)}h&&t.fire("end",m)}},Ht=(e,t,r,i,n)=>{if(e.$d)return e;if(e.$e)return e.enqueue(Ht.bind(e,e,t,r,i,n));e.$e=1,o(t)||(t=[t]);let f=e.constructor,a=0,s=f.$f,l=Et(r,f,e,t.length,i,f.$c);for(let e of t)if(e){let t,r=f.get(e,n),i=r.e,o=i.$b.k,$=l.bind(i,a++);o&&s[o]?s[o].push($):r.u?(o&&((t=[$]).e=i,s[o]=t,$=qt.bind(s,o)),f.$s(i,$)):$()}return e},Nt=function(){let e=this;e.id=O("s"),e.$g=[]};q(Nt[x],{all(e,t){return Ht(this,e,t,2)},save(e,t){return Ht(this,e,t,2,1)},one(e,t){return Ht(this,e,t,1)},enqueue(e){let t=this;return t.$d||(t.$g.push(e),t.dequeue(t.$h)),t},dequeue(...e){let t,r=this;r.$e||r.$d||(r.$e=1,c(()=>{r.$e=0,r.$d||(t=r.$g.shift())&&z(t,r.$h=e)},0))},destroy(e){(e=this).$d=1,e.$g=0}});let _t=(e,t)=>[v(t),v(e)].join(w),Mt=(e,t,r,i)=>{(i=e&&e.$b)&&t[i.n]&&r.del(i.k)},zt={add(e){let t,r=this.$b;o(e)||(e=[e]);for(t of e)if(t){let{name:e,cache:i}=t;t.cache=0|i,r[e]=t}},create(e){let t=this.meta(e),r=0|e.cache||t.cache,i=new Zt;i.set(t),i.$b={n:t.name,a:t.after,x:t.cleans,k:r&&_t(t,e)},n(e)&&i.set(e);let o=t.before;return o&&z(o,i,i),this.fire("begin",{bag:i}),i},meta(e){return this.$b[e.name||e]||e},get(e,t){let r,i,n=this;return t||(r=n.cached(e)),r||(r=n.create(e),i=1),{e:r,u:i}},clear(e){this.$c.each(Mt,oe((e+a).split(l)))},cached(e){let t,r,i=this,n=i.$c,o=i.meta(e),f=0|e.cache||o.cache;if(f&&(r=_t(o,e)),r){let e=i.$f[r];e?t=e.e:(t=n.get(r))&&Pt()-t.$b.t>f&&(n.del(r),t=0)}return t},...ae};return Nt.extend=((e,t,r)=>{let i=function(){Nt.call(this)};return i.$s=e,i.$c=new D(t,r),i.$f={},i.$b={},Q(i,Nt,null,zt)}),fe.Service=Nt,q(b[x],ae),b.extend=function e(t,r){let i=this,n=t&&t.ctor,o=function(...e){i.apply(this,e),n&&n.apply(this,e)};return o.extend=e,Q(o,i,t,r)},fe.Base=b,fe.default=fe,fe});