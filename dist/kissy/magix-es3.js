/*!3.8.4 MIT kooboy_li@163.com*/KISSY.add("magix",function(t,e,n){var r,i=t.all,o=t.isObject,a=t.isArray,f=0,u="",c=[],s=",",h=window,d=document,v=i(d),$=h.setTimeout,l="changed",p="change",g="pageunload",m="value",b="mxs",y=function(){},w=JSON.stringify,x="\x1e",k="object",V="prototype",I="params",A="path",S="mx-view",T=/[#?].*$/,C=/([^=&?\/#]+)=?([^&#?]*)/g,O=/(?!^)=|&/,U=function(t){return(t||"mx_")+f++},P=U(),j={rootId:U(),defaultView:P,error:function(t){throw t}},q=function(t){return typeof t==k?t:d.getElementById(t)},E=function(t){return!t||typeof t!=k},H=function(t,e,n){if(t=q(t),e=q(e),t&&e&&!(n=t==e))try{n=16==(16&e.compareDocumentPosition(t))}catch(t){}return n},N=function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])z(e,i)&&(t[i]=e[i]);return t},L=function(t,e,n){for(n in e=[],t)z(t,n)&&e.push(n);return e},Z=j.hasOwnProperty,M=i("head"),R=function(t,e){e&&!R[t]&&(R[t]=1,M.append("<style>"+e))},B=function(t){return t.id||(t.$a=1,t.id=U())},D=function(t,e,n,r,i){e=e||c,a(t)||(t=[t]),a(e)||(e=[e]);for(var o=0,f=t;o<f.length;o++){i=f[o];try{r=i&&i.apply(n,e)}catch(t){j.error(t)}}return r},z=function(t,e){return t&&Z.call(t,e)},F=function(t,e,n){var r,i;for(r in e)i=e[r],n[r]=(i+u)[0]==x?t[i]:i},J=function(t,e){return e.f-t.f||e.t-t.t},K=function(t,e,n,r){(r=this).c=[],r.b=e||5,r.x=r.b+(t||20),r.r=n};N(K[V],{get:function(t){var e=this.c[x+t];return e&&(e.f++,e.t=f++,e=e.v),e},each:function(t,e,n){for(var r=0,i=(n=this).c;r<i.length;r++)t(i[r].v,e,n)},set:function(t,e){var n=this.c,r=x+t,i=n[r],o=this.b;if(!i){if(n.length>=this.x)for(n.sort(J);o--;)(i=n.pop()).f>0&&this.del(i.o);i={o:t},n.push(i),n[r]=i}i.v=e,i.f=1,i.t=f++},del:function(t){t=x+t;var e=this.c,n=e[t],r=this.r;n&&(n.f=-1,n.v=u,delete e[t],r&&D(r,n.o))},has:function(t){return z(this.c,x+t)}});var Q,X=function(e,n){t.use(e&&e+u,function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];n&&n.apply(t,e)})},Y=t.extend,_=n.test,G=function(t,e){e=this,t.eventTarget=e.e,D(e.f,t,e.v)},W=function(t,n,r,i,o){o?e[(i?"un":u)+"delegate"](t,n,r,o):e[i?"detach":"on"](t,n,r,o)},tt=new K,et=0,nt=function(t,e,n){try{n=decodeURIComponent(n)}catch(t){}Q[e]=n},rt=function(t){var e,n=tt.get(t);return n||(Q={},t==(e=t.replace(T,u))&&O.test(e)&&(e=u),t.replace(e,u).replace(C,nt),tt.set(t,n={a:e,b:Q})),{path:n.a,params:N({},n.b)}},it=function(t,e,n){var r,i,o,a=[];for(i in e)r=e[i]+u,(!n||r||z(n,i))&&(r=encodeURIComponent(r),a.push(o=i+"="+r));return o&&(t+=(t&&(~t.indexOf("?")?"&":"?"))+a.join("&")),t},ot=function(t,e){var n,r={};if(t)for(var i=0,o=t;i<o.length;i++)n=o[i],r[e&&n?n[e]:n]=e?n:1+(0|r[n]);return r},at={config:function(t,e){return e=j,t&&(e=o(t)?N(e,t):e[t]),e},boot:function(t){N(j,t),X(j.ini,function(e){N(j,e,t),X(j.exts,function(){Et.on(l,Mt),$t.on(l,Mt),et=1,Ut()})})},toMap:ot,toTry:D,toUrl:it,parseUrl:rt,mix:N,has:z,keys:L,inside:H,node:q,applyStyle:R,guid:U,use:X,Cache:K,nodeId:B},ft={fire:function(t,e,n,r){var i,o,a,f,c=this,s=c[x+t];if(e||(e={}),e.type||(e.type=t),s)for(o=(i=s.length)-1;i--;)(f=s[a=r?i:o-i]).f?(f.x=1,D(f.f,e,c),f.x=u):f.x||(s.splice(a,1),o--);(s=c["on"+t])&&D(s,e,c),n&&c.off(t)},on:function(t,e){var n=x+t;(this[n]||(this[n]=[])).push({f:e})},off:function(t,e){var n,r=x+t,i=this[r];if(e){if(i)for(var o=0,a=i;o<a.length;o++)if((n=a[o]).f==e){n.f=u;break}}else delete this[r],delete this["on"+t]}};at.Event=ft;var ut={},ct={},st={},ht=0,dt=function(t){for(var e=0,n=t=(t+u).split(",");e<n.length;e++){var r=n[e];z(ct,r)?ct[r]++:ct[r]=1}return t},vt=function(t){for(var e,n=0,r=t;n<r.length;n++)e=r[n],z(ct,e)&&(--ct[e]||(delete ct[e],delete ut[e]))};var $t=N({get:function(t){var e=t?ut[t]:ut;return e},set:function(t){ht=function(t,e,n){var r,i,o,a=0;for(o in t)r=t[o],i=e[o],E(r)&&i===r||(n[o]=1,a=1),e[o]=r;return a}(t,ut,st)||ht},digest:function(t){t&&$t.set(t),ht&&(ht=0,this.fire(l,{keys:st}),st={})},diff:function(){return st},clean:function(t){return{ctor:function(){t=dt(t),this.on("destroy",function(){return vt(t)})}}}},ft);at.State=$t;var lt,pt,gt,mt,bt,yt,wt="view",xt=new K,kt=new K,Vt=h.location,It=0,At={query:{},params:{},href:u},St=/(?:^.*\/\/[^\/]+|#.*$)/gi,Tt=/^[^#]*#?!?/,Ct=function(t){return this[I][t]||u},Ot=function(t,e){t="#!"+t,e?Vt.replace(t):Vt.hash=t},Ut=function(){var t,e,n=jt().srcHash;W(h,"hashchange",function(r,i,o){e||(i=jt(),(t=i.srcHash)!=n&&(o=function(){r.p=1,n=t,e=u,Ot(t),qt()},r={reject:function(){r.p=1,e=u,Ot(n)},resolve:o,prevent:function(){e=1}},Et.fire(p,r),e||r.p||o()))}),h.onbeforeunload=function(t,e,n){if(t=t||h.event,e={},Et.fire(g,e),n=e.msg)return t&&(t.returnValue=n),n},qt()},Pt=d.title,jt=function(t){t=t||Vt.href;var e,n,r,i,a,f=xt.get(t);return f||(e=t.replace(St,u),n=t.replace(Tt,u),r=rt(e),i=rt(n),a=N({},r[I],i[I]),f={get:Ct,href:t,srcQuery:e,srcHash:n,query:r,hash:i,params:a},et&&(!function(t,e){if(pt||(pt=j.routes||{},gt=j.unmatchView,mt=j.defaultView,bt=j.defaultPath||"/",yt=j.rewrite),!t[wt]){var n=t.hash[A]||bt;yt&&(n=yt(n,t[I],pt)),e=pt[n]||gt||mt,t[A]=n,t[wt]=e,o(e)&&N(t,e)}}(f),xt.set(t,f))),f},qt=function(){var t=jt(),e=function(t,e){var n=t.href,r=e.href,i=n+x+r,o=kt.get(i);if(!o){var a,f;o={params:f={},force:!n};for(var u=t[I],c=e[I],s=function(t){var e=u[t],n=c[t];e!=n&&(f[t]={from:e,to:n},a=1)},h=0,d=L(u).concat(L(c));h<d.length;h++)s(d[h]);u=t,c=e,f=o,s(A),s(wt),kt.set(i,o={a:a,b:o})}return o}(At,At=t);return!It&&e.a&&((lt=e.b)[A]&&(d.title=t.title||Pt),Et.fire(l,lt)),It=0,lt},Et=N({parse:jt,diff:qt,to:function(t,e,n,r){!e&&o(t)&&(e=t,t=u);var i,a,f,c,s=rt(t),h=s[I],d=s[A],v=At[A],$=At[I],l=At.query[I];if(N(h,e),d)for(v in l)z(h,v)||(h[v]=u);else $&&(d=v,h=N({},$,h));a=At,f=n,c=r,(i=it(i=d,h,l))!=a.srcHash&&(It=c,Ot(i,f))}},ft);at.Router=Et;var Ht,Nt,Lt=0,Zt=function(t,e,n,r,i,o){if(t&&t.$a!=Lt&&(n=t.$v)&&n.$a>1){(e?function(t,e,n){var r,i=t.$os;if(i)for(var o=0,a=i;o<a.length&&(r=a[o],!(n=z(e,r)));o++);return n}(n,e):ye(n))&&n.$b();for(var a=0,f=t.children();a<f.length;a++)o=f[a],Zt(zt[o],e)}},Mt=function(t,e,n){e=Dt(),(n=t[wt])?e.mountView(n.to):(Lt=f++,Zt(e,t.keys))},Rt=function(t){if(!t.$b&&!t.$d&&t.$cc==t.$rc){t.$cr||(t.$cr=1,t.$ca=0,t.fire("created"));var e=void 0,n=t.id,r=t.pId;(e=zt[r])&&!z(e.$e,n)&&(e.$e[n]=1,e.$rc++,Rt(e))}},Bt=function(t,e){if(!t.$ca&&t.$cr){t.$cr=0,t.$ca=1,t.fire("alter",e);var n=void 0,r=t.id,i=t.pId;(n=zt[i])&&z(n.$e,r)&&(n.$rc--,delete n.$e[r],Bt(n,e))}},Dt=function(t){return Ht||(r=d.body,q(t=j.rootId)||(r.id=t),Ht=new Jt(t)),Ht},zt={},Ft=[],Jt=function(t,e,n){var r,i;(n=this).id=t,n.$c={},n.$cc=0,n.$rc=0,n.$g=1,n.$e={},n.$f=[],n.pId=e,i=n,z(zt,r=t)||(zt[r]=i,Jt.fire("add",{vframe:i}),(r=q(r))&&(r.vframe=i))};N(Jt,{all:function(){return zt},get:function(t){return zt[t]}},ft),N(Jt[V],ft,{mountView:function(t,e){var n,r,i,o,a,f,u=this,c=u.id,s=u.pId,h=u.$g,d=q(c);!u.$h&&d&&(u.$h=1,u.$i=d.innerHTML),u.unmountView(),u.$b=0,d&&t&&(u[A]=t,n=rt(t),i=n[A],r=++h,o=n[I],f=(f=(f=(f=zt[s])&&f.$v)&&f.$d)&&f.$a,t.indexOf(x)>0&&F(f,o,o),u.$n=n[A],N(o,e),X(i,function(t){if(r==u.$g){if(!t)return j.error(Error("id:"+c+" cannot load:"+i));a=be(t),i=new t(c,u,o,a),u.$v=i,u.$a=Lt,pe(i),D(i.init,o,i),i.$b(),i.$e||(u.$h=0,i.$f||i.endUpdate())}}))},unmountView:function(){var t,e,n=this,r=n.$v,o=n.id;n.$f=[],r&&(Nt||(e=1,Nt={id:o}),n.$b=1,n.unmountZone(0,1),Bt(n,Nt),n.$v=0,r.$a>0&&(r.$a=0,r.fire("destroy",0,1,1),$e(r,1),pe(r,1),r.owner=0),r.$a--,(t=q(o))&&n.$h&&i(t).html(n.$i),e&&(Nt=0)),n.$g++},mountVframe:function(t,e,n){var r,i=this,o=i.id,a=i.$c;return Bt(i,{id:t}),(r=zt[t])||(z(a,t)||(i.$o=0,i.$cc++),a[t]=t,(r=Ft.pop())?Jt.call(r,t,o):r=new Jt(t,o)),r.mountView(e,n),r},mountZone:function(t,e){var n,r,o=this,a=[];t=t||o.id;var f,u=i("#"+t+" ["+S+"]");o.$d=1;for(var c=0,s=u;c<s.length;c++)n=s[c],r=B(n),n.$b||(n.$b=1,a.push([r,n.getAttribute(S)]));for(var h=0,d=a;h<d.length;h++)r=(f=d[h])[0],n=f[1],a[r]?j.error(Error("vf.id duplicate:"+r+" at "+o[A])):o.mountVframe(a[r]=r,n);o.$d=0,e||Rt(o)},unmountVframe:function(t,e){var n,r,i,o;if(t=t?this.$c[t]:this.id,n=zt[t]){var a=n.$cr,f=n.pId;n.unmountView(),i=a,(o=zt[r=t])&&(delete zt[r],Jt.fire("remove",{vframe:o,fcc:i}),(r=q(r))&&(r.$b=0),r&&(r.vframe=0),r&&(r.$d=0)),n.id=n.pId=n.$c=n.$e=0,n.$h=0,n.off("alter"),n.off("created"),Ft.push(n),(n=zt[f])&&z(n.$c,t)&&(delete n.$c[t],n.$o=0,n.$cc--,e||Rt(n))}},unmountZone:function(t,e){var n;for(n in this.$c)(!t||n!=t&&H(n,t))&&this.unmountVframe(n,1);e||Rt(this)},parent:function(t,e){for(e=this,t=t>>>0||1;e&&t--;)e=zt[e.pId];return e},children:function(t){return(t=this).$o||(t.$o=L(t.$c))},invoke:function(t,e){var n,r,i,o,a,f=this.$f;return(r=this.$v)&&r.$f?n=(i=r[t])&&D(i,e,r):((o=f[a=x+t])&&(o.r=e===o.a),o={n:t,a:e,k:a},f.push(o),f[a]=o),n}}),at.Vframe=Jt,n[V].invokeView=function(t,e){if(this.length){var n=this[0],r=n.vframe;if(void 0===e)return r&&r.invoke(t);for(var i=0;i<this.length;i++)(r=(n=this[i]).vframe)&&r.invoke(t,e)}};var Kt=new K(30,10),Qt=/(?:([\w\-]+)\x1e)?([^(]+)\(([\s\S]*)?\)/,Xt={},Yt={},_t=function(t,e){var n,i,o,a,f,u,s=[],h=t,d=t.getAttribute("mx-"+e),v=[],$=0;if(d&&((a=Kt.get(d))||((a={v:(a=d.match(Qt)||c)[1],n:a[2],i:a[3]}).p=a.i&&D(Function("return "+a.i),c,t),Kt.set(d,a)),a=N({},a,{r:d}),s.push(a)),a&&!a.v||Yt[e]){if(!(u=t.$a))for(v.push(h);h!=r&&(h=h.parentNode);){if(zt[i=h.id]||(i=h.$v)){u=i;break}v.push(h)}if(u){for(var l=0,p=v;l<p.length;l++)(d=p[l]).$a=u;h=t.id,zt[h]&&($=u=h);do{if((n=zt[u])&&(f=n.$v)){for(i in(o=f.$so)[e])o={r:i,v:u,n:i},i?_(t,i)&&s.push(o):$&&s.unshift(o);if(f.$e&&!$){a&&!a.v&&(a.v=u);break}$=0}}while(n&&(u=n.pId))}}return s},Gt=function(t){for(var e,n,i,o,a,f,u,c=t.target,s=t.type,h=[];c!=r;){if((e=_t(c,s)).length){h=[];for(var d=0,v=e;d<v.length;d++){var $=v[d],l=$.v,p=($.r,$.n),g=$.p,m=$.i;if(f!=l){if(f&&t.isPropagationStopped())break;f=l}if(o=(i=zt[l])&&i.$v){if((a=o[p+x+s])&&(t.eventTarget=c,u=g||{},m&&m.indexOf(x)>0&&F(o.$d.$a,u,u={}),t[I]=u,D(a,t,o),t.isImmediatePropagationStopped()))break;0}else t.stopPropagation();0}}if((n=c.$)&&n[s]||t.isPropagationStopped())break;h.push(c),c=c.parentNode||r}for(var b=0,y=h;b<y.length;b++)(n=(c=y[b]).$||(c.$={}))[s]=1},Wt="http://www.w3.org/2000/svg",te={option:[1,"<select multiple>"],thead:[1,"<table>"],col:[2,"<table><colgroup>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],area:[1,"<map>"],param:[1,"<object>"],g:[1,'<svg xmlns="'+Wt+'">'],all:[0,""]},ee=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;te.optgroup=te.option,te.tbody=te.tfoot=te.colgroup=te.caption=te.thead,te.th=te.td;var ne=d.implementation.createHTMLDocument(u),re=ne.createElement("base");re.href=d.location.href,ne.head.appendChild(re);var ie=function(t,e){var n=B(e);t.$c[n]?t.unmountVframe(n,1):t.unmountZone(n,1)},oe={INPUT:[m,"checked"],TEXTAREA:[m],OPTION:["selected"]},ae=function(t,e,n,r){var i,o,a,f,u=t.attributes,c=e.attributes,s=t.nodeName;for(o=u.length;o--;)i=u[o].name,e.getAttribute(i)||("id"==i?r||n.d.push([t,""]):(n.c=1,t.removeAttribute(i)));for(o=c.length;o--;)a=(i=c[o]).name,f=i[m],t.getAttribute(a)!=f&&("id"==a?n.d.push([t,f]):(n.c=1,t.setAttribute(a,f)));var h=oe[s];if(h)for(var d=0,v=h;d<v.length;d++)t[o=v[d]]!=e[o]&&(t[o]=e[o])},fe=function(t,e,n){return(e=t.$a?u:t.id)||1!=t.nodeType||(e=t.getAttribute(b)||(n=zt[e])&&n.$n),e},ue=function(t,e,n,r,i){for(var o,a,f,u,c=t.lastChild,s=e.firstChild,h=0,d={};c;)h++,f=fe(a=c),c=c.previousSibling,f&&(f=d[f]||(d[f]=[])).push(a);for(c=t.firstChild;s;)h--,o=s,s=s.nextSibling,(u=d[f=fe(o)])&&(u=u.pop())?(u!=c?t.insertBefore(u,c):c=c.nextSibling,ce(u,o,t,n,r,i)):c?(f=fe(a=c))&&d[f]?(h++,n.c=1,t.insertBefore(o,a)):(c=c.nextSibling,ce(a,o,t,n,r,i)):(t.appendChild(o),n.c=1);for(;h-- >0;)a=t.lastChild,ie(r,a),t.removeChild(a),n.c=1},ce=function(t,e,n,r,i,o){if(t.nodeName===e.nodeName)if(1===t.nodeType){var a=t.getAttribute(b);if(a&&a==e.getAttribute(b))return;var f=e.getAttribute(S),c=e.innerHTML,s=t.getAttribute("mxa"),h=!s||s!=e.getAttribute("mxa"),d=void 0,v=void 0,$=zt[t.id],l=void 0,p=void 0,g=void 0,m=void 0,y=void 0,w=void 0;f&&$&&(l=(g=$.$v).$g,m=rt(f),w=c!=$.$i,p=f.indexOf("?")>0||w),f&&$&&$.$n==m[A]?p&&(l?(y=m[I],f.indexOf(x)>-1&&F(o,y,y),$.$i=c,$[A]=f,m={node:e,deep:!g.$e,html:w},h&&(h=u,ae(t,e,r,1)),D(l,[y,m],g)&&r.v.push(g),d=m.deep):(v=1,d=1)):(d=1,v=$),v&&$.unmountVframe(0,1),h&&(v&&(r.c=1),ae(t,e,r,$&&f)),d&&ue(t,e,r,i,o)}else t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);else ie(i,t),n.replaceChild(e,t),r.c=1},se=function(t){var e,n,r,i=t.$b,o=zt[i],a=t.$a,f=o&&o.$v,u={d:[],v:[]},c=q(i);if(f&&f.$a>0&&(e=f.$e)){n=e(a,i),ue(c,function(t,e){var n=ne.createElement("div"),r=Wt==e.namespaceURI?"g":(ee.exec(t)||[0,""])[1].toLowerCase(),i=te[r]||te.all;n.innerHTML=i[1]+t;for(var o=i[0];o--;)n=n.lastChild;return n}(n,c),u,o,a);for(var s=0,h=u.d;s<h.length;s++)(r=h[s])[0].id=r[1];for(var d=0,$=u.v;d<$.length;d++)(r=$[d]).$b();u.c&&(f.endUpdate(i),v.fire("htmlchanged",{vId:i})),f.fire("domready")}},he=function(t){var e;this.$b=t,this.$a=((e={vId:t})[x]=1,e)};N(he[V],{get:function(t,e){return e=this.$a,t&&(e=e[t]),e},set:function(t){return N(this.$a,t),this},digest:function(t){return this.set(t),se(this),this},snapshot:function(){return this.$d=w(this.$a),this},altered:function(){if(this.$d)return this.$d!=w(this.$a)}});var de=/^(\$?)([^<]*)<([^>]+)>$/,ve=function(t,e,n){return t.$h?n=t:((n=function(t){D(n.$h,t,this)}).$h=[t],n.$i=1),n.$h=n.$h.concat(e.$h||e),n},$e=function(t,e){var n,r,i=t.$r;for(n in i)r=i[n],(e||r.x)&&le(i,n,1)},le=function(t,e,n,r){var i,o,a=t[e];return a&&a!=r&&((i=(o=a.e).destroy)&&n&&D(i,c,o),delete t[e]),o},pe=function(t,e){var n,i,o,a,f,u,c=t.$eo,s=t.$so,h=t.$el,d=t.id;for(n in c)i=n,o=s[n],a=e,void 0,void 0,f=0|Xt[i],u=a?-1:1,f&&a!==f||W(r,i,Gt,a),Xt[i]=f+u,o&&(Yt[i]=(0|Yt[i])+u);for(var v=0,$=h;v<$.length;v++)n=$[v],W(n.e,n.n,G,e,{i:d,v:t,f:n.f,e:n.e})},ge=[],me={win:h,doc:d},be=function(t){if(!t[x]){t[x]=[];var e=t[V],n=void 0,r=void 0,i=void 0,o={},a=[],f={},u=void 0,c=void 0,h=void 0,d=void 0,v=void 0,$={};if(r=e.mixins){for(var l=0,p=r;l<p.length;l++)for(h in u=p[l])n=u[h],i=$[h],"ctor"!=h?(de.test(h)&&(i?n=ve(i,n):n.$i=1),$[h]=n):t[x].push(n);for(h in $)z(e,h)||(e[h]=$[h])}for(h in e)if(n=e[h],r=h.match(de)){c=r[1],i=r[2];for(var g=0,m=r[3].split(s);g<m.length;g++){if(d=m[g],u=me[i],v=1,c){if(u){a.push({f:n,e:u,n:d});continue}v=2,(u=f[d])||(u=f[d]={}),u[i]=1}o[d]=o[d]|v,(u=e[d=i+x+d])?u.$i&&(n.$i?e[d]=ve(u,n):z(e,h)&&(e[d]=n)):e[d]=n}}w="$b",k=(b=e)[y="render"],b[y]=b[w]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(I=this).$a>0&&(I.$a++,I.fire("rendercall"),$e(I),D(k,t,I))},e.$eo=o,e.$el=a,e.$so=f,e.$e=e.tmpl,e.$g=e.assign}var b,y,w,k,I;return t[x]},ye=function(t){var e,n,r,i=t.$l;if(i.f&&(i.p&&(e=lt[A]),!e&&i.k)){r=lt[I];for(var o=0,a=i.k;o<a.length&&(n=a[o],!(e=z(r,n)));o++);}return e},we=function(t,e,n,r){(r=this).owner=e,r.id=t,r.$l={k:[]},r.$r={},r.$a=1,r.updater=r.$d=new he(r.id),D(ge,n,r)},xe=we[V];N(we,{merge:function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++)(e=(t=o[i])&&t.ctor)&&ge.push(e),N(xe,t)},extend:function(t,e){var n=this,r=(t=t||{}).ctor,i=[];r&&i.push(r);var o=function(t,e,r,o){n.call(this,t,e,r),D(i.concat(o),r,this)};return o.extend=n.extend,Y(o,n,t,e)}}),N(xe,ft,{init:y,beginUpdate:function(t,e){(e=this).$a>0&&e.$f&&e.owner.unmountZone(t,1)},endUpdate:function(t,e,n,r,i){(n=this).$a>0&&(t=t||n.id,e?i=e:(i=n.$f,n.$f=1),(r=n.owner).mountZone(t,e),i||$(n.wrapAsync(function(){!function(t,e,n){for(e=t.$f;e.length;)(n=e.shift()).r||t.invoke(n.n,n.a),delete e[n.k]}(r)}),0))},wrapAsync:function(t,e){var n=this,r=n.$a;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(r>0&&r==n.$a)return t.apply(e||n,i)}},observeLocation:function(t,e){var n;(n=this.$l).f=1,o(t)&&(e=t[A],t=t[I]),n.p=e,t&&(n.k=(t+u).split(s))},observeState:function(t){this.$os=(t+u).split(s)},capture:function(t,e,n,r){return r=this.$r,e?(le(r,t,1,e),r[t]={e:e,x:n}):e=(r=r[t])&&r.e,e},release:function(t,e){return le(this.$r,t,e)},leaveTip:function(t,e){var n=this,r=function(i){var o="a",a="b";i.type!=p&&(o="b",a="a"),r[o]?(i.prevent(),i.reject()):e()?(i.prevent(),r[a]=1,n.leaveConfirm(t,function(){r[a]=0,i.resolve()},function(){r[a]=0,i.reject()})):i.resolve()},i=function(n){e()&&(n.msg=t)};Et.on(p,r),Et.on(g,i),n.on("unload",r),n.on("destroy",function(){Et.off(p,r),Et.off(g,i)})},render:y}),at.View=we;var ke=t.type,Ve=t.now,Ie=function(){this.id=U("b"),this.$={}};N(Ie[V],{get:function(t,e,n){var r=e!=n,i=this.$;if(t){for(var o=a(t)?t.slice():(t+u).split("."),f=void 0;(f=o.shift())&&i;)i=i[f];f&&(i=n)}return r&&ke(e)!=ke(i)&&(i=e),i},set:function(t,e){var n;o(t)||((n={})[t]=e,t=n),N(this.$,t)}});var Ae=function(t,e,n){(n=this[t])&&(delete this[t],D(n,e,n.e))},Se=function(t,e,n,r,i){if(t.$d)return t;if(t.$e)return t.enqueue(Se.bind(t,t,e,n,r,i));t.$e=1,a(e)||(e=[e]);for(var o,f,u,c,s,h,d,v,$,l=t.constructor,p=0,g=l.$f,m=(o=n,f=l,u=t,c=e.length,s=r,h=l.$c,d=[],v=0,$=0,function(t,e){var n,r=this;$++;var i=r.$b,a=i.k;d[t+1]=r;var l,p={bag:r,error:e};if(e?(v=e,f.fire("fail",p),n=1):h.has(a)||(a&&h.set(a,r),i.t=Ve(),(l=i.a)&&D(l,r,r),(l=i.x)&&f.clear(l),f.fire("done",p),n=1),!u.$d){var g=$==c;g&&(u.$e=0,2==s&&(d[0]=v,D(o,d,u))),1==s&&D(o,[e||null,r,g,t],u)}n&&f.fire("end",p)}),b=0,y=e;b<y.length;b++){var w=y[b];if(w){var x=l.get(w,i),k=x.e,V=k.$b.k,I=m.bind(k,p++),A=void 0;V&&g[V]?g[V].push(I):x.u?(V&&((A=[I]).e=k,g[V]=A,I=Ae.bind(g,V)),l.$s(k,I)):I()}}return t},Te=function(){var t=this;t.id=U("s"),t.$g=[]};N(Te[V],{all:function(t,e){return Se(this,t,e,2)},save:function(t,e){return Se(this,t,e,2,1)},one:function(t,e){return Se(this,t,e,1)},enqueue:function(t){var e=this;return e.$d||(e.$g.push(t),e.dequeue(e.$h)),e},dequeue:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,r=this;r.$e||r.$d||(r.$e=1,$(function(){r.$e=0,r.$d||(n=r.$g.shift())&&D(n,r.$h=t)},0))},destroy:function(t){(t=this).$d=1,t.$g=0}});var Ce=function(t,e){return[w(e),w(t)].join(x)},Oe=function(t,e,n,r){(r=t&&t.$b)&&e[r.n]&&n.del(r.k)},Ue=N({add:function(t){var e,n=this.$b;a(t)||(t=[t]);for(var r=0,i=t;r<i.length;r++)if(e=i[r]){var o=e.name,f=e.cache;e.cache=0|f,n[o]=e}},create:function(t){var e=this.meta(t),n=0|t.cache||e.cache,r=new Ie;r.set(e),r.$b={n:e.name,a:e.after,x:e.cleans,k:n&&Ce(e,t)},o(t)&&r.set(t);var i=e.before;return i&&D(i,r,r),this.fire("begin",{bag:r}),r},meta:function(t){return this.$b[t.name||t]||t},get:function(t,e){var n,r;return e||(n=this.cached(t)),n||(n=this.create(t),r=1),{e:n,u:r}},clear:function(t){this.$c.each(Oe,ot((t+u).split(s)))},cached:function(t){var e,n,r=this.$c,i=this.meta(t),o=0|t.cache||i.cache;if(o&&(n=Ce(i,t)),n){var a=this.$f[n];a?e=a.e:(e=r.get(n))&&Ve()-e.$b.t>o&&(r.del(n),e=0)}return e}},ft);return Te.extend=function(t,e,n){var r=function(){Te.call(this)};return r.$s=t,r.$c=new K(e,n),r.$f={},r.$b={},Y(r,Te,null,Ue)},at.Service=Te,N(y[V],ft),y.extend=function t(e,n){var r=this,i=e&&e.ctor,o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.apply(this,t),i&&i.apply(this,t)};return o.extend=t,Y(o,r,e,n)},at.Base=y,t.add(P,function(){return we.extend()}),at},{requires:["event","node","dom"]});